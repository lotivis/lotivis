{"version":3,"file":"lotivis.js","sources":["../src/js/shared/color.js","../src/js/shared/hash.js","../src/js/shared/selector.js","../src/js/data.juggle/data.validate.error.js","../src/js/shared.components/component.js","../src/js/shared.components/button.js","../src/js/shared.components/radio.group.js","../src/js/shared.components/toast.js","../src/js/shared.components/option.js","../src/js/shared/config.js","../src/js/shared/debug.js","../src/js/chart/chart.js","../src/js/shared/copy.js","../src/js/shared/value.js","../src/js/data.juggle/data.combine.js","../src/js/data.juggle/data.sum.js","../src/js/data.date.assessor/date.assessor.js","../src/js/dataview/data.view.cache.js","../src/js/datasets.controller/datasets.controller.js","../src/js/chart/chart.datasets.js","../src/js/shared.components/card.js","../src/js/shared.components/checkbox.js","../src/js/shared.components/popup.js","../src/js/shared.components/modal.popup.js","../src/js/shared.components/dropdown.js","../src/js/shared.components/textarea.card.js","../src/js/dataview.card/updatable.dataview.card.js","../src/js/data.juggle/data.validate.js","../src/js/shared/equal.js","../src/js/dataview.card/editable.dataview.card.js","../src/js/shared/filename.js","../src/js/shared/screenshot.js","../src/js/shared/download.js","../src/js/dataview.card/data.json.card.js","../src/js/shared/csv.to.array.js","../src/js/shared/trim.js","../src/js/data.juggle/data.create.datasets.js","../src/js/data.parse/parse.csv.js","../src/js/data.juggle/data.flat.js","../src/js/data.render/render.csv.js","../src/js/dataview.card/data.csv.card.js","../src/js/data.parse/parse.csv.date.js","../src/js/data.juggle/data.extract.js","../src/js/data.juggle/data.relations.js","../src/js/data.render/render.csv.date.js","../src/js/dataview.card/data.csv.date.card.js","../src/js/dataview.card/dataview.card.js","../src/js/dataview.card/datasets.controller.card.js","../src/js/date.chart/date.chart.axis.renderer.js","../src/js/date.chart/time.chart.label.renderer.js","../src/js/date.chart/time.chart.legend.renderer.js","../src/js/date.chart/time.chart.bars.renderer.js","../src/js/date.chart/time.chart.hover.bars.renderer.js","../src/js/date.chart/time.chart.tooltip.renderer.js","../src/js/date.chart/time.chart.grid.renderer.js","../src/js/date.chart/time.chart.selection.renderer.js","../src/js/date.chart/date.chart.config.js","../src/js/date.chart/date.chart.js","../src/js/shared/url.parameters.js","../src/js/shared.components/settings.popup.js","../src/js/date.chart.card/date.chart.card.settings.popup.js","../src/js/shared.components/chart.card.js","../src/js/date.chart.card/date.chart.card.js","../src/js/geojson/remove.features.js","../src/js/shared/style.js","../src/js/shared/format.js","../src/js/map.chart/map.tooltip.renderer.js","../src/js/map.chart/map.legend.renderer.js","../src/js/map.chart/map.label.renderer.js","../src/js/map.chart/map.dataset.renderer.js","../src/js/map.chart/map.geojson.renderer.js","../src/js/geojson/join.features.js","../node_modules/topojson-client/src/identity.js","../node_modules/topojson-client/src/transform.js","../node_modules/topojson-client/src/bbox.js","../node_modules/topojson-client/src/reverse.js","../node_modules/topojson-client/src/feature.js","../node_modules/topojson-client/src/stitch.js","../node_modules/topojson-client/src/mesh.js","../node_modules/topojson-client/src/merge.js","../node_modules/topojson-client/src/bisect.js","../node_modules/topojson-client/src/neighbors.js","../node_modules/topojson-client/src/untransform.js","../node_modules/topojson-client/src/quantize.js","../src/js/map.chart/map.exterior.border.renderer.js","../src/js/geojson/create.geojson.js","../src/js/map.chart/map.chart.config.js","../src/js/map.chart/map.background.renderer.js","../src/js/geojson/geometry.js","../src/js/geojson/feature.js","../src/js/geojson/geojson.js","../src/js/map.chart/map.selection.renderer.js","../src/js/map.chart/map.chart.js","../src/js/map.chart.card/map.chart.settings.popup.js","../src/js/map.chart.card/map.chart.card.js","../src/js/datasets.controller/datasets.controller.cache.js","../src/js/dataview/dataview.plot.js","../src/js/plot.chart/plot.chart.config.js","../src/js/plot.chart/plot.axis.renderer.js","../src/js/plot.chart/plot.tooltip.renderer.js","../src/js/plot.chart/plot.label.renderer.js","../src/js/plot.chart/plot.grid.renderer.js","../src/js/plot.chart/plot.background.renderer.js","../src/js/plot.chart/plot.chart.hover.bars.renderer.js","../src/js/plot.chart/plot.bars.fractions.renderer.js","../src/js/plot.chart/plot.bars.gradient.creator.js","../src/js/plot.chart/plot.bars.gradient.renderer.js","../src/js/plot.chart/plot.labels.fractions.renderer.js","../src/js/plot.chart/plot.chart.selection.renderer.js","../src/js/plot.chart/plot.chart.js","../src/js/plot.chart.card/plot.chart.card.settings.popup.js","../src/js/plot.chart.card/plot.chart.card.js","../src/js/datasets.controller/datasets.controller.listeners.js","../src/js/datasets.controller/datasets.controller.filter.js","../src/js/datasets.controller/datasets.controller.colors.js","../src/js/datasets.controller/datasets.controller.snapshot.js","../src/js/datasets.controller/datasets.controller.data.js","../src/js/data.juggle/data.stacks.js","../src/js/shared/extension.array.js","../src/js/data.juggle/data.combine.ratio.js","../src/js/dataview/dataview.date.js","../src/js/dataview/dataview.date.combined.stacks.js","../src/js/dataview/dataview.location.js","../src/index.js"],"sourcesContent":["/**\n * Color defined by r,g,b.\n * @class Color\n */\nexport class Color {\n\n  /**\n   * Creates a new instance of Color.\n   * @param r The red value.\n   * @param g The green value.\n   * @param b The blue value.\n   */\n  constructor(r, g, b) {\n    if ((r || r === 0) && (g || g === 0) && (b || b === 0)) {\n      this.initialize(r, g, b);\n    } else if (typeof r === `object`) {\n      this.initialize(r.r, r.g, r.b);\n    } else if (r) {\n    } else if (r) {\n      this.initialize(r, r, r);\n    } else {\n      throw new Error(`Invalid argument: ${r}`);\n    }\n  }\n\n  initialize(r, g, b) {\n    this.r = Math.round(r);\n    this.g = Math.round(g);\n    this.b = Math.round(b);\n  }\n\n  rgbString() {\n    return `rgb(${this.r},${this.g},${this.b})`;\n  }\n\n  toString() {\n    return this.rgbString();\n  }\n\n  colorAdding(r, g, b) {\n    return new Color(this.r + r, this.g + g, this.b + b);\n  }\n\n  // MARK: - Statics\n\n  static mapColors(till) {\n    return d3\n      .scaleLinear()\n      .domain([0, 1 / 3 * till, 2 / 3 * till, till])\n      .range(['yellow', 'orange', 'red', 'purple']);\n  }\n\n  static plotColor(till) {\n    return Color.mapColors(till);\n    // return d3\n    //   .scaleLinear()\n    //   .domain([0, 1 / 2 * till, till])\n    //   .range(['lightgreen', 'steelblue', 'purple']);\n  };\n}\n\n/**\n * Returns a randomly generated shared.color.\n * @returns {[]}\n */\nColor.colorsForStack = function (stackNumber, amount = 1) {\n  let colorCouple = Color.stackColors[stackNumber % Color.stackColors.length];\n  let colorGenerator = d3\n    .scaleLinear()\n    .domain([0, amount])\n    .range([colorCouple[0], colorCouple[1]]);\n\n  let colors = [];\n  for (let i = 0; i < amount; i++) {\n    let color = colorGenerator(i);\n    colors.push(new Color(color));\n  }\n\n  return colors;\n};\n\n// MARK: - Defaults\n\nColor.defaultTint = new Color(0, 122, 255);\nColor.organgeLow = new Color(250, 211, 144);\nColor.organgeHigh = new Color(229, 142, 38);\nColor.redLow = new Color(248, 194, 145);\nColor.redHigh = new Color(183, 21, 64);\nColor.blueLow = new Color(106, 137, 204);\nColor.blueHigh = new Color(12, 36, 97);\nColor.lightBlueLow = new Color(130, 204, 221);\nColor.lightBlueHight = new Color(10, 61, 98);\nColor.greenLow = new Color(184, 233, 148);\nColor.greenHight = new Color(7, 153, 146);\nColor.stackColors = [\n  [Color.blueHigh, Color.blueLow],\n  [Color.redHigh, Color.redLow],\n  [Color.greenHight, Color.greenLow],\n  [Color.organgeHigh, Color.organgeLow],\n  [Color.lightBlueHight, Color.lightBlueLow],\n];\n","/**\n * Returns the hash of the given string.\n * @param aString The string to create the hash of.\n * @returns {number} The hash of the given string.\n */\nexport function hashCode(aString) {\n  let hash = 0, i, chr;\n  for (i = 0; i < aString.length; i++) {\n    chr = aString.charCodeAt(i);\n    hash = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n}\n","import {hashCode} from \"./hash\";\n\n/**\n * Creates and returns a unique ID.\n */\nexport var createID;\n(function () {\n  let uniquePrevious = 0;\n  createID = function () {\n    return 'lotivis-id-' + uniquePrevious++;\n  };\n}());\n\n/**\n * Returns a 'save-to-use' id for a HTML element by replacing whitespace with dashes.\n *\n * @param theID The id for a HTML element.\n *\n * @returns {string} The save version of the given id.\n */\nexport function toSaveID(theID) {\n  return theID\n    .split(` `).join(`-`)\n    .split(`/`).join(`-`)\n    .split(`.`).join(`-`);\n}\n\n/**\n * Creates and returns a unique (save to use for elements) id.  The id is created by calculating the hash of the\n * dataset's label.\n *\n * @param dataset The dataset.\n *\n * @returns {number} The created id.\n */\nexport function createIDFromDataset(dataset) {\n  if (!dataset || !dataset.label) return 0;\n  return hashCode(dataset.label);\n}\n\nexport function camel2title(camelCase) {\n  // no side-effects\n  return camelCase\n    // inject space before the upper case letters\n    .replace(/([A-Z])/g, function (match) {\n      return \" \" + match;\n    })\n    // replace first char with upper case\n    .replace(/^./, function (match) {\n      return match.toUpperCase();\n    });\n}\n","export class LotivisError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = this.constructor.name;\n  }\n}\n\nexport class LotivisElementNotFoundError extends LotivisError {\n  constructor(selector) {\n    super(`Can't find an element with ID '${selector}'.`);\n  }\n}\n\nexport class DataValidateError extends LotivisError {\n  // constructor(message) {\n  //   super(message);\n  // }\n}\n\nexport class MissingPropertyError extends DataValidateError {\n  constructor(message, data) {\n    super(message + ' ' + JSON.stringify(data || {}));\n    this.data = data;\n  }\n}\n\nexport class InvalidFormatError extends DataValidateError {\n  // constructor(message) {\n  //   super(message);\n  // }\n}\n\nexport class GeoJSONValidateError extends LotivisError {\n  // constructor(message) {\n  //   super(message);\n  // }\n}\n\nexport class LotivisUnimplementedMethodError extends LotivisError {\n  constructor(functionName) {\n    super(`Subclasses must override function '${functionName}'.`);\n  }\n}\n\nexports.LotivisError = LotivisError;\nexports.DataValidateError = DataValidateError;\nexports.MissingPropertyError = MissingPropertyError;\nexports.InvalidFormatError = InvalidFormatError;\nexports.GeoJSONValidateError = GeoJSONValidateError;\nexports.LotivisUnimplementedMethodError = LotivisUnimplementedMethodError;\n","import {camel2title, createID} from \"../shared/selector\";\nimport {LotivisError, LotivisElementNotFoundError} from \"../data.juggle/data.validate.error\";\n\n/**\n * A lotivis component.\n *\n * @class Component\n */\nexport class Component {\n\n  /**\n   * Creates a new instance of Component.\n   * @param {Component|string|{}} parent The parental component or selector.\n   */\n  constructor(parent) {\n    if (!parent) throw new LotivisError('No parent or selector specified.');\n    if (Object.getPrototypeOf(parent) === String.prototype) {\n      this.initializeFromSelector(parent);\n    } else if (Object.getPrototypeOf(parent) === Object.prototype) {\n      this.initializeFromConfig(parent);\n    } else {\n      this.initializeFromParent(parent);\n    }\n    this.element = undefined;\n  }\n\n  /**\n   * Initializes this component from the given selector string.\n   * @param selector The selector of the parental\n   */\n  initializeFromSelector(selector) {\n    this.selector = selector;\n    this.parent = d3.select('#' + selector);\n    if (this.parent.empty()) throw new LotivisElementNotFoundError(selector);\n  }\n\n  initializeFromConfig(config) {\n    this.config = config;\n    if (config.selector) {\n      this.initializeFromSelector(config.selector);\n    } else {\n      let selector = camel2title(this.constructor.name)\n        .toLowerCase()\n        .trim()\n        .split(` `).join(`-`);\n\n      this.initializeFromSelector(selector);\n    }\n  }\n\n  initializeFromParent(parent) {\n    this.selector = createID();\n    this.parent = parent;\n  }\n\n  // MARK: - Functions\n\n  show() {\n    if (!this.element) return;\n    this.element.style('display', '');\n    return this;\n  }\n\n  hide() {\n    if (!this.element) return;\n    this.element.style('display', 'none');\n    return this;\n  }\n\n  get isVisible() {\n    if (!this.element) return false;\n    return this.element.style('display') !== 'none';\n  }\n\n  getElementEffectiveSize() {\n    if (!this.element) return [0, 0];\n    let width = this.element.style('width').replace('px', '');\n    let height = this.element.style('height').replace('px', '');\n    return [Number(width), Number(height)];\n  }\n\n  getElementPosition() {\n    let element = document.getElementById(this.selector);\n    if (!element) return [0, 0];\n    let rect = element.getBoundingClientRect();\n    let xPosition = rect.x + window.scrollX;\n    let yPosition = rect.y + window.scrollY;\n    return [xPosition, yPosition];\n  }\n\n  /**\n   * Returns a string representation of this Component.\n   * @returns {string} A string representing this Component.\n   */\n  toString() {\n    let components = [this.constructor.name];\n    if (this.selector) components.push(`'${this.selector}'`);\n    return `[${components.join(' ')}]`;\n  }\n\n  /**\n   * Returns the name of the constructor of this component if present. Will return the result of `typeof` else.\n   * @returns {*|\"undefined\"|\"object\"|\"boolean\"|\"number\"|\"string\"|\"function\"|\"symbol\"|\"bigint\"}\n   */\n  getClassname() {\n    if (!this.constructor || !this.constructor.name) return (typeof this);\n    return this.constructor.name;\n  }\n}\n","import {Component} from \"./component\";\n\n/**\n * A button\n *\n * @class Button\n * @extends Component\n */\nexport class Button extends Component {\n\n  /**\n   * Creates an instance of Button.\n   *\n   * @constructor\n   * @param {Component} parent The parental component.\n   * @param style The style of the button.  One of default|back|forward\n   */\n  constructor(parent, style = 'default') {\n    super(parent);\n\n    this.element = parent\n      .append('button')\n      .attr('id', this.selector)\n      .attr('class', 'lotivis-button')\n      .on('click', function (event) {\n        if (!this.onClick) return;\n        this.onClick(event);\n      }.bind(this));\n\n    switch (style) {\n      case 'round':\n        this.element.classed('lotivis-button-round', true);\n        break;\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Sets the text of the button.\n   * @param text The text of the button.\n   */\n  setText(text) {\n    this.element.text(text);\n  }\n\n  onClick(event) {\n    // empty\n  }\n}\n","import {Component} from \"./component\";\n\n/**\n *\n * @class RadioGroup\n * @extends Component\n */\nexport class RadioGroup extends Component {\n\n  /**\n   *\n   * @param parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n\n    this.inputElements = [];\n    this.element = this.parent.append('form');\n    this.element.classed('radio-group', true);\n  }\n\n  /**\n   *\n   * @param optionId\n   * @param optionName\n   * @returns {*}\n   */\n  addOption(optionId, optionName) {\n    let inputElement = this.element\n      .append('input')\n      .attr('type', 'radio')\n      .attr('name', this.selector)\n      .attr('value', optionId)\n      .attr('id', optionId);\n\n    this.element\n      .append('label')\n      .attr('for', optionId)\n      .text(optionName || optionId);\n\n    let thisReference = this;\n    inputElement.on(\"click\", function (event) {\n      thisReference.onClick(event);\n    });\n\n    return inputElement;\n  }\n\n  /**\n   *\n   * @param options\n   * @returns {RadioGroup}\n   */\n  setOptions(options) {\n    this.removeOptions();\n    this.inputElements = [];\n    for (let i = 0; i < options.length; i++) {\n      let id = options[i][0] || options[i].id;\n      let name = options[i][1] || options[i].translatedTitle;\n      let inputElement = this.addOption(id, name);\n      if (i === 0) {\n        inputElement.attr('checked', 'true');\n      }\n      this.inputElements.push(inputElement);\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @param selectedOption\n   * @returns {RadioGroup}\n   */\n  setSelectedOption(selectedOption) {\n    for (let i = 0; i < this.inputElements.length; i++) {\n      let inputElement = this.inputElements[i];\n      let value = inputElement.attr('value');\n      if (value === selectedOption) {\n        inputElement.attr('checked', 'true');\n      }\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @returns {RadioGroup}\n   */\n  removeOptions() {\n    this.element.selectAll('input').remove();\n    this.element.selectAll('label').remove();\n    this.inputElements = [];\n    return this;\n  }\n\n  /**\n   *\n   * @param event\n   */\n  onClick(event) {\n    let element = event.target;\n    if (!element) return;\n\n    let value = element.value;\n    if (!this.onChange) return;\n\n    this.onChange(value);\n\n    return this;\n  }\n\n  // onChange(newFunction) {\n  //     this.onChange = newFunction;\n  //     return this;\n  // }\n  onChange(value) {\n  }\n}\n","import {Component} from \"./component\";\nimport {Button} from \"./button\";\n\n/**\n * A toast in the top of the page.\n *\n * @class Toast\n * @extends Component\n */\nexport class Toast extends Component {\n\n  /**\n   * Creates a new instance of Toast.\n   * @constructor\n   * @param {Component} parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n    this.element = this\n      .parent\n      .append('div')\n      .attr('class', 'lotivis-data-card-status-tooltip')\n      .style('opacity', 0)\n      .style('display', `none`);\n    this.row = this.element\n      .append('div')\n      .attr('class', 'lotivis-row');\n    this.leftComponnt = this.row\n      .append('div')\n      .attr('class', 'lotivis-col-6');\n    this.rightComponent = this.row\n      .append('div')\n      .attr('class', 'lotivis-col-6');\n    this.hideButton = new Button(this.rightComponent)\n      .setText(`Hello`);\n  }\n\n  /**\n   * Shows the toast.\n   * @override\n   */\n  show() {\n    super.show();\n    this.element.style('opacity', 1);\n    return this;\n  }\n\n  /**\n   * Hides the toast.\n   * @override\n   */\n  hide() {\n    super.hide();\n    this.element.style('opacity', 0);\n  }\n\n  /**\n   * Sets the text of the Toast.\n   * @param text The text of the Toast.\n   */\n  setText(text) {\n    this.element.text(text);\n  }\n\n  /**\n   * Sets the text of the status label.  If text is empty the status label will be hide.\n   * @param newStatusMessage The new status message.\n   */\n  setStatusMessage(newStatusMessage) {\n    let saveString = String(newStatusMessage || \"\").trim();\n    this.element.text(saveString);\n    if (saveString) {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n}\n","import {toSaveID} from \"../shared/selector\";\n\n/**\n * Represents an option of a dropdown or radio group.\n * @class Option\n */\nexport class Option {\n\n  /**\n   * Creates a new instance of Option.\n   * @param title The title of the option.\n   */\n  constructor(title) {\n    this.title = title;\n    this.id = toSaveID(title);\n  }\n}\n","export const LotivisConfig = {\n  // The default margin to use for charts.\n  defaultMargin: 60,\n  // The default offset for the space between an object an the toolbar.\n  tooltipOffset: 7,\n  // The default radius to use for bars drawn on a chart.\n  barRadius: 5,\n  // A Boolean value indicating whether the debug logging is enabled.\n  debugLog: false,\n  // A Boolean value indicating whether the debug logging is enabled.\n  debug: true,\n  // A string which is used as prefix for download.\n  downloadFilePrefix: 'lotivis',\n  // A string which is used as separator between shared.components when creating a file name.\n  filenameSeparator: '_',\n  // A string which is used for unknown values.\n  unknown: 'LOTIVIS_UNKNOWN'\n};\n","import {LotivisConfig} from \"./config\";\n\n/**\n * A collection of messages which already hast been printed.\n * @type {*[]}\n */\nlet alreadyLogged = [];\n\nexport var lotivis_log_once = function (message) {\n  if (alreadyLogged.includes(message)) return;\n  alreadyLogged.push(message);\n  console.warn(`[lotivis]  Warning only once: ${message}`);\n};\n\nexport var lotivis_log = () => null;\n\n/**\n * Sets whether lotivis prints debug log messages to the console.\n * @param enabled A Boolean value indicating whether to enable debug logging.\n * @param printConfig A Boolean value indicating whether to print the global lotivis configuration.  Default is false.\n */\nexport function debug(enabled, printConfig = false) {\n  lotivis_log = enabled ? console.log : () => null;\n  lotivis_log(`[lotivis]  ${enabled ? 'En' : 'Dis'}abled debug mode.`);\n  if (!printConfig) return;\n  lotivis_log(`LotivisConfig = ${JSON.stringify(LotivisConfig, null, 2)}`);\n}\n","import {Component} from \"../shared.components/component\";\nimport {createID} from \"../shared/selector\";\nimport {LotivisUnimplementedMethodError} from \"../data.juggle/data.validate.error\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * Superclass for lotivis charts.\n * @class Chart\n * @extends Component\n * @see DateChart\n * @see MapChart\n * @see PlotChart\n */\nexport class Chart extends Component {\n\n  /**\n   * Creates an instance of DiachronicChart.\n   * @constructor\n   * @param {Component} parent The parental component.\n   * @param config The configuration of the chart.\n   */\n  constructor(parent, config) {\n    super(parent);\n\n    this.svgSelector = (this.selector || createID()) + '-svg';\n    this.element = this.parent;\n    this.element.attr('id', this.selector);\n    this.config = config || {};\n    this.updateSensible = true;\n    this.initialize();\n\n    if (this.config.datasets) {\n      this.setDatasets(this.config.datasets);\n    } else {\n      this.update();\n    }\n  }\n\n  /**\n   * Initializes this chart.\n   */\n  initialize() {\n    return new LotivisUnimplementedMethodError(`initialize()`);\n  }\n\n  /**\n   * Updates the content of this chart by calling the 'update'-chain:\n   *\n   * ```\n   * remove();\n   * precalculate();\n   * draw();\n   * ```\n   */\n  update(datasetsController, reason) {\n    lotivis_log('[lotivis] ', this.constructor.name, 'update', reason);\n    if (!this.updateSensible) return;\n    if (datasetsController) {\n      this.snapshot = datasetsController.snapshot;\n    }\n    lotivis_log('[lotivis] ', this.constructor.name, 'update', datasetsController);\n    lotivis_log('[lotivis] ', this.constructor.name, 'update', this.snapshot);\n    this.remove();\n    this.precalculate();\n    this.draw();\n  }\n\n  /**\n   * Precalculates data for this chart.\n   * @returns {LotivisUnimplementedMethodError}\n   */\n  precalculate() {\n    throw new LotivisUnimplementedMethodError(`precalculate()`);\n  }\n\n  /**\n   * Removes any old content from this chart.\n   * @returns {LotivisUnimplementedMethodError}\n   */\n  remove() {\n    throw new LotivisUnimplementedMethodError(`remove()`);\n  }\n\n  /**\n   * Appends / draw the shared.components of this chart.\n   * @returns {LotivisUnimplementedMethodError}\n   */\n  draw() {\n    throw new LotivisUnimplementedMethodError(`draw()`);\n  }\n\n  /**\n   * Tells this chart to ignore updates of a datasets controller.\n   */\n  makeUpdateInsensible() {\n    this.updateSensible = false;\n  }\n\n  /**\n   * Tells this chart to listen to update of a datasets controller.\n   */\n  makeUpdateSensible() {\n    this.updateSensible = true;\n  }\n}\n","/**\n * Returns a copy of the passed object.  The copy is created by using the\n * JSON's `parse` and `stringify` functions.\n * @param object The java script object to copy.\n * @returns {any} The copy of the object.\n */\nexport function copy(object) {\n  return JSON.parse(JSON.stringify(object));\n}\n","import {LotivisConfig} from \"./config\";\n\n/**\n * Returns `true` if the given value not evaluates to false and is not 0. false else.\n * @param value The value to check.\n * @returns {boolean} A Boolean value indicating whether the given value is valid.\n */\nexport function isValue(value) {\n  return Boolean(value || value === 0);\n}\n\n/**\n * Returns the value if it evaluates to true or is 0.  Returns `GlobalConfig.unknown` else.\n * @param value The value to check.\n * @returns The value or `GlobalConfig.unknown`.\n */\nexport function toValue(value) {\n  return value || (value === 0 ? 0 : LotivisConfig.unknown);\n}\n","import {copy} from \"../shared/copy\";\nimport {isValue} from \"../shared/value\";\n\n/**\n *\n * @param flattenList\n * @returns {[]}\n */\nexport function combine(flattenList) {\n  let combined = [];\n  let copiedList = copy(flattenList);\n  for (let index = 0; index < copiedList.length; index++) {\n    let listItem = copiedList[index];\n    let entry = combined.find(function (entryItem) {\n      return entryItem.dataset === listItem.dataset\n        && entryItem.stack === listItem.stack\n        && entryItem.label === listItem.label\n        && entryItem.location === listItem.location\n        && entryItem.date === listItem.date;\n    });\n    if (entry) {\n      entry.value += (listItem.value + 0);\n    } else {\n      let entry = {};\n      if (isValue(listItem.label)) entry.label = listItem.label;\n      if (isValue(listItem.dataset)) entry.dataset = listItem.dataset;\n      if (isValue(listItem.stack)) entry.stack = listItem.stack;\n      if (isValue(listItem.location)) entry.location = listItem.location;\n      if (isValue(listItem.locationTotal)) entry.locationTotal = listItem.locationTotal;\n      if (isValue(listItem.date)) entry.date = listItem.date;\n      if (isValue(listItem.dateTotal)) entry.dateTotal = listItem.dateTotal;\n      if (isValue(listItem.locationName)) entry.locationName = listItem.locationName;\n      entry.value = (listItem.value || 0);\n      combined.push(entry);\n    }\n  }\n  return combined;\n}\n\n/**\n * Returns\n *\n * @param flattenList\n * @returns {[]}\n */\nexport function combineByStacks(flattenList) {\n  let combined = [];\n  for (let index = 0; index < flattenList.length; index++) {\n    let listItem = flattenList[index];\n\n    let entry = combined.find(function (entryItem) {\n      return entryItem.stack === listItem.stack\n        && entryItem.location === listItem.location\n        && entryItem.date === listItem.date;\n    });\n\n    if (entry) {\n      entry.value += (listItem.value + 0);\n    } else {\n      let entry = {};\n      if (isValue(listItem.label)) entry.label = listItem.label;\n      if (isValue(listItem.dataset)) entry.dataset = listItem.dataset;\n      if (isValue(listItem.stack)) entry.stack = listItem.stack;\n      if (isValue(listItem.location)) entry.location = listItem.location;\n      if (isValue(listItem.locationTotal)) entry.locationTotal = listItem.locationTotal;\n      if (isValue(listItem.date)) entry.date = listItem.date;\n      if (isValue(listItem.dateTotal)) entry.dateTotal = listItem.dateTotal;\n      if (isValue(listItem.locationName)) entry.locationName = listItem.locationName;\n      entry.value = (listItem.value || 0);\n      combined.push(entry);\n    }\n  }\n  return combined;\n}\n\n/**\n *\n * @param flatData\n * @returns {[]}\n */\nexport function combineByDate(flatData) {\n  let combined = [];\n  for (let index = 0; index < flatData.length; index++) {\n    let listItem = flatData[index];\n    let entry = combined.find(function (entryItem) {\n      return entryItem.dataset === listItem.dataset\n        && entryItem.stack === listItem.stack\n        && entryItem.label === listItem.label\n        && entryItem.date === listItem.date;\n    });\n    if (entry) {\n      entry.value += (listItem.value + 0);\n    } else {\n      let entry = {};\n      if (isValue(listItem.label)) entry.label = listItem.label;\n      if (isValue(listItem.dataset)) entry.dataset = listItem.dataset;\n      if (isValue(listItem.stack)) entry.stack = listItem.stack;\n      if (isValue(listItem.date)) entry.date = listItem.date;\n      if (isValue(listItem.dateTotal)) entry.dateTotal = listItem.dateTotal;\n      entry.value = (listItem.value || 0);\n      combined.push(entry);\n    }\n  }\n  return combined;\n}\n\n/**\n *\n * @param flatData\n * @returns {[]}\n */\nexport function combineByLocation(flatData) {\n  let combined = [];\n  for (let index = 0; index < flatData.length; index++) {\n    let listItem = flatData[index];\n    let entry = combined.find(function (entryItem) {\n      return entryItem.dataset === listItem.dataset\n        && entryItem.stack === listItem.stack\n        && entryItem.label === listItem.label\n        && entryItem.location === listItem.location;\n    });\n    if (entry) {\n      entry.value += listItem.value;\n    } else {\n      let entry = {};\n      if (isValue(listItem.label)) entry.label = listItem.label;\n      if (isValue(listItem.dataset)) entry.dataset = listItem.dataset;\n      if (isValue(listItem.stack)) entry.stack = listItem.stack;\n      if (isValue(listItem.location)) entry.location = listItem.location;\n      if (isValue(listItem.locationTotal)) entry.locationTotal = listItem.locationTotal;\n      if (isValue(listItem.locationName)) entry.locationName = listItem.locationName;\n      entry.value = listItem.value;\n      combined.push(entry);\n    }\n  }\n  return combined;\n}\n","/**\n * Returns the sum of samples values for the given dataset.\n *\n * @param flatData The flat samples array.\n * @param dataset The dataset name.\n * @returns {*} The sum.\n */\nexport function sumOfDataset(flatData, dataset) {\n  return sumOfValues(flatData.filter(item => item.dataset === dataset));\n}\n\n/**\n * Returns the sum of samples values for the given label.\n *\n * @param flatData The flat samples array.\n * @param label The label.\n * @returns {*} The sum.\n */\nexport function sumOfLabel(flatData, label) {\n  return sumOfValues(flatData.filter(item => item.label === label));\n}\n\n/**\n * Returns the sum of samples values for the given stack.\n *\n * @param flatData The flat samples array.\n * @param stack The stack name.\n * @returns {*} The sum.\n */\nexport function sumOfStack(flatData, stack) {\n  return sumOfValues(flatData.filter(item => item.stack === stack));\n}\n\n/**\n * Returns the sum of the value properties of each item.\n *\n * @param flatData\n * @returns {*}\n */\nexport function sumOfValues(flatData) {\n  return flatData.map(item => +(item.value || 0)).reduce((acc, next) => acc + next, 0);\n}\n","import {lotivis_log_once} from \"../shared/debug\";\n\n/**\n *\n * @param date\n * @constructor\n */\nexport const DefaultDateAccess = (date) => date;\n\n/**\n *\n * @param dateString\n * @returns {number}\n * @constructor\n */\nexport const FormattedDateAccess = function (dateString) {\n  let value = Date.parse(dateString);\n  if (isNaN(value)) {\n    lotivis_log_once(`Received NaN for date \"${dateString}\"`);\n  }\n  return value;\n};\n\n/**\n *\n * @param dateString\n *\n * @returns {number}\n *\n * @constructor\n */\nexport const DateGermanAssessor = function (dateString) {\n  let saveDateString = String(dateString);\n  let components = saveDateString.split('.');\n  let day = components[0];\n  let month = components[1];\n  let year = components[2];\n  let date = new Date(`${year}-${month}-${day}`);\n  return Number(date);\n};\n\n/**\n *\n * @param weekday\n * @returns {number}\n * @constructor\n */\nexport const DateWeekAssessor = function (weekday) {\n  let lowercase = weekday.toLowerCase();\n  switch (lowercase) {\n    case 'sunday':\n    case 'sun':\n      return 0;\n    case 'monday':\n    case 'mon':\n      return 1;\n    case 'tuesday':\n    case 'tue':\n      return 2;\n    case 'wednesday':\n    case 'wed':\n      return 3;\n    case 'thursday':\n    case 'thr':\n      return 4;\n    case 'friday':\n    case 'fri':\n      return 5;\n    case 'saturday':\n    case 'sat':\n      return 6;\n    default:\n      return -1;\n  }\n};\n","/**\n * @class DataViewCache\n */\nexport class DataViewCache {\n\n  /**\n   * Creates a new instance of DataViewCache.\n   */\n  constructor() {\n    let content = {};\n\n    /**\n     * Creates an identifier for a cached data view with the given parameters.\n     * @param type The type of the graph.\n     * @param locationFilters The collection of filtered locations.\n     * @param dateFilters The collection of filtered dates.\n     * @param datasetFilters The collection of filtered datasets.\n     * @returns {*}\n     */\n    function createName(type, locationFilters, dateFilters, datasetFilters) {\n      return type + locationFilters + dateFilters + datasetFilters;\n    }\n\n    /**\n     * Returns the cached data view for the given parameters.\n     * @param type The type of the graph.\n     * @param locationFilters The collection of filtered locations.\n     * @param dateFilters The collection of filtered dates.\n     * @param datasetFilters The collection of filtered datasets.\n     * @returns {*}\n     */\n    this.getDataView = function (type, locationFilters, dateFilters, datasetFilters) {\n      let name = createName(type, locationFilters, dateFilters, datasetFilters);\n      return content[name];\n    };\n\n    /**\n     * Inserts the given data view into the cache for the given parameters.\n     * @param dataView The data view to cache.\n     * @param type The type of the graph.\n     * @param locationFilters The collection of filtered locations.\n     * @param dateFilters The collection of filtered dates.\n     * @param datasetFilters The collection of filtered datasets.\n     */\n    this.setDataView = function (dataView, type, locationFilters, dateFilters, datasetFilters) {\n      let name = createName(type, locationFilters, dateFilters, datasetFilters);\n      content[name] = dataView;\n    };\n\n    /**\n     * Invalidates the cache.\n     */\n    this.invalidate = function () {\n      content = {};\n    };\n  }\n}\n","import {combineByDate, combineByLocation, combineByStacks} from \"../data.juggle/data.combine\";\nimport {sumOfDataset, sumOfLabel, sumOfStack} from \"../data.juggle/data.sum\";\nimport {DefaultDateAccess} from \"../data.date.assessor/date.assessor\";\nimport {InvalidFormatError} from \"../data.juggle/data.validate.error\";\nimport {DataViewCache} from \"../dataview/data.view.cache\";\n\n/**\n * Controls a collection of datasets.\n * @class DatasetsController\n */\nexport class DatasetsController {\n\n  /**\n   * Creates a new instance of DatasetsController\n   * @param datasets The datasets to control.\n   * @param config\n   */\n  constructor(datasets, config) {\n    if (!Array.isArray(datasets)) {\n      throw new InvalidFormatError(`Datasets are not an array.`);\n    }\n    this.initialize(config || {});\n    this.setDatasets(datasets);\n  }\n\n  initialize(config) {\n    this.config = config;\n    this.dateAccess = this.config.dateAccess || DefaultDateAccess;\n    this.filters = {};\n    this.cache = new DataViewCache();\n    if (this.config.filters) {\n      this.filters.locations = this.config.filters.locations || [];\n      this.filters.dates = this.config.filters.dates || [];\n      this.filters.labels = this.config.filters.labels || [];\n    } else {\n      this.filters.locations = [];\n      this.filters.dates = [];\n      this.filters.labels = [];\n    }\n  }\n\n  getFlatDataCombinedStacks() {\n    return combineByStacks(this.flatData);\n  }\n\n  getFlatDataCombinedDates() {\n    return combineByDate(this.flatData);\n  }\n\n  getFlatDataCombinedLocations() {\n    return combineByLocation(this.flatData);\n  }\n\n  getSumOfLabel(label) {\n    return sumOfLabel(this.flatData, label);\n  }\n\n  getSumOfDataset(dataset) {\n    return sumOfDataset(this.flatData, dataset);\n  }\n\n  getSumOfStack(stack) {\n    return sumOfStack(this.flatData, stack);\n  }\n\n  getMax() {\n    return d3.max(this.datasets, function (dataset) {\n      return d3.max(dataset.data, function (item) {\n        return item.value;\n      });\n    });\n  }\n\n  // MARK: - Colors\n\n  getColorForDataset(label) {\n    return this.datasetsColorsController.colorForDataset(label);\n  }\n\n  getColorForStack(stack) {\n    return this.datasetsColorsController.colorForStack(stack);\n  }\n\n  getColorsForStack(stack) {\n    return this.datasetsColorsController.colorsForStack(stack);\n  }\n\n  /**\n   * Returns a string that can be used as filename for downloads.\n   */\n  getFilename() {\n    if (!this.labels) return 'Unknown';\n    let labels = this.labels.map(label => label.split(` `).join(`-`));\n    if (labels.length > 10) {\n      labels = labels.splice(0, 10);\n    }\n    return labels.join(',');\n  }\n}\n","import {Chart} from \"./chart\";\nimport {DatasetsController} from \"../datasets.controller/datasets.controller\";\n\n/**\n * Sets a new datasets controller.  The chart is updated automatically.\n * @param newController The new datasets controller.\n */\nChart.prototype.setDatasetsController = function (newController) {\n  if (this.datasetController) this.datasetController.removeListener(this);\n  this.datasetController = newController;\n  this.datasetController.addListener(this);\n  this.update(newController, 'registration');\n};\n\n/**\n * Sets the datasets of this map.chart chart.\n * @param newDatasets The new dataset.\n */\nChart.prototype.setDatasets = function (newDatasets) {\n  this.setDatasetsController(new DatasetsController(newDatasets));\n};\n\n/**\n * Returns the presented datasets.\n * @returns {[*]} The collection of datasets.\n */\nChart.prototype.getDatasets = function () {\n  if (!this.datasetController || !Array.isArray(this.datasetController.datasets)) return [];\n  return this.datasetController.datasets;\n};\n","import {Component} from \"./component\";\n\n/**\n * A lotivis card.\n * @class Card\n * @extends Component\n */\nexport class Card extends Component {\n\n  /**\n   * Creates a new instance of Card.\n   * @param parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n    this.injectCard();\n    this.injectHeader();\n    this.injectBody();\n    this.injectFooter();\n  }\n\n  /**\n   * Appends the card element.\n   */\n  injectCard() {\n    this.element = this.parent\n      .append('div')\n      .classed('lotivis-card', true);\n  }\n\n  /**\n   * Appends the header of the card.\n   */\n  injectHeader() {\n    this.header = this.element\n      .append('div')\n      .attr('class', 'lotivis-card-header');\n    this.headerRow = this.header\n      .append('div')\n      .attr('class', 'lotivis-row');\n    this.headerLeftComponent = this.headerRow\n      .append('div')\n      .attr('class', 'lotivis-card-header-left');\n    this.headerCenterComponent = this.headerRow\n      .append('div')\n      .attr('class', 'lotivis-card-header-center');\n    this.headerRightComponent = this.headerRow\n      .append('div')\n      .attr('class', 'lotivis-card-header-right lotivis-button-group');\n    this.titleLabel = this.headerLeftComponent\n      .append('div')\n      .attr('class', 'lotivis-title-label');\n  }\n\n  /**\n   * Appends the body of the card.\n   */\n  injectBody() {\n    this.body = this.element\n      .append('div')\n      .attr('class', 'lotivis-card-body');\n    this.content = this.body\n      .append('div')\n      .attr('class', 'lotivis-card-body-content');\n  }\n\n  /**\n   * Appends the footer of the card.\n   */\n  injectFooter() {\n    this.footer = this.element\n      .append('div')\n      .attr('class', 'lotivis-card-footer');\n    this.footerRow = this.footer\n      .append('div')\n      .attr('class', 'lotivis-row');\n    this.footerLeftComponent = this.footerRow\n      .append('div')\n      .attr('class', 'lotivis-col-6');\n    this.footerRightComponent = this.footerRow\n      .append('div')\n      .attr('class', 'lotivis-col-6');\n    this.footer.style('display', 'none');\n  }\n\n  /**\n   * Sets the text of the title label.\n   * @param newTitle The text of the title label.\n   */\n  setTitle(newTitle) {\n    this.titleLabel.text(newTitle);\n  }\n\n  /**\n   * Shows the footer by resetting its style display value.\n   */\n  showFooter() {\n    this.footer.style('display', '');\n  }\n\n  /**\n   * Hides the footer by setting its style display value to `none`.\n   */\n  hideFooter() {\n    this.footer.style('display', 'none');\n  }\n}\n","import {Component} from \"./component\";\n\nexport class Checkbox extends Component {\n  constructor(parent) {\n    super(parent);\n    this.renderInput();\n    this.renderLabel();\n  }\n\n  // MARK: - Life Cycle\n  renderInput() {\n    let thisReference = this;\n    this.element = this.parent\n      .classed('radio-group', true)\n      .append('input')\n      .attr('type', 'checkbox')\n      .attr('id', this.selector)\n      .on('click', function (event) {\n        if (!event.target) {\n          return;\n        }\n        let checkbox = event.target;\n        if (thisReference.onClick) {\n          thisReference.onClick(checkbox.checked);\n        }\n      });\n  }\n\n  renderLabel() {\n    this.label = this.parent\n      .append('label')\n      .attr('for', this.selector)\n      .text('Unknown');\n  }\n\n  // MARK: - Functions\n  setText(text) {\n    this.label.text(text);\n    return this;\n  }\n\n  setChecked(checked) {\n    this.element.attr('checked', checked === true ? checked : null);\n    return this;\n  }\n\n  onClick(checked) {\n    // empty\n    console.log('onClick: ' + checked);\n  }\n\n  enable() {\n    this.element.attr('disabled', null);\n    this.label.style('color', 'black');\n  }\n\n  disable() {\n    this.element.attr('disabled', true);\n    this.label.style('color', 'gray');\n  }\n}\n","import {Component} from './component';\nimport {createID} from '../shared/selector';\nimport {Card} from './card';\nimport {Button} from './button';\n\n/**\n * A lotivis popup.\n *\n * +----------------------------------------------------------------+\n * |                                                                |\n * |                                                                |\n *\n * @class Popup\n * @extends Component\n */\nexport class Popup extends Component {\n\n  /**\n   * Creates a new instance of Popup.\n   * @param parent The parental component.\n   */\n  constructor(parent = d3.select('body')) {\n    super(parent);\n    this.injectUnderground(parent);\n    this.injectContainer();\n    this.injectCard();\n    this.inject();\n    this.injectCloseButton();\n    this.addCloseActionListeners();\n  }\n\n  // MARK: - Render\n\n  /**\n   * Appends shared.components to this popup.\n   * Should be overridden by subclasses.\n   */\n  inject() {\n    // empty\n  }\n\n  /**\n   * Appends the 'dim' background to the given parent.\n   *\n   * @param parent The parental element.\n   */\n  injectUnderground(parent) {\n    this.modalBackgroundId = createID();\n    this.modalBackground = parent\n      .append('div')\n      .classed('lotivis-popup-underground lotivis-fade-in', true)\n      .attr('id', this.modalBackgroundId);\n  }\n\n  /**\n   *\n   */\n  injectContainer() {\n    this.elementId = createID();\n    this.element = this.modalBackground\n      .append('div')\n      .classed('lotivis-popup', true)\n      .attr('id', this.elementId);\n  }\n\n  /**\n   *\n   */\n  injectCard() {\n    this.card = new Card(this.element);\n    this.card.element.classed('lotivis-popup', true);\n  }\n\n  /**\n   * Appends a close button to the right header component.\n   */\n  injectCloseButton() {\n    this.closeButton = new Button(this.card.headerRightComponent);\n    this.closeButton.element.classed('lotivis-button-small', true);\n    this.closeButton.setText('Close');\n  }\n\n  /**\n   * Appends an on click listener to the button.\n   */\n  addCloseActionListeners() {\n    let validIDs = [\n      this.closeButton.selector,\n      this.modalBackgroundId\n    ];\n    let popup = this;\n    this.modalBackground.on('click', function (event) {\n      if (!event || !event.target) return;\n      if (!validIDs.includes(event.target.id)) return;\n      popup.dismiss();\n    });\n  }\n\n  // MARK: - Life Cycle\n\n  /**\n   * Tells the receiving popup that it is about to be presented.\n   *\n   * Subclasses may override.\n   */\n  willShow() {\n    // empty\n  }\n\n  /**\n   * Tells the receiving popup that it is now presented.\n   *\n   * Subclasses may override.\n   */\n  didShow() {\n    // empty\n  }\n\n  /**\n   * Presents the popup.\n   */\n  show() {\n    if (this.willShow) this.willShow();\n    this.getUnderground().style.display = 'block';\n    if (this.didShow) this.didShow();\n  }\n\n  /**\n   * Tells the receiving popup that it is about to be dismissed.\n   *\n   * Subclasses may override.\n   */\n  willDismiss() {\n    // empty\n  }\n\n  /**\n   * Tells the receiving popup that the DOM element will be removed.\n   *\n   * Subclasses may override.\n   */\n  willRemoveDOMElement() {\n    // empty\n  }\n\n  /**\n   * Dismisses the popup.\n   */\n  dismiss() {\n    if (this.willDismiss) this.willDismiss();\n    this.getUnderground().style.display = 'none';\n    if (this.willRemoveDOMElement) this.willRemoveDOMElement();\n    this.getUnderground().remove();\n  }\n\n  getUnderground() {\n    return document.getElementById(this.modalBackgroundId);\n  }\n\n  showUnder(sourceElement, position = 'center') {\n    if (!sourceElement) return;\n\n    let preferredSize = this.preferredSize();\n    let origin = this.calculateBottomCenter(sourceElement);\n\n    if (position === 'left') {\n      origin.x -= origin.width / 2;\n    } else if (position === 'right') {\n      origin.x -= preferredSize.width - origin.width / 2;\n    } else { // assume center\n      origin.x -= (preferredSize.width / 2);\n    }\n\n    let id = this.elementId;\n    let popup = document.getElementById(id);\n\n    popup.style.position = 'absolute';\n    popup.style.width = preferredSize.width + 'px';\n    // popup.style.height = preferredSize.height + 'px';\n    popup.style.left = origin.x + 'px';\n    popup.style.top = origin.y + 'px';\n\n    this.show();\n  }\n\n  showBigModal() {\n    let id = this.elementId;\n    let popup = document.getElementById(id);\n    let preferredSize = this.preferredSize();\n\n    popup.style.position = 'relative';\n    popup.style.margin = '50px auto';\n    popup.style.width = preferredSize.width + 'px';\n\n    this.show();\n  }\n\n  /**\n   * Returns the preferred size of the popup.  Subclasses may override in order to\n   * change the size of the popup.\n   *\n   * @returns {{width: number, height: number}}\n   */\n  preferredSize() {\n    return {\n      width: 300,\n      height: 300\n    };\n  }\n\n  /**\n   * Returns the bottom middle point of the passed element.\n   *\n   * @param element\n   * @param respectWindowScroll\n   * @returns {{x: number, width: number, y: number, height: number}}\n   */\n  calculateBottomCenter(element, respectWindowScroll = false) {\n    let rect = element.getBoundingClientRect();\n    let x = rect.x + (rect.width / 2);\n    let y = rect.y + rect.height;\n\n    if (respectWindowScroll) {\n      x += window.scrollX;\n      y += window.scrollY;\n    }\n\n    return {\n      x: x,\n      y: y,\n      width: rect.width,\n      height: rect.height\n    };\n  }\n}\n","import {Popup} from \"./popup\";\n\n/**\n *\n * @class ModalPopup\n * @extends Popup\n */\nexport class ModalPopup extends Popup {\n\n  /**\n   *\n   * @param parent\n   */\n  constructor(parent) {\n    super(parent);\n    this.modalBackground\n      .classed('popup-underground', false)\n      .classed('modal-underground', true);\n  }\n\n  /**\n   *\n   */\n  inject() {\n    super.inject();\n    this.renderRow();\n  }\n\n  /**\n   *\n   */\n  renderRow() {\n    this.row = this.card.body\n      .append('div')\n      .classed('row', true);\n    this.content = this.row\n      .append('div')\n      .classed('col-12 info-box-margin', true);\n  }\n\n  /**\n   *\n   */\n  loadContent(url) {\n    if (!url) return;\n    let content = this.content;\n\n    d3.text(url)\n      .then(function (text) {\n        console.log(text);\n        content.html(text);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  }\n\n  /**\n   * Returns the preferred size. The default is 800, 600.\n   * @returns {{width: number, height: number}} The preferred size.\n   */\n  preferredSize() {\n    return {\n      width: 800,\n      height: 600\n    };\n  }\n}\n","import {Component} from \"./component\";\nimport {createID} from \"../shared/selector\";\n\n/**\n *\n * @class Dropdown\n * @extends Component\n */\nexport class Dropdown extends Component {\n\n  /**\n   * Creates a new instance of Dropdown.\n   * @param parent The parent or selector.\n   */\n  constructor(parent) {\n    super(parent);\n    this.inputElements = [];\n    this.selector = createID();\n    this.element = parent\n      .append('div')\n      .classed('lotivis-dropdown-container', true);\n    this.selectId = createID();\n    this.renderLabel();\n    this.renderSelect();\n  }\n\n  renderLabel() {\n    this.label = this.element\n      .append('label')\n      .classed('lotivis-dropdown-label', true)\n      .attr('for', this.selectId);\n  }\n\n  renderSelect() {\n    let thisReference = this;\n    this.select = this.element\n      .append('select')\n      .attr('id', this.selectId)\n      .on('change', function (event) {\n        thisReference.onClick(event);\n      });\n  }\n\n  addOption(optionId, optionName) {\n    return this.select\n      .append('option')\n      .attr('id', optionId)\n      .attr('value', optionId)\n      .text(optionName);\n  }\n\n  setOptions(options) {\n    this.removeAllInputs();\n    for (let i = 0; i < options.length; i++) {\n      let id, name;\n\n      if (Array.isArray(options[i])) {\n        id = options[i][0] || options[i].id;\n        name = options[i][1] || options[i].translatedTitle;\n      } else if (typeof options[i] === 'string') {\n        id = options[i];\n        name = options[i];\n      } else {\n        id = options[i].id;\n        name = options[i].title;\n      }\n\n      let inputElement = this.addOption(name, name);\n      this.inputElements.push(inputElement);\n    }\n    return this;\n  }\n\n  removeAllInputs() {\n    this.element.selectAll('input').remove();\n    return this;\n  }\n\n  onClick(event) {\n    let element = event.target;\n    if (!element) {\n      return;\n    }\n    let value = element.value;\n    if (!this.onChange) {\n      return;\n    }\n    this.onChange(value);\n    return this;\n  }\n\n  onChange(argument) {\n    console.log('argument: ' + argument);\n    if (typeof argument !== 'string') {\n      this.onChange = argument;\n    } else {\n\n    }\n    return this;\n  }\n\n  // MARK: - Chaining Setter\n\n  setLabelText(text) {\n    this.label.text(text);\n    return this;\n  }\n\n  setOnChange(callback) {\n    this.onChange = callback;\n    return this;\n  }\n\n  setSelectedOption(optionID) {\n    if (this.inputElements.find(function (item) {\n      return item.attr('value') === optionID;\n    }) !== undefined) {\n      this.value = optionID;\n    }\n    return this;\n  }\n\n  set value(optionID) {\n    document.getElementById(this.selectId).value = optionID;\n  }\n\n  get value() {\n    return document.getElementById(this.selectId).value;\n  }\n}\n\nDropdown.create = function (selector, options, selectedOption, onChange) {\n  let div = d3.select(`#${selector}`);\n  let dropdown = new Dropdown(div);\n  dropdown.setLabelText('Group Size');\n  dropdown.setOptions(options);\n  dropdown.setSelectedOption(selectedOption);\n  dropdown.setOnChange(onChange);\n  return dropdown;\n};\n","import {Card} from \"./card\";\nimport {createID} from \"../shared/selector\";\nimport {Button} from \"./button\";\nimport {LotivisError, LotivisUnimplementedMethodError} from \"../data.juggle/data.validate.error\";\n\n/**\n * A lotivis card containing a textarea.\n * @class TextareaCard\n * @extends Card\n */\nexport class TextareaCard extends Card {\n\n  /**\n   * Creates a new instance of TextareaCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent) {\n    super(parent);\n    this.render();\n    this.updateSensible = true;\n\n    if (this.config) {\n      this.textarea.attr('rows', this.config.lines || 25);\n      this.setTitle(this.config.title || this.getClassname());\n    } else {\n      this.textarea.attr('rows', 25);\n      this.setTitle(this.getClassname());\n    }\n  }\n\n  /**\n   * Appends the component to this card.\n   */\n  render() {\n    this.textareaID = createID();\n    this.textarea = this.body\n      .append('textarea')\n      .attr('id', this.textareaID)\n      .attr('name', this.textareaID)\n      .attr('class', 'lotivis-data-textarea')\n      .on('keyup', this.onKeyup.bind(this));\n    this.downloadButton = new Button(this.headerRightComponent);\n    this.downloadButton.setText('Download');\n    this.downloadButton.onClick = function (event) {\n      let content = this.getTextareaContent();\n      this.download(content);\n    }.bind(this);\n  }\n\n  /**\n   * Returns the text of the textarea.\n   * @returns {*} The text of the textarea.\n   */\n  getTextareaContent() {\n    return document.getElementById(this.textareaID).value || \"\";\n  }\n\n  /**\n   * Sets the text of the textarea.\n   * @param newContent The text for the textarea.\n   */\n  setTextareaContent(newContent) {\n    let textarea = document.getElementById(this.textareaID);\n    if (!textarea) return;\n    textarea.value = newContent;\n\n    if (this.config && this.config.updatesHeight !== true) return;\n    if (typeof newContent !== 'string') return;\n    let numberOfRows = newContent.split(`\\n`).length;\n    this.textarea.attr('rows', numberOfRows);\n  }\n\n  /**\n   * Enable the textarea.\n   */\n  enableTextarea() {\n    this.textarea.attr('disabled', null);\n    [this.textarea, this.titleLabel].forEach(item => item.classed('lotivis-disabled', false));\n  }\n\n  /**\n   * Disables the textarea.\n   */\n  disableTextarea() {\n    this.textarea.attr('disabled', '');\n    [this.textarea, this.titleLabel].forEach(item => item.classed('lotivis-disabled', true));\n  }\n\n  /**\n   * Tells this dataset card that a 'keyup'-event occurred in the textarea.\n   * @param event The key event.\n   */\n  onKeyup(event) {\n    throw new LotivisUnimplementedMethodError(`onKeyup(event)`);\n  }\n\n  /**\n   * Initiates a download of the content of the textarea.\n   * @param content The new content of the textarea.\n   */\n  download(content) {\n    throw new LotivisUnimplementedMethodError(`download(content)`);\n  }\n}\n","import {TextareaCard} from \"../shared.components/textarea.card\";\nimport {lotivis_log} from \"../shared/debug\";\nimport {LotivisUnimplementedMethodError} from \"../data.juggle/data.validate.error\";\n\n/**\n *\n * @class UpdatableDataviewCard\n * @extends TextareaCard\n */\nexport class UpdatableDataviewCard extends TextareaCard {\n\n  /**\n   * Creates a new instance of UpdatableDataviewCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent = {}) {\n    // parent.title = parent.title || 'UpdatableDataviewCard';\n    super(parent);\n    this.updateSensible = true;\n    this.downloadButton.hide();\n  }\n\n  /**\n   * Sets the dataset controller.\n   * @param newDatasetController\n   */\n  setDatasetsController(newDatasetController) {\n    this.datasetsController = newDatasetController;\n    this.datasetsController.addListener(this);\n  }\n\n  /**\n   * Tells thi dataset card that the datasets of the datasets controller has changed.\n   * @param datasetsController The datasets controller.\n   * @param reason The reason of the update.\n   */\n  update(datasetsController, reason) {\n    if (!this.updateSensible) {\n      lotivis_log(`[lotivis]  NOT sensible ${this}. Reason '${reason}'.`);\n      return;\n    } else if (this.config && this.config.updateSensible === false) {\n      lotivis_log(`[lotivis]  NOT sensible (Config) ${this}. Reason '${reason}'.`);\n      return;\n    } else if (!datasetsController) {\n      lotivis_log(`[lotivis]  NO controller ${this}. Reason '${reason}'.`);\n      return;\n    }\n\n    let datasets = datasetsController.datasets;\n    let content = this.datasetsToText(datasetsController, datasets);\n\n    this.setTextareaContent(content);\n    this.cachedDatasets = datasets;\n\n    lotivis_log(`[lotivis]  Update ${this}. Reason '${reason}'.`);\n  }\n\n  /**\n   * Sets the content of the textarea by rendering the given datasets to text.  Subclasses should override.\n   * @param controller The datasets controller.\n   * @param datasets The datasets to render.\n   * @return {*}\n   */\n  datasetsToText(controller, datasets) {\n    throw new LotivisUnimplementedMethodError(`Subclasses should override.`);\n  }\n}\n","import {\n  InvalidFormatError,\n  MissingPropertyError\n} from \"./data.validate.error\";\n\n/**\n * Validates the given datasets.\n * @param datasets The datasets to validate.\n * @throws InvalidFormatError\n */\nexport function validateDatasets(datasets) {\n\n  if (!datasets) {\n    throw new InvalidFormatError(`No dataset given.`);\n  } else if (!Array.isArray(datasets)) {\n    throw new InvalidFormatError(`Expecting array of datasets.`);\n  }\n\n  for (let index = 0; index < datasets.length; index++) {\n    validateDataset(datasets[index]);\n  }\n}\n\n/**\n * Validates the given dataset.\n * @param dataset The dataset to validate.\n * @throws InvalidFormatError\n * @throws MissingPropertyError\n */\nexport function validateDataset(dataset) {\n  if (!dataset) {\n    throw new InvalidFormatError(`No dataset given.`);\n  } else if (!dataset.label) {\n    throw new MissingPropertyError(`Missing label for dataset. ${dataset}`);\n  } else if (!dataset.data) {\n    throw new MissingPropertyError(`Invalid data. Property is not an array. Dataset: ${dataset.label}`);\n  } else if (!Array.isArray(dataset.data)) {\n    throw new InvalidFormatError(`Invalid data. Property is not an array. Dataset: ${dataset.label}`);\n  }\n\n  let data = dataset;\n  for (let index = 0; index < data.length; index++) {\n    validateDataItem(data[index]);\n  }\n}\n\n/**\n * Validates the given datasets.controller item by ensuring it has a valid `date.chart`, `location` and `value` property value.\n * @param item The datasets.controller item to validate.\n * @throws MissingPropertyError\n */\nexport function validateDataItem(item) {\n  if (!item.date) {\n    throw new MissingPropertyError(`Missing date property for item.`, item);\n  } else if (!item.location) {\n    throw new MissingPropertyError(`Missing location property for item.`, item);\n  }\n}\n","/**\n * Compares the string version of each oof the two given values for equality.\n *\n * @param value1 The first value to compare.\n * @param value2 The second value to compare.\n * @returns {boolean} `True` if the string versions are equal, `false` if not.\n */\nexport function equals(value1, value2) {\n  return String(value1) === String(value2);\n}\n\n/**\n * Returns a Boolean value indicating whether the JSON string version of the given two objects are equal.\n *\n * @param object1 The first object to compare.\n * @param object2 The second object to compare.\n * @returns {boolean} `True` if the JSON strings of the given objects are equal,`false` if not.\n */\nexport function objectsEqual(object1, object2) {\n  if (object1 === object2) return true;\n  let string1 = JSON.stringify(object1);\n  let string2 = JSON.stringify(object2);\n  return string1 === string2;\n}\n","import {Toast} from \"../shared.components/toast\";\nimport {validateDatasets} from \"../data.juggle/data.validate\";\nimport {lotivis_log} from \"../shared/debug\";\nimport {objectsEqual} from \"../shared/equal\";\nimport {UpdatableDataviewCard} from \"./updatable.dataview.card\";\nimport {LotivisUnimplementedMethodError} from \"../data.juggle/data.validate.error\";\n\n/**\n *\n * @class EditableDataviewCard\n * @extends UpdatableDataviewCard\n */\nexport class EditableDataviewCard extends UpdatableDataviewCard {\n\n  /**\n   * Creates a new instance of DatasetCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent) {\n    super(parent);\n    this.toast = new Toast(this.parent);\n    this.downloadButton.show();\n  }\n\n  /**\n   * Tells this dataset card that a 'keyup'-event occurred in the textarea.\n   */\n  onKeyup() {\n    this.updateDatasetsOfController.bind(this)(true);\n  }\n\n  /**\n   * Tells\n   * @param notifyController A boolean value indicating whether the datasets controller should be notified about the\n   * update.\n   */\n  updateDatasetsOfController(notifyController = false) {\n\n    let content = this.getTextareaContent();\n    this.toast.setStatusMessage(null);\n\n    try {\n\n      // will throw an error if parsing is not possible\n      let parsedDatasets = this.textToDatasets(content);\n      if (!parsedDatasets) return;\n\n      // will throw an error if parsed datasets aren't valid.\n      validateDatasets(parsedDatasets);\n\n      if (notifyController === true) {\n\n        if (!this.datasetsController) {\n          return lotivis_log(`[lotivis]  No datasets controller.`);\n        }\n\n        if (objectsEqual(this.cachedDatasets, parsedDatasets)) {\n          return lotivis_log(`[lotivis]  No changes in datasets.`);\n        }\n\n        this.cachedDatasets = parsedDatasets;\n        this.updateSensible = false;\n        this.datasetsController.setDatasets(parsedDatasets);\n        this.updateSensible = true;\n      }\n\n    } catch (error) {\n      lotivis_log(`[lotivis]  ERROR: ${error}`);\n      this.toast.setStatusMessage(error);\n    }\n  }\n\n  datasetsToText(datasets) {\n    return new LotivisUnimplementedMethodError('datasetsToText(datasets)');\n  }\n}\n","import {LotivisConfig} from \"./config\";\n\n/**\n * Appends the given string in extension to the given string filename if filename not already ends with this extension.\n *\n * @param filename A string with or without an extension.\n * @param extension The extension the filename will end with.\n *\n * @returns {*|string} The filename with the given extension.\n */\nexport function appendExtensionIfNeeded(filename, extension) {\n  if (extension === '' || extension === '.') return filename;\n  extension = extension.startsWith(\".\") ? extension : `.${extension}`;\n  return filename.endsWith(extension) ? filename : `${filename}${extension}`;\n}\n\nexport function createDownloadFilename() {\n  let components = [LotivisConfig.downloadFilePrefix];\n  let separator = LotivisConfig.filenameSeparator;\n  for (let i = 0; i < arguments.length; i++) {\n    components.push(String(arguments[i]));\n  }\n  return components.join(separator);\n}\n","// http://bl.ocks.org/Rokotyan/0556f8facbaf344507cdc45dc3622177\n/**\n * Parses a String from the given (D3.js) SVG node.\n *\n * @param svgNode The node of the SVG.\n * @returns {string} The parsed String.\n */\nexport function getSVGString(svgNode) {\n\n  svgNode.setAttribute('xlink', 'http://www.w3.org/1999/xlink');\n  let cssStyleText = getCSSStyles(svgNode);\n  appendCSS(cssStyleText, svgNode);\n\n  let serializer = new XMLSerializer();\n  let svgString = serializer.serializeToString(svgNode);\n\n  // Fix root xlink without namespace\n  svgString = svgString.replace(\n    /(\\w+)?:?xlink=/g,\n    'xmlns:xlink='\n  );\n\n  // Safari NS namespace fix\n  svgString = svgString.replace(\n    /NS\\d+:href/g,\n    'xlink:href'\n  );\n\n  return svgString;\n\n  function getCSSStyles(parentElement) {\n    let selectorTextArr = [];\n\n    // Add Parent element Id and Classes to the list\n    selectorTextArr.push('#' + parentElement.id);\n    for (let c = 0; c < parentElement.classList.length; c++) {\n      if (!contains('.' + parentElement.classList[c], selectorTextArr)) {\n        selectorTextArr.push('.' + parentElement.classList[c]);\n      }\n    }\n\n    // Add Children element Ids and Classes to the list\n    let nodes = parentElement.getElementsByTagName(\"*\");\n    for (let i = 0; i < nodes.length; i++) {\n      let id = nodes[i].id;\n      if (!contains('#' + id, selectorTextArr)) {\n        selectorTextArr.push('#' + id);\n      }\n\n      let classes = nodes[i].classList;\n      for (let c = 0; c < classes.length; c++) {\n        if (!contains('.' + classes[c], selectorTextArr)) {\n          selectorTextArr.push('.' + classes[c]);\n        }\n      }\n    }\n\n    // Extract CSS Rules\n    let extractedCSSText = \"\";\n    for (let i = 0; i < document.styleSheets.length; i++) {\n      let s = document.styleSheets[i];\n\n      try {\n        if (!s.cssRules) continue;\n      } catch (e) {\n        if (e.name !== 'SecurityError') throw e; // for Firefox\n        continue;\n      }\n\n      let cssRules = s.cssRules;\n      for (let r = 0; r < cssRules.length; r++) {\n        if (contains(cssRules[r].selectorText, selectorTextArr)) {\n          extractedCSSText += cssRules[r].cssText;\n        }\n      }\n    }\n\n    return extractedCSSText;\n\n    function contains(str, arr) {\n      return arr.indexOf(str) !== -1;\n    }\n  }\n\n  function appendCSS(cssText, element) {\n    let styleElement = document.createElement(\"style\");\n    styleElement.setAttribute(\"type\", \"text/css\");\n    styleElement.innerHTML = cssText;\n    let refNode = element.hasChildNodes() ? element.children[0] : null;\n    element.insertBefore(styleElement, refNode);\n  }\n}\n\n/**\n *\n * @param svgString\n * @param width\n * @param height\n * @param callback\n */\nexport function svgString2Image(svgString, width, height, callback) {\n\n  // Convert SVG string to samples URL\n  let imageSource = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgString)));\n\n  let canvas = document.createElement(\"canvas\");\n  canvas.width = width;\n  canvas.height = height;\n\n  let context = canvas.getContext(\"2d\");\n  let image = new Image();\n  image.onload = function () {\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0, width, height);\n\n    let data = canvas.toDataURL(\"image/png\");\n    if (callback) callback(data);\n  };\n\n  image.src = imageSource;\n}\n\n/**\n * Returns the size of the viewBox or the normal size of the given svg element.\n *\n * @param svgElement The svg element.\n * @returns {number[]} The size [width, height].\n */\nexport function getOriginalSizeOfSVG(svgElement) {\n  let viewBoxBaseValue = svgElement.viewBox.baseVal;\n  if (viewBoxBaseValue.width !== 0 && viewBoxBaseValue.height !== 0) {\n    return [\n      viewBoxBaseValue.width,\n      viewBoxBaseValue.height\n    ];\n  } else {\n    return [\n      svgElement.width.baseVal.value,\n      svgElement.height.baseVal.value,\n    ];\n  }\n}\n","import {appendExtensionIfNeeded} from \"./filename\";\nimport {getOriginalSizeOfSVG, getSVGString, svgString2Image} from \"./screenshot\";\n\n/**\n * Creates and appends an anchor linked to the given samples which is then immediately clicked.\n *\n * @param blob The samples to be downloaded.\n * @param filename The name of the file.\n */\nexport function downloadBlob(blob, filename) {\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    let anchor = document.createElement(\"a\");\n    anchor.href = URL.createObjectURL(blob);\n    anchor.download = filename;\n    document.body.appendChild(anchor);\n    anchor.click();\n    document.body.removeChild(anchor);\n  }\n}\n\n/**\n * Initiates a download of a JSON file with the given content and the given filename.\n * @param jsonString The JSON content.\n * @param filename The filename of the file to be downloaded. Will append '.json' extension\n * if needed.\n */\nexport function downloadJSON(jsonString, filename) {\n  let blob = new Blob([jsonString], {type: 'text/json'});\n  let saveFilename = appendExtensionIfNeeded(filename, 'json');\n  downloadBlob(blob, saveFilename);\n}\n\nexport function downloadCSV(jsonString, filename) {\n  let blob = new Blob([jsonString], {type: 'text/csv'});\n  let saveFilename = appendExtensionIfNeeded(filename, 'csv');\n  downloadBlob(blob, saveFilename);\n}\n\n/**\n * Initiates a download of the PNG image of the SVG with the given selector (id).\n *\n * @param selector The id of the SVG element to create the image of.\n * @param filename The name of the file which is been downloaded.\n */\nexport function downloadImage(selector, filename) {\n  // console.log('selector:' + selector);\n  // console.log('filename:' + filename);\n  let svgElement = d3.select('#' + selector);\n  let node = svgElement.node();\n  let size = getOriginalSizeOfSVG(node);\n  let svgString = getSVGString(node);\n\n  svgString2Image(svgString, 2 * size[0], 2 * size[1], function (dataURL) {\n    // console.log('dataURL:' + dataURL);\n    fetch(dataURL)\n      .then(res => res.blob())\n      .then(function (dataBlob) {\n        let saveFilename = appendExtensionIfNeeded(filename, 'png');\n\n        // console.log('saveFilename:' + saveFilename);\n\n        downloadBlob(dataBlob, saveFilename);\n      });\n  });\n}\n","import {EditableDataviewCard} from \"./editable.dataview.card\";\nimport {downloadJSON} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\n\n/**\n * A card containing a textarea which contains the JSON text of a dataset collection.\n * @class DatasetsJSONCard\n * @extends EditableDataviewCard\n */\nexport class DatasetsJSONCard extends EditableDataviewCard {\n\n  /**\n   * Creates a new instance of DatasetJSONCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent = 'datasets-json-card') {\n    if (Object.getPrototypeOf(parent) === Object.prototype) {\n      parent.selector = parent.selector || 'datasets-json-card';\n    }\n    super(parent);\n    this.setTitle('Dataset JSON');\n  }\n\n  download(content) {\n    let filename = this.datasetsController.getFilename();\n    let downloadFilename = createDownloadFilename(filename, `datasets`);\n    downloadJSON(content, downloadFilename);\n  }\n\n  textToDatasets(text) {\n    if (text === \"\") return [];\n    return JSON.parse(text.trim());\n  }\n\n  datasetsToText(datasetsController) {\n    return JSON.stringify(datasetsController.datasets, null, 2) || \"\";\n  }\n}\n","/*\nFollowing code from:\nhttps://gist.github.com/Jezternz/c8e9fafc2c114e079829974e3764db75\n\nWe use this function to save samples.parse a CSV file.\n */\n\nexport const csvStringToArray = strData => {\n  const objPattern = new RegExp((\"(\\\\,|\\\\r?\\\\n|\\\\r|^)(?:\\\"([^\\\"]*(?:\\\"\\\"[^\\\"]*)*)\\\"|([^\\\\,\\\\r\\\\n]*))\"), \"gi\");\n  let arrMatches = null, arrData = [[]];\n  while (arrMatches = objPattern.exec(strData)) {\n    if (arrMatches[1].length && arrMatches[1] !== \",\") arrData.push([]);\n    arrData[arrData.length - 1].push(arrMatches[2] ?\n      arrMatches[2].replace(new RegExp(\"\\\"\\\"\", \"g\"), \"\\\"\") :\n      arrMatches[3]);\n  }\n  return arrData;\n};\n","/**\n * Returns a new version of the given string by trimming the given char from the beginning and the end of the string.\n * @param string The string to be trimmed.\n * @param character The character to trim.\n * @returns {string} The trimmed version of the string.\n */\nexport function trimByChar(string, character) {\n  const saveString = String(string);\n  const first = [...saveString].findIndex(char => char !== character);\n  const last = [...saveString].reverse().findIndex(char => char !== character);\n  return saveString.substring(first, saveString.length - last);\n}\n","/**\n * Returns a dataset collection created from the given flat samples collection.\n * @param flatData The flat samples collection.\n * @returns {[]} A collection of datasets.\n */\nexport function createDatasets(flatData) {\n  let datasetsByLabel = {};\n\n  for (let itemIndex = 0; itemIndex < flatData.length; itemIndex++) {\n    let item = flatData[itemIndex];\n    let label = item.dataset || item.label;\n    let dataset = datasetsByLabel[label];\n\n    if (dataset) {\n      dataset.data.push({\n        date: item.date,\n        location: item.location,\n        value: item.value\n      });\n    } else {\n      datasetsByLabel[label] = {\n        label: label,\n        stack: item.stack,\n        data: [{\n          date: item.date,\n          location: item.location,\n          value: item.value\n        }]\n      };\n    }\n  }\n\n  let datasets = [];\n  let labels = Object.getOwnPropertyNames(datasetsByLabel);\n\n  for (let index = 0; index < labels.length; index++) {\n    let label = labels[index];\n    if (label.length === 0) continue;\n    datasets.push(datasetsByLabel[label]);\n  }\n\n  return datasets;\n}\n","import {csvStringToArray} from \"../shared/csv.to.array\";\nimport {trimByChar} from \"../shared/trim\";\nimport {createDatasets} from \"../data.juggle/data.create.datasets\";\nimport {lotivis_log} from \"../shared/debug\";\n\nexport function parseCSV(text) {\n  let flatData = [];\n  let arrays = csvStringToArray(text);\n  let headlines = arrays.shift();\n\n  for (let lineIndex = 0; lineIndex < arrays.length; lineIndex++) {\n\n    let lineArray = arrays[lineIndex].map(element => trimByChar(element, `\"`));\n\n    if (lineArray.length < 5) {\n      lotivis_log(`Skipping row: ${lineArray}`);\n      continue;\n    }\n\n    flatData.push({\n      label: lineArray[0],\n      stack: lineArray[1],\n      value: +lineArray[2],\n      date: lineArray[3],\n      location: lineArray[4]\n    });\n  }\n\n  let datasets = createDatasets(flatData);\n  datasets.csv = {\n    content: text,\n    headlines: headlines,\n    lines: arrays,\n  };\n\n  return datasets;\n}\n","import {copy} from \"../shared/copy\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * Returns a flat version of the given dataset collection.\n *\n * @param datasets The collection of datasets.\n * @returns {[]} The array containing the flat samples.\n */\nexport function flatDatasets(datasets) {\n  let flatData = [];\n  let datasetsCopy = datasets;\n  for (let datasetIndex = 0; datasetIndex < datasetsCopy.length; datasetIndex++) {\n    let dataset = datasetsCopy[datasetIndex];\n    let flatDataChunk = flatDataset(dataset);\n    flatData = flatData.concat(flatDataChunk);\n  }\n  return flatData;\n}\n\n/**\n * Returns an array containing the flat samples of the given dataset.\n *\n * @param dataset The dataset with samples.\n * @returns {[]} The array containing the flat samples.\n */\nexport function flatDataset(dataset) {\n  let flatData = [];\n  if (!dataset.data) {\n    lotivis_log(`[lotivis]  INFO Flat samples for dataset without samples requested. Will return an empty array.`, dataset);\n    return flatData;\n  }\n  dataset.data.forEach(item => {\n    let newItem = {};\n    newItem.dataset = dataset.label;\n    newItem.label = dataset.label;\n    newItem.stack = dataset.stack || dataset.label;\n    newItem.location = item.location;\n    newItem.date = item.date;\n    newItem.dateNumeric = item.dateNumeric;\n    newItem.value = item.value;\n    flatData.push(newItem);\n  });\n  return flatData;\n}\n","import {flatDatasets} from \"../data.juggle/data.flat\";\n\n/**\n * Returns the given string with a quotation mark in the left and right.\n *\n * @param aString The string to surround by quotation marks.\n * @returns {string} The string surrounded by quotation marks.\n */\nfunction surroundWithQuotationMarks(aString) {\n  return `\"${aString}\"`;\n}\n\n/**\n * Returns the CSV string of the given datasets.\n *\n * @param datasets The datasets to create the CSV of.\n */\nexport function renderCSV(datasets) {\n  let flatData = flatDatasets(datasets);\n  let headlines = ['label', 'stack', 'value', 'date', 'location'];\n  let csvContent = `${headlines.join(',')}\\n`;\n  for (let index = 0; index < flatData.length; index++) {\n    let data = flatData[index];\n    let components = [];\n    components.push(surroundWithQuotationMarks(data.dataset || 'Unknown'));\n    components.push(surroundWithQuotationMarks(data.stack || ''));\n    components.push(data.value || '0');\n    components.push(surroundWithQuotationMarks(data.date || ''));\n    components.push(surroundWithQuotationMarks(data.location || ''));\n    csvContent += `${components.join(`,`)}\\n`;\n  }\n  return csvContent;\n}\n","import {Card} from \"../shared.components/card\";\nimport {EditableDataviewCard} from \"./editable.dataview.card\";\nimport {parseCSV} from \"../data.parse/parse.csv\";\nimport {renderCSV} from \"../data.render/render.csv\";\nimport {downloadCSV} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\n\n/**\n * Presents the CSV version of datasets.  The presented CSV can be edited.\n * @class DatasetCSVCard\n * @extends Card\n */\nexport class DatasetCSVCard extends EditableDataviewCard {\n\n  /**\n   * Creates a new instance of DatasetCSVCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent) {\n    super(parent);\n    this.setTitle('Dataset CSV');\n  }\n\n  download(content) {\n    let filename = this.datasetsController.getFilename();\n    let downloadFilename = createDownloadFilename(filename, `datasets`);\n    downloadCSV(content, downloadFilename);\n  }\n\n  textToDatasets(text) {\n    if (text === \"\") return [];\n    return parseCSV(text);\n  }\n\n  datasetsToText(datasetsController) {\n    return renderCSV(datasetsController.datasets);\n  }\n}\n","import {csvStringToArray} from \"../shared/csv.to.array\";\nimport {trimByChar} from \"../shared/trim\";\n\n/**\n * Returns a collection of datasets parsed from the given CSV content.\n * @param text The CSV content.\n * @returns {[]} The parsed datasets.\n */\nexport function parseCSVDate(text) {\n  let arrays = csvStringToArray(text);\n  let datasetLabels = arrays.shift();\n  let dateTitle = datasetLabels.shift();\n  let datasets = [];\n  let minLineLength = datasetLabels.length;\n\n  for (let index = 0; index < datasetLabels.length; index++) {\n    datasets.push({\n      label: datasetLabels[index],\n      data: []\n    });\n  }\n\n  for (let lineIndex = 0; lineIndex < arrays.length; lineIndex++) {\n    let lineArray = arrays[lineIndex].map(element => trimByChar(element, `\"`));\n    if (lineArray.length < minLineLength) continue;\n\n    let date = lineArray.shift();\n\n    for (let columnIndex = 0; columnIndex < lineArray.length; columnIndex++) {\n      let value = lineArray[columnIndex];\n      datasets[columnIndex].data.push({\n        date: date,\n        value: value\n      });\n    }\n  }\n\n  datasets.csv = {\n    content: text,\n    headlines: datasetLabels.push(),\n    lines: arrays,\n  };\n\n  return datasets;\n}\n","import {flatDatasets} from \"./data.flat\";\nimport {toValue} from \"../shared/value\";\n\n/**\n * Returns the set of dataset names from the given dataset collection.\n *\n * @param datasets The collection of datasets.\n * @returns {[]} The array containing the flat samples.\n */\nexport function extractLabelsFromDatasets(datasets) {\n  return toSet(datasets.map(dataset => toValue(dataset.label)));\n}\n\n/**\n * Returns the set of stacks from the given dataset collection.\n * Will fallback on dataset property if stack property isn't present.\n *\n * @param datasets The collection of datasets.\n * @returns {[]} The array containing the flat samples.\n */\nexport function extractStacksFromDatasets(datasets) {\n  return toSet(datasets.map(dataset => toValue(dataset.stack || dataset.label)));\n}\n\n/**\n * Returns the set of dates from the given dataset collection.\n *\n * @param datasets The collection of datasets.\n * @returns {[]} The set containing the dates.\n */\nexport function extractDatesFromDatasets(datasets) {\n  return extractDatesFromFlatData(flatDatasets(datasets));\n}\n\n/**\n * Returns the set of locations from the given dataset collection.\n *\n * @param datasets The collection of datasets.\n * @returns {[]} The set containing the locations.\n */\nexport function extractLocationsFromDatasets(datasets) {\n  return extractLocationsFromFlatData(flatDatasets(datasets));\n}\n\n/**\n * Returns the set of dataset names from the given flat samples array.\n *\n * @param flatData The flat samples array.\n * @returns {[]} The array containing the flat samples.\n */\nexport function extractLabelsFromFlatData(flatData) {\n  return toSet(flatData.map(item => toValue(item.dataset)));\n}\n\n/**\n * Returns the set of stacks from the given flat samples array.\n * Will fallback on dataset property if stack property isn't present.\n *\n * @param flatData The flat samples array.\n * @returns {[]} The array containing the flat samples.\n */\nexport function extractStacksFromFlatData(flatData) {\n  return toSet(flatData.map(item => toValue(item.stack || item.dataset)));\n}\n\n/**\n * Returns the set of dates from the given dataset collection.\n *\n * @param flatData The flat samples array.\n * @returns {[]} The set containing the dates.\n */\nexport function extractDatesFromFlatData(flatData) {\n  return toSet(flatData.map(item => toValue(item.date)));\n}\n\n/**\n * Returns the set of locations from the given dataset collection.\n *\n * @param flatData The flat samples array.\n * @returns {[]} The set containing the locations.\n */\nexport function extractLocationsFromFlatData(flatData) {\n  return toSet(flatData.map(item => toValue(item.location)));\n}\n\n/**\n * Return an array containing each equal item of the given array only once.\n *\n * @param array The array to create a set of.\n * @returns {any[]} The set version of the array.\n */\nfunction toSet(array) {\n  return Array.from(new Set(array));\n}\n\n/**\n * Returns the earliest date.chart occurring in the flat array of items.\n *\n * @param flatData The flat samples array.\n * @param dateAccess\n * @returns {*} The earliest date.chart.\n */\nexport function extractEarliestDate(flatData, dateAccess = (date) => date) {\n  return extractDatesFromFlatData(flatData)\n    .sort((left, right) => dateAccess(left) - dateAccess(right)).shift();\n}\n\n/**\n * Returns the earliest date.chart occurring in the flat array of items.\n *\n * @param flatData The flat samples array.\n * @param dateAccess\n * @returns {*} The earliest date.chart.\n */\nexport function extractEarliestDateWithValue(flatData, dateAccess = (date) => date) {\n  return extractEarliestDate(filterWithValue(flatData), dateAccess);\n}\n\n/**\n * Returns the latest date.chart occurring in the flat array of items.\n *\n * @param flatData The flat samples array.\n * @param dateAccess\n * @returns {*} The latest date.chart.\n */\nexport function extractLatestDate(flatData, dateAccess = (date) => date) {\n  return extractDatesFromFlatData(flatData)\n    .sort((left, right) => dateAccess(left) - dateAccess(right)).pop();\n}\n\n/**\n * Returns the latest date.chart occurring in the flat array of items.\n *\n * @param flatData The flat samples array.\n * @param dateAccess\n * @returns {*} The latest date.chart.\n */\nexport function extractLatestDateWithValue(flatData, dateAccess = (date) => date) {\n  return extractLatestDate(filterWithValue(flatData), dateAccess);\n}\n\n/**\n * Returns a filtered collection containing all items which have a valid value greater than 0.\n *\n * @param flatData The flat samples to filter.\n * @returns {*} All items with a value greater 0.\n */\nexport function filterWithValue(flatData) {\n  return flatData.filter(item => (item.value || 0) > 0);\n}\n","import {\n  extractDatesFromDatasets,\n  extractLabelsFromDatasets\n} from \"./data.extract\";\nimport {flatDatasets} from \"./data.flat\";\nimport {combineByDate} from \"./data.combine\";\n\n/**\n *\n * @param datasets\n * @param dateAccess\n * @returns {{date.chart: *}[]}\n */\nexport function dateToItemsRelation(datasets, dateAccess) {\n\n  let flatData = flatDatasets(datasets);\n  flatData = combineByDate(flatData);\n\n  let listOfDates = extractDatesFromDatasets(datasets);\n  // verbose_log('listOfDates', listOfDates);\n  listOfDates = listOfDates.reverse();\n  // verbose_log('listOfDates', listOfDates);\n  // listOfDates = listOfDates.sort(function (left, right) {\n  //   return dateAccess(left) - dateAccess(right);\n  // });\n\n  let listOfLabels = extractLabelsFromDatasets(datasets);\n\n  return listOfDates.map(function (date) {\n    let datasetDate = {date: date};\n    flatData\n      .filter(item => item.date === date)\n      .forEach(function (entry) {\n        datasetDate[entry.dataset] = entry.value;\n        datasetDate.total = entry.dateTotal;\n      });\n\n    // addDataset zero values for empty datasets\n    for (let index = 0; index < listOfLabels.length; index++) {\n      let label = listOfLabels[index];\n      if (!datasetDate[label]) {\n        datasetDate[label] = 0;\n      }\n    }\n\n    return datasetDate;\n  });\n}\n","import {extractLabelsFromDatasets} from \"../data.juggle/data.extract\";\nimport {dateToItemsRelation} from \"../data.juggle/data.relations\";\n\n/**\n *\n * @param datasets\n */\nexport function renderCSVDate(datasets) {\n  let dateRelation = dateToItemsRelation(datasets, (date) => date);\n  let labels = extractLabelsFromDatasets(datasets);\n  let headlines = ['date'];\n\n  for (let labelIndex = 0; labelIndex < labels.length; labelIndex++) {\n    headlines.push(labels[labelIndex]);\n  }\n\n  let csvContent = `${headlines.join(',')}\\n`;\n\n  for (let index = 0; index < dateRelation.length; index++) {\n    let dateRow = dateRelation[index];\n    let csvRow = `${dateRow.date}`;\n\n    for (let labelIndex = 0; labelIndex < labels.length; labelIndex++) {\n      let label = labels[labelIndex];\n      csvRow += `,${dateRow[label]}`;\n    }\n\n    csvContent += `${csvRow}\\n`;\n  }\n\n  return csvContent;\n}\n","import {Card} from \"../shared.components/card\";\nimport {EditableDataviewCard} from \"./editable.dataview.card\";\nimport {parseCSVDate} from \"../data.parse/parse.csv.date\";\nimport {renderCSVDate} from \"../data.render/render.csv.date\";\nimport {downloadCSV} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\n\n/**\n * Presents the CSV version of datasets.  The presented CSV can be edited.\n * @class DatasetCSVDateCard\n * @extends Card\n */\nexport class DatasetCSVDateCard extends EditableDataviewCard {\n\n  /**\n   * Creates a new instance of DatasetCSVCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent) {\n    super(parent);\n    this.setTitle('Dataset CSV');\n  }\n\n  download(content) {\n    let filename = this.datasetsController.getFilename();\n    let downloadFilename = createDownloadFilename(filename, `datasets`);\n    downloadCSV(content, downloadFilename);\n  }\n\n  textToDatasets(text) {\n    if (text === \"\") return [];\n    return parseCSVDate(text);\n  }\n\n  datasetsToText(datasetsController) {\n    return renderCSVDate(datasetsController.datasets);\n  }\n}\n","import {UpdatableDataviewCard} from \"./updatable.dataview.card\";\n\n/**\n * A card containing a textarea which contains the JSON text of a dataset collection.\n * @class DataviewCard\n * @extends UpdatableDataviewCard\n */\nexport class DataViewCard extends UpdatableDataviewCard {\n\n  /**\n   * Creates a new instance of DataviewCard.\n   * @param parent The parental element or a selector (id).\n   */\n  constructor(parent) {\n    super(parent);\n    if (!this.config) this.config = {};\n    this.config.updatesHeight = this.config.updatesHeight || true;\n    this.disableTextarea();\n  }\n\n  datasetsToText(datasets) {\n    if (!this.datasetsController) return \"No datasets controller.\";\n    let dataView = this.getDataview();\n    return JSON.stringify(dataView, null, 2);\n  }\n\n  getDataview() {\n    // empty\n  }\n}\n\nexport class DataViewDateChartCard extends DataViewCard {\n  getTitle() {\n    return 'Dataview Date';\n  }\n\n  getDataview() {\n    return this.datasetsController.getDateDataview();\n  }\n}\n\nexport class DataViewDatePlotChartCard extends DataViewCard {\n  getTitle() {\n    return 'Dataview Plot';\n  }\n\n  getDataview() {\n    return this.datasetsController.getPlotDataview();\n  }\n}\n\nexport class DataViewMapChartCard extends DataViewCard {\n  getTitle() {\n    return 'Dataview Map';\n  }\n\n  getDataview() {\n    return this.datasetsController.getLocationDataview();\n  }\n}\n\nexport class DataViewFlatCard extends DataViewCard {\n  getTitle() {\n    return 'Flat Data';\n  }\n\n  getDataview() {\n    return this.datasetsController.flatData;\n  }\n}\n","import {DataViewCard} from \"./dataview.card\";\n\n/**\n * @class DatasetsControllerCard\n *\n * @extends DataviewCard\n */\nexport class DatasetsControllerCard extends DataViewCard {\n\n  /**\n   * Creates a new instance of DatasetsControllerCard.\n   */\n  constructor(parent) {\n    super(parent);\n  }\n\n  datasetsToText(datasets) {\n    return JSON.stringify({\n      labels: this.datasetsController.labels,\n      stacks: this.datasetsController.stacks,\n      dates: this.datasetsController.dates,\n      locations: this.datasetsController.locations,\n      filters: {\n        locations: this.datasetsController.locationFilters,\n        dates: this.datasetsController.dateFilters,\n        datasets: this.datasetsController.datasetFilters,\n      },\n      selection: {},\n      datasets: this.datasetsController.datasets,\n      flatData: this.datasetsController.flatData,\n      originalDatasets: this.datasetsController.originalDatasets,\n      snapshot: this.datasetsController.snapshot\n    }, null, 2);\n  }\n}\n","/**\n * @class DateChartAxisRenderer\n */\nexport class DateChartAxisRenderer {\n\n  /**\n   * Creates a new instance of DateChartAxisRenderer.\n   *\n   * @param dateChart The parental date.chart chart.\n   */\n  constructor(dateChart) {\n\n    /**\n     * Appends the `left` and `bottom` axis to the date.chart chart.\n     */\n    this.render = function () {\n      let height = dateChart.config.height;\n      let margin = dateChart.config.margin;\n\n      // left axis\n      dateChart.svg\n        .append(\"g\")\n        .call(d3.axisLeft(dateChart.yChart))\n        .attr(\"transform\", () => `translate(${margin.left},0)`);\n\n      // bottom axis\n      dateChart.svg\n        .append(\"g\")\n        .call(d3.axisBottom(dateChart.xChartScale))\n        .attr(\"transform\", () => `translate(0,${height - margin.bottom})`);\n\n    };\n  }\n}\n","/**\n * Appends labels on top of the bars of a date.chart chart.\n * @class TimeChartLabelRenderer\n */\nexport class TimeChartLabelRenderer {\n\n  /**\n   * Creates a new instance of TimeChartLabelRenderer.\n   * @param dateChart The parental date.chart chart.\n   */\n  constructor(dateChart) {\n\n    /**\n     * Appends a label for the given stack.\n     * @param stack The stack to create a label for.\n     */\n    this.renderBarLabels = function (stack) {\n\n      let xChartRef = dateChart.xChartScale;\n      let yChartRef = dateChart.yChart;\n      let xStackRef = dateChart.xStack;\n      let numberFormat = dateChart.config.numberFormat;\n      let labelColor = dateChart.config.labelColor;\n      let numberOfSeries = stack.length;\n      let seriesIndex = 0;\n      let bandwidth = xStackRef.bandwidth() / 2;\n\n      dateChart\n        .svg\n        .append(\"g\")\n        .selectAll('g')\n        .data(stack)\n        .enter()\n        .append('g')\n        .attr('fill', labelColor)\n        .selectAll('.text')\n        .data(dataset => dataset)\n        .enter()\n        .append('text')\n        .attr('class', 'lotivis-date.chart-chart-label')\n        .attr(\"transform\", function (item) {\n          let x = xChartRef(item.data.date) + xStackRef(stack.label) + bandwidth;\n          let y = yChartRef(item[1]) - 5;\n          return `translate(${x},${y})rotate(-60)`;\n        })\n        .text(function (item, index) {\n          if (index === 0) seriesIndex += 1;\n          if (seriesIndex !== numberOfSeries) return;\n          let value = item[1];\n          return value === 0 ? '' : numberFormat.format(value);\n        });\n    };\n  }\n}\n","import {sumOfStack} from \"../data.juggle/data.sum\";\nimport {Color} from \"../shared/color\";\n\n/**\n *\n */\nexport class TimeChartLegendRenderer {\n\n  constructor(dateChart) {\n\n    /**\n     * Renders the legend of the date chart.\n     */\n    this.render = function () {\n      if (dateChart.config.combineStacks) {\n        renderCombinedStacksLegend();\n      } else {\n        renderDefaultLegend();\n      }\n    };\n\n    function renderDefaultLegend() {\n      let config = dateChart.config;\n      let controller = dateChart.datasetController;\n      let numberFormat = dateChart.config.numberFormat;\n      let datasets = controller.datasets;\n      let datasetNames = controller.labels;\n      let circleRadius = 6;\n      let labelMargin = 50;\n\n      let xLegend = d3.scaleBand()\n        .domain(datasetNames)\n        .rangeRound([config.margin.left, config.width - config.margin.right]);\n\n      let legends = dateChart.graph\n        .selectAll('.legend')\n        .data(datasets)\n        .enter();\n\n      legends\n        .append('text')\n        .attr('class', 'lotivis-date.chart-chart-legend-label')\n        .attr(\"font-size\", 13)\n        .attr(\"x\", (item) => xLegend(item.label) - 30)\n        .attr(\"y\", dateChart.graphHeight + labelMargin)\n        .style('cursor', 'pointer')\n        .style(\"fill\", function (item) {\n          return controller.getColorForDataset(item.label);\n        })\n        .text(function (item) {\n          let value = controller.getSumOfDataset(item.label);\n          let formatted = numberFormat.format(value);\n          return `${item.label} (${formatted})`;\n        })\n        .on('click', function (event) {\n          if (!event || !event.target) return;\n          if (!event.target.innerHTML) return;\n          let components = event.target.innerHTML.split(' (');\n          components.pop();\n          let label = components.join(\" (\");\n          console.log('label', label);\n          dateChart.toggleDataset(label);\n        }.bind(this));\n\n      legends\n        .append(\"circle\")\n        .attr('class', 'lotivis-date.chart-chart-legend-circle')\n        .attr(\"r\", circleRadius)\n        .attr(\"cx\", (item) => xLegend(item.label) - (circleRadius * 2) - 30)\n        .attr(\"cy\", dateChart.graphHeight + labelMargin - circleRadius + 2)\n        .style(\"stroke\", (item) => controller.getColorForDataset(item.label))\n        .style(\"fill\", function (item) {\n          return item.isEnabled ? controller.getColorForDataset(item.label) : 'white';\n        }.bind(this));\n    };\n\n    function renderCombinedStacksLegend() {\n      let stackNames = dateChart.datasetController.stacks;\n      let numberFormat = dateChart.config.numberFormat;\n      let circleRadius = 6;\n      let labelMargin = 50;\n\n      let xLegend = d3\n        .scaleBand()\n        .domain(stackNames)\n        .rangeRound([dateChart.config.margin.left, dateChart.config.width - dateChart.config.margin.right]);\n\n      let legends = dateChart\n        .graph\n        .selectAll('.lotivis-date.chart-chart-legend-label')\n        .data(stackNames)\n        .enter();\n\n      legends\n        .append('text')\n        .attr('class', 'lotivis-date.chart-chart-legend-label')\n        .attr(\"font-size\", 23)\n        .attr(\"x\", (item) => xLegend(item) - 30)\n        .attr(\"y\", function () {\n          return dateChart.graphHeight + labelMargin;\n        }.bind(this))\n        .style('cursor', 'pointer')\n        .style(\"fill\", function (item, index) {\n          return Color.colorsForStack(index)[0].rgbString();\n        }.bind(this))\n        .text(function (item) {\n          let value = sumOfStack(dateChart.datasetController.flatData, item);\n          let formatted = numberFormat.format(value);\n          let labels = item.split(',');\n          let text;\n\n          if (labels.length > 3) {\n            labels = labels.splice(0, 3);\n            text = labels.join(', ') + ',...';\n          } else {\n            text = item;\n          }\n\n          return `${text} (${formatted})`;\n\n        }.bind(this));\n\n      legends\n        .append(\"circle\")\n        .attr(\"r\", circleRadius)\n        .attr(\"cx\", item => xLegend(item) - (circleRadius * 2) - 30)\n        .attr(\"cy\", dateChart.graphHeight + labelMargin - circleRadius + 2)\n        .style('cursor', 'pointer')\n        .style(\"stroke\", function (item, index) {\n          return Color.colorsForStack(index)[0].rgbString();\n        }.bind(this))\n        .style(\"fill\", function (item, index) {\n          return item.isEnabled ? Color.colorsForStack(index)[0].rgbString() : 'white';\n        }.bind(this))\n        .style(\"stroke-width\", 2);\n\n    };\n  }\n}\n","import {LotivisConfig} from \"../shared/config\";\n\n/**\n * Appends the bars to a date.chart chart.\n * @class TimeChartBarsRenderer\n */\nexport class TimeChartBarsRenderer {\n\n  /**\n   * Creates a new instance of TimeChartBarsRenderer.\n   * @param dateChart The parental date.chart chart.\n   */\n  constructor(dateChart) {\n\n    /**\n     * Appends the bar for the given stack.\n     * @param stack The stack to append the bar for.\n     */\n    this.renderBars = function (stack) {\n\n      let config = dateChart.config || {};\n      let isCombineStacks = config.combineStacks || false;\n      let colors = dateChart.datasetController.getColorsForStack(stack.stack) || Color.defaultTint;\n      let barRadius = config.barRadius || LotivisConfig.barRadius;\n\n      dateChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"g\")\n        .data(stack)\n        .enter()\n        .append(\"g\")\n        .attr(\"fill\", (stackData, index) => isCombineStacks ? colors[0] : stack.colors[index])\n        .selectAll(\"rect\")\n        .data((data) => data)\n        .enter()\n        .append(\"rect\")\n        .attr('class', 'lotivis-time-chart-bar')\n        .attr(\"rx\", isCombineStacks ? 0 : barRadius)\n        .attr(\"ry\", isCombineStacks ? 0 : barRadius)\n        .attr(\"x\", (d) => dateChart.xChartScale(d.data.date) + dateChart.xStack(stack.label))\n        .attr(\"y\", (d) => dateChart.yChart(d[1]))\n        .attr(\"width\", dateChart.xStack.bandwidth())\n        .attr(\"height\", (d) => dateChart.yChart(d[0]) - dateChart.yChart(d[1]));\n\n    };\n  }\n}\n","import {toSaveID} from \"../shared/selector\";\n\n/**\n *\n * @class TimeChartHoverBarsRenderer\n */\nexport class TimeChartHoverBarsRenderer {\n\n  /**\n   * Creates a new instance of TimeChartHoverBarsRenderer.\n   *\n   * @param dateChart\n   */\n  constructor(dateChart) {\n\n    function createID(date) {\n      return `lotivis-date-chart-hover-bar-id-${toSaveID(String(date))}`;\n    }\n\n    this.hideAll = function () {\n      dateChart.svg\n        .selectAll(`.lotivis-date-chart-hover-bar`)\n        .attr(`opacity`, 0);\n    };\n\n    function onMouseEnter(event, date) {\n      this.hideAll();\n      dateChart\n        .svg\n        .select(`#${createID(date)}`)\n        .attr(\"opacity\", 0.3);\n      dateChart.tooltipRenderer.showTooltip(event, date);\n    }\n\n    function onMouserOut(event, date) {\n      this.hideAll();\n      dateChart.tooltipRenderer.hideTooltip(event, date);\n\n      // check for mouse down\n      if (event.buttons === 1) {\n        onMouseClick(event, date);\n      }\n    }\n\n    function onMouseClick(even, date) {\n      if (dateChart.config.sendsNotifications) {\n        dateChart.makeUpdateInsensible();\n        dateChart.datasetController.toggleDate(date);\n        dateChart.makeUpdateSensible();\n      }\n      dateChart.selectionRenderer.update();\n    }\n\n    this.renderGhostBars = function () {\n\n      let config = dateChart.config;\n      let margin = config.margin;\n      let dates = dateChart.config.dateLabels || dateChart.dataview.dates;\n\n      dateChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"rect\")\n        .data(dates)\n        .enter()\n        .append(\"rect\")\n        .attr(\"class\", 'lotivis-date-chart-hover-bar')\n        .attr(\"id\", date => createID(date))\n        .attr(\"opacity\", 0)\n        .attr(\"x\", (date) => dateChart.xChartScale(date))\n        .attr(\"y\", margin.top)\n        .attr(\"width\", dateChart.xChartScale.bandwidth())\n        .attr(\"height\", config.height - margin.bottom - margin.top)\n        .on('mouseenter', onMouseEnter.bind(this))\n        .on('mouseout', onMouserOut.bind(this))\n        .on('mousedrag', onMouserOut.bind(this))\n        .on('click', onMouseClick.bind(this));\n\n    };\n  }\n}\n","import {combineByDate} from \"../data.juggle/data.combine\";\nimport {LotivisConfig} from \"../shared/config\";\n\n/**\n * Injects and presents a tooltip on a date.chart chart.\n *\n * @class TimeChartTooltipRenderer\n */\nexport class TimeChartTooltipRenderer {\n\n  /**\n   * Creates a new instance of TimeChartTooltipRenderer.\n   *\n   * @constructor\n   */\n  constructor(dateChart) {\n\n    const tooltip = dateChart\n      .element\n      .append('div')\n      .attr('class', 'lotivis-tooltip')\n      .attr('rx', 5) // corner radius\n      .attr('ry', 5)\n      .style('opacity', 0);\n\n    /**\n     * Returns the size [width, height] of the tooltip.\n     *\n     * @returns {number[]}\n     */\n    function getTooltipSize() {\n      let tooltipWidth = Number(tooltip.style('width').replace('px', ''));\n      let tooltipHeight = Number(tooltip.style('height').replace('px', ''));\n      return [tooltipWidth, tooltipHeight];\n    }\n\n    /**\n     * Calculates and returns the top pixel position for the tooltip.\n     *\n     * @param factor The size factor of the chart.\n     * @param offset The offset of the chart.\n     * @param tooltipSize The size of the tooltip.\n     * @returns {number}\n     */\n    function getTop(factor, offset, tooltipSize) {\n      let top = dateChart.config.margin.top * factor;\n      top += (((dateChart.graphHeight * factor) - tooltipSize[1]) / 2);\n      top += offset[1] - 10;\n      return top;\n    }\n\n    /**\n     * Calculates the x offset to position the tooltip on the left side\n     * of a bar.\n     *\n     * @param date The presented date.chart of selected bar.\n     * @param factor The size factor of the chart.\n     * @param offset The offset of the chart.\n     * @param tooltipSize The size of the tooltip.\n     * @returns {number} The x offset for the tooltip.\n     */\n    function getXLeft(date, factor, offset, tooltipSize) {\n      let x = dateChart.xChartScalePadding(date) * factor;\n      return x + offset[0] - tooltipSize[0] - 22 - LotivisConfig.tooltipOffset;\n    }\n\n    /**\n     * Calculates the x offset to position the tooltip on the right side\n     * of a bar.\n     *\n     * @param date The presented date.chart of selected bar.\n     * @param factor The size factor of the chart.\n     * @param offset The offset of the chart.\n     * @returns {number} The x offset for the tooltip.\n     */\n    function getXRight(date, factor, offset) {\n      let x = dateChart.xChartScalePadding(date) + dateChart.xChartScalePadding.bandwidth();\n      x *= factor;\n      x += offset[0] + LotivisConfig.tooltipOffset;\n      return x;\n    }\n\n    /**\n     * Returns the HTML content for the given date.chart.\n     *\n     * @param date The date.chart to get the HTML content for.\n     * @returns {string} Return the rendered HTML content.\n     */\n    function getHTMLForDate(date) {\n      let flatData = dateChart\n        .snapshot\n        .flatData\n        .filter(item => `${item.date}` === `${date}`);\n\n      let first = flatData.first();\n      let title;\n      if (first && first.from && first.till) {\n        title = `${first.from} - ${first.till}`;\n      } else {\n        title = `${date}`;\n      }\n\n      let sum = 0;\n      let dataHTML = combineByDate(flatData)\n        .filter(item => item.value > 0)\n        .map(function (item) {\n          let color = dateChart.datasetController.getColorForDataset(item.dataset);\n          let divHTML = `<div style=\"background: ${color};color: ${color}; display: inline;\">__</div>`;\n          let valueFormatted = dateChart.config.numberFormat.format(item.value);\n          sum += item.value;\n          return `${divHTML} ${item.dataset}: <b>${valueFormatted}</b>`;\n        })\n        .join('<br>');\n\n      let sumFormatted = dateChart.config.numberFormat.format(sum);\n      return `<b>${title}</b><br>${dataHTML}<br><br>Sum: <b>${sumFormatted}</b>`;\n    }\n\n    /**\n     * Presents the tooltip next to bar presenting the given date.chart.\n     *\n     * @param event The mouse event.\n     * @param date The date.chart which is presented.\n     */\n    this.showTooltip = function (event, date) {\n\n      // set examples content before positioning the tooltip cause the size is\n      // calculated based on the size\n      const html = getHTMLForDate(date);\n      tooltip.html(html);\n\n      // position tooltip\n      let tooltipSize = getTooltipSize();\n      let factor = dateChart.getElementEffectiveSize()[0] / dateChart.config.width;\n      let offset = dateChart.getElementPosition();\n      let top = getTop(factor, offset, tooltipSize);\n      let left = dateChart.xChartScalePadding(date);\n\n      // differ tooltip position on bar position\n      if (left > (dateChart.config.width / 2)) {\n        left = getXLeft(date, factor, offset, tooltipSize);\n      } else {\n        left = getXRight(date, factor, offset);\n      }\n\n      // update position and opacity of tooltip\n      tooltip\n        .style('left', `${left}px`)\n        .style('top', `${top}px`)\n        .style('opacity', 1);\n    };\n\n    /**\n     * Hides the tooltip.  Does nothing if tooltips opacity is already 0.\n     */\n    this.hideTooltip = function () {\n      if (+tooltip.style('opacity') === 0) return;\n      tooltip.style('opacity', 0);\n    };\n  }\n}\n","/**\n * @class TimeChartGridRenderer\n */\nexport class TimeChartGridRenderer {\n\n  /**\n   * Creates a new instance of TimeChartGridRenderer.\n   *\n   * @param dateChart\n   */\n  constructor(dateChart) {\n\n    /**\n     *\n     */\n    this.createAxis = function () {\n\n      this.xAxisGrid = d3\n        .axisBottom(dateChart.xChartScale)\n        .tickSize(-dateChart.graphHeight)\n        .tickFormat('');\n\n      this.yAxisGrid = d3\n        .axisLeft(dateChart.yChart)\n        .tickSize(-dateChart.graphWidth)\n        .tickFormat('')\n        .ticks(20);\n\n    };\n\n    /**\n     *\n     */\n    this.renderGrid = function () {\n      let config = dateChart.config;\n      let color = 'lightgray';\n      let width = '0.5';\n      let opacity = 0.3;\n\n      dateChart.svg\n        .append('g')\n        .attr('class', 'x axis-grid')\n        .attr('transform', 'translate(0,' + (config.height - config.margin.bottom) + ')')\n        .attr('stroke', color)\n        .attr('stroke-width', width)\n        .attr(\"opacity\", opacity)\n        .call(this.xAxisGrid);\n\n      dateChart.svg\n        .append('g')\n        .attr('class', 'y axis-grid')\n        .attr('transform', `translate(${config.margin.left},0)`)\n        .attr('stroke', color)\n        .attr('stroke-width', width)\n        .attr(\"opacity\", opacity)\n        .call(this.yAxisGrid);\n\n    };\n  }\n}\n","import {LotivisConfig} from \"../shared/config\";\nimport {toSaveID} from \"../shared/selector\";\n\n/**\n *\n * @class TimeChartSelectionRenderer\n */\nexport class TimeChartSelectionRenderer {\n\n  /**\n   * Creates a new instance of TimeChartHoverBarsRenderer.\n   * @param dateChart\n   */\n  constructor(dateChart) {\n\n    function createID(date) {\n      return `lotivis-date-chart-selection-rect-id-${toSaveID(String(date))}`;\n    }\n\n    function getSelectedDates() {\n      if (!dateChart.datasetController) {\n        return [];\n      }\n      return dateChart.datasetController.filters.dates || [];\n    }\n\n    this.hideAll = function () {\n      dateChart.svg\n        .selectAll(`.lotivis-date-chart-selection-rect`)\n        .attr(`opacity`, 0);\n    };\n\n    this.render = function () {\n      let margin = dateChart.config.margin;\n      let dates = dateChart.config.dateLabels || dateChart.dataview.dates;\n\n      dateChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"rect\")\n        .data(dates)\n        .enter()\n        .append(\"rect\")\n        .attr(\"class\", 'lotivis-date-chart-selection-rect')\n        .attr(\"id\", date => createID(date))\n        .attr(\"x\", (date) => dateChart.xChartScale(date))\n        .attr(\"y\", margin.top)\n        .attr(\"opacity\", 0)\n        .attr(\"width\", dateChart.xChartScale.bandwidth())\n        .attr(\"height\", dateChart.config.height - margin.bottom - margin.top);\n\n    };\n\n    this.update = function () {\n      let selectedDates = getSelectedDates();\n      dateChart\n        .svg\n        .selectAll(`.lotivis-date-chart-selection-rect`)\n        .attr(`opacity`, date => selectedDates.includes(String(date)) ? 0.15 : 0);\n    };\n  }\n}\n","import {LotivisConfig} from \"../shared/config\";\nimport {Color} from \"../shared/color\";\n\nexport const DATE_CHART_CONFIG = {\n  width: 1000,\n  height: 600,\n  margin: {\n    top: LotivisConfig.defaultMargin,\n    right: LotivisConfig.defaultMargin,\n    bottom: LotivisConfig.defaultMargin,\n    left: LotivisConfig.defaultMargin\n  },\n  showLabels: false,\n  combineStacks: false,\n  sendsNotifications: true,\n  labelColor: new Color(155, 155, 155),\n  numberFormat: Intl.NumberFormat('de-DE', {\n    maximumFractionDigits: 3\n  }),\n  dateAccess: function (date) {\n    return Date.parse(date);\n  }\n};\n","import {Chart} from \"../chart/chart\";\nimport {DateChartAxisRenderer} from \"./date.chart.axis.renderer\";\nimport {TimeChartLabelRenderer} from \"./time.chart.label.renderer\";\nimport {TimeChartLegendRenderer} from \"./time.chart.legend.renderer\";\nimport {TimeChartBarsRenderer} from \"./time.chart.bars.renderer\";\nimport {TimeChartHoverBarsRenderer} from \"./time.chart.hover.bars.renderer\";\nimport {TimeChartTooltipRenderer} from \"./time.chart.tooltip.renderer\";\nimport {TimeChartGridRenderer} from \"./time.chart.grid.renderer\";\nimport {TimeChartSelectionRenderer} from \"./time.chart.selection.renderer\";\nimport {DATE_CHART_CONFIG} from \"./date.chart.config\";\n\n/**\n *\n * @class DateChart\n * @extends Chart\n */\nexport class DateChart extends Chart {\n\n  // called by `Chart` superclass\n  /**\n   * Initializes this diachronic chart by setting the default values.\n   *\n   * @override\n   */\n  initialize() {\n    this.initializeDefaultValues();\n    this.initializeRenderers();\n  }\n\n  /**\n   *\n   */\n  initializeDefaultValues() {\n\n    let margin, config;\n\n    margin = Object.assign({}, DATE_CHART_CONFIG.margin);\n    margin = Object.assign(margin, this.config.margin);\n\n    config = Object.assign({}, DATE_CHART_CONFIG);\n\n    this.config = Object.assign(config, this.config);\n    this.config.margin = margin;\n  }\n\n  initializeRenderers() {\n    this.axisRenderer = new DateChartAxisRenderer(this);\n    this.gridRenderer = new TimeChartGridRenderer(this);\n    this.labelRenderer = new TimeChartLabelRenderer(this);\n    this.legendRenderer = new TimeChartLegendRenderer(this);\n    this.barsRenderer = new TimeChartBarsRenderer(this);\n    this.ghostBarsRenderer = new TimeChartHoverBarsRenderer(this);\n    this.selectionRenderer = new TimeChartSelectionRenderer(this);\n    this.tooltipRenderer = new TimeChartTooltipRenderer(this);\n  }\n\n  /**\n   * Removes all `svg`s from the parental element.\n   * @override\n   */\n  remove() {\n    this.element.selectAll('svg').remove();\n  }\n\n  /**\n   * @override\n   */\n  precalculate() {\n    let config = this.config;\n    let margin = config.margin;\n    this.graphWidth = config.width - margin.left - margin.right;\n    this.graphHeight = config.height - margin.top - margin.bottom;\n    if (!this.datasetController) return;\n    let groupSize = this.config.groupSize || 1;\n\n    if (this.config.combineStacks) {\n      this.dataview = this.datasetController.getDateDataviewCombinedStacks(groupSize);\n    } else {\n      this.dataview = this.datasetController.getDateDataview(groupSize);\n    }\n    this.createScales();\n  }\n\n  /**\n   * Creates scales which are used to calculate the x and y positions of bars or circles.\n   */\n  createScales() {\n    if (!this.dataview) return;\n\n    let config = this.config;\n    let margin = config.margin;\n\n    /*\n     * Prefer dates specified by configuration. Fallback to dates of datasets.\n     */\n    let dates = config.dateLabels || this.dataview.dates;\n\n    this.xChartScale = d3\n      .scaleBand()\n      .domain(dates)\n      .rangeRound([margin.left, config.width - margin.right]);\n\n    this.xChartScalePadding = d3\n      .scaleBand()\n      .domain(dates)\n      .rangeRound([margin.left, config.width - margin.right])\n      .paddingInner(0.2);\n\n\n    this.xStack = d3\n      .scaleBand()\n      .domain(this.dataview.enabledStacks)\n      .rangeRound([0, this.xChartScale.bandwidth()])\n      .padding(0.05);\n\n    this.yChart = d3\n      .scaleLinear()\n      .domain([0, this.dataview.max])\n      .nice()\n      .rangeRound([config.height - margin.bottom, margin.top]);\n  }\n\n  /**\n   * Creates and renders the chart.\n   *\n   * @override\n   */\n  draw() {\n    this.renderSVG();\n    if (!this.dataview\n      || !this.dataview.datasetStacks\n      || this.dataview.datasetStacks.length === 0) return;\n\n    this.axisRenderer.render();\n    this.gridRenderer.createAxis();\n    this.gridRenderer.renderGrid();\n    this.selectionRenderer.render();\n    this.ghostBarsRenderer.renderGhostBars();\n    this.legendRenderer.render();\n\n    for (let index = 0; index < this.dataview.datasetStacksPresented.length; index++) {\n      let stack = this.dataview.datasetStacksPresented[index];\n      this.barsRenderer.renderBars(stack, index);\n      if (this.config.showLabels === false) continue;\n      this.labelRenderer.renderBarLabels(stack, index);\n    }\n  }\n\n  /**\n   *\n   */\n  renderSVG() {\n    this.svg = this.element\n      .append('svg')\n      .attr('class', 'lotivis-chart-svg lotivis-date.chart-chart')\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr(\"viewBox\", `0 0 ${this.config.width} ${this.config.height}`)\n      .attr('id', this.svgSelector);\n\n    this.background = this.svg\n      .append('rect')\n      .attr('width', this.config.width)\n      .attr('height', this.config.height)\n      .attr('fill', 'white')\n      .attr('opacity', 0)\n      .attr('cursor', 'pointer')\n      .on('click', (event, some) => {\n        this.datasetController.resetDateFilters();\n      });\n\n    this.graph = this.svg\n      .append('g')\n      .attr('width', this.graphWidth)\n      .attr('height', this.graphHeight)\n      .attr('transform', `translate(${this.config.margin.left},${this.config.margin.top})`);\n  }\n\n  /**\n   * Toggle the enabled of the dataset with the given label.\n   * @param label The label of the dataset.\n   */\n  toggleDataset(label) {\n    this.datasetController.toggleDataset(label, this.config.sendsNotifications === true);\n    this.update();\n  }\n}\n","/**\n *\n * @class UrlParameters\n */\nexport class UrlParameters {\n\n  /**\n   * Returns the singleton instance.\n   *\n   * @returns {UrlParameters}\n   */\n  static getInstance() {\n    if (!UrlParameters.instance) {\n      UrlParameters.instance = new UrlParameters();\n    }\n    return UrlParameters.instance;\n  }\n\n  /**\n   * Return the current window URL.\n   * @returns {URL}\n   */\n  getURL() {\n    return new URL(window.location.href);\n  }\n\n  getBoolean(parameter, defaultValue = false) {\n    let value = this.getURL().searchParams.get(parameter);\n    return value ? value === 'true' : defaultValue;\n  }\n\n  getString(parameter, defaultValue = '') {\n    return this.getURL().searchParams.get(parameter) || defaultValue;\n  }\n\n  set(parameter, newValue) {\n    const url = this.getURL();\n\n    if (newValue === false) {\n      url.searchParams.delete(parameter);\n    } else {\n      url.searchParams.set(parameter, newValue);\n    }\n\n    window.history.replaceState(null, null, url);\n    this.updateCurrentPageFooter();\n  }\n\n  setWithoutDeleting(parameter, newValue) {\n    const url = this.getURL();\n    url.searchParams.set(parameter, newValue);\n    window.history.replaceState(null, null, url);\n    this.updateCurrentPageFooter();\n  }\n\n  clear() {\n    const url = this.getURL();\n    const newPath = url.protocol + url.host;\n    const newURL = new URL(newPath);\n    window.history.replaceState(null, null, newURL);\n    this.updateCurrentPageFooter();\n  }\n\n  updateCurrentPageFooter() {\n    // console.log('window.lotivisApplication: ' + window.lotivisApplication);\n    // window.lotivisApplication.currentPage.updateFooter();\n    const url = this.getURL();\n    d3\n      .select('#lotivis-url-container')\n      .text(url);\n  }\n}\n\nUrlParameters.language = 'language';\nUrlParameters.page = 'page';\nUrlParameters.query = 'query';\nUrlParameters.searchViewMode = 'search-view-mode';\nUrlParameters.chartType = 'chart-type';\nUrlParameters.chartShowLabels = 'chart-show-labels';\nUrlParameters.chartCombineStacks = 'combine-stacks';\nUrlParameters.contentType = 'content-type';\nUrlParameters.valueType = 'value-type';\nUrlParameters.searchSensitivity = 'search-sensitivity';\nUrlParameters.startYear = 'start-year';\nUrlParameters.endYear = 'end-year';\n\nUrlParameters.showTestData = 'show-samples';\n","import {Popup} from './popup';\n\n/**\n * @class SettingsPopup\n * @extends Popup\n */\nexport class SettingsPopup extends Popup {\n\n  /**\n   * Creates a new instance of SettingsPopup.\n   */\n  constructor(parent) {\n    super(parent);\n  }\n\n  /**\n   * Appends the content of the settings popup.\n   * @override\n   */\n  inject() {\n    super.inject();\n    this.card.setTitle('Settings');\n    this.card.content.classed('lotivis-card-body-settings', true);\n    this.row = this.card.content.append('div').classed('lotivis-row', true);\n  }\n\n  /**\n   * Returns the preferred size of the popup.\n   * @returns {{width: number, height: number}}\n   * @override\n   */\n  preferredSize() {\n    return {width: 240, height: 600};\n  }\n}\n","import {Checkbox} from \"../shared.components/checkbox\";\nimport {UrlParameters} from \"../shared/url.parameters\";\nimport {SettingsPopup} from \"../shared.components/settings.popup\";\n\n/**\n *\n * @class DateChartCardSettingsPopup\n * @extends SettingsPopup\n */\nexport class DateChartCardSettingsPopup extends SettingsPopup {\n\n  inject() {\n    super.inject();\n    this.injectShowLabelsCheckbox();\n    this.injectCombineStacksCheckbox();\n  }\n\n  injectShowLabelsCheckbox() {\n    let container = this.row.append('div');\n    this.showLabelsCheckbox = new Checkbox(container);\n    this.showLabelsCheckbox.setText('Labels');\n    this.showLabelsCheckbox.onClick = function (checked) {\n      this.chart.config.showLabels = checked;\n      this.chart.update();\n      UrlParameters.getInstance().set(`showLabels-${this.chart.selector}`, checked);\n    }.bind(this);\n  }\n\n  injectCombineStacksCheckbox() {\n    let container = this.row.append('div');\n    this.combineStacksCheckbox = new Checkbox(container);\n    this.combineStacksCheckbox.setText('Combine Stacks');\n    this.combineStacksCheckbox.onClick = function (checked) {\n      this.chart.config.combineStacks = checked;\n      this.chart.update();\n      UrlParameters.getInstance().set(`combineStacks-${this.chart.selector}`, checked);\n    }.bind(this);\n  }\n\n  willShow() {\n    this.showLabelsCheckbox.setChecked(this.chart.config.showLabels);\n    this.combineStacksCheckbox.setChecked(this.chart.config.combineStacks);\n  }\n}\n","import {Card} from \"./card\";\nimport {Button} from \"./button\";\nimport {RadioGroup} from \"./radio.group\";\nimport {Option} from \"./option\";\nimport {LotivisUnimplementedMethodError} from \"../data.juggle/data.validate.error\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * A lotivis card with a chart.\n * @class ChartCard\n * @extends Card\n */\nexport class ChartCard extends Card {\n\n  /**\n   * Creates a new instance of ChartCard.\n   * @param parent The parental component.\n   * @param config The configuration\n   */\n  constructor(parent, config) {\n\n    if (parent && config && typeof parent === 'string') {\n      config.selector = parent;\n      super(config);\n    } else {\n      super(parent);\n    }\n\n    this.chart = null;\n    this.config = config;\n    this.injectButtons();\n    this.injectRadioGroup();\n    this.injectChart();\n\n    let cardSelector = this.selector;\n    this.setTitle((config && config.title) ? config.title : (cardSelector || 'No Title'));\n  }\n\n  /**\n   * Creates and injects the chart.\n   * Should be overridden by subclasses.\n   */\n  injectChart() {\n    return new LotivisUnimplementedMethodError(`injectChart()`);\n  }\n\n  /**\n   * Creates and injects a screenshot button and a more button.\n   */\n  injectButtons() {\n    this.screenshotButton = new Button(this.headerRightComponent);\n    this.screenshotButton.setText('Screenshot');\n    this.screenshotButton.element.classed('simple-button', true);\n    this.screenshotButton.onClick = this.screenshotButtonAction.bind(this);\n\n    this.moreButton = new Button(this.headerRightComponent);\n    this.moreButton.setText('More');\n    this.moreButton.element.classed('simple-button', true);\n    this.moreButton.onClick = this.presentSettingsPopupAction.bind(this);\n  }\n\n  /**\n   * Creates and injects a radio button group.\n   */\n  injectRadioGroup() {\n    this.radioGroup = new RadioGroup(this.headerCenterComponent);\n    this.radioGroup.onChange = function (value) {\n      let dataset = this.datasets.find(function (dataset) {\n        if (!dataset.label) return false;\n        return dataset.label.split(` `).join(`-`) === value;\n      });\n      if (!dataset) return lotivis_log(`Can't find dataset with label ${value}`);\n      this.setDataset(dataset);\n    }.bind(this);\n  }\n\n  /**\n   * Updates the options of the radio button group dependant on the given datasets.\n   */\n  updateRadioGroup() {\n    if (!this.datasets) return;\n    let names = this.datasets.map(dataset => dataset.label || 'Unknown Label');\n    let options = names.map(name => new Option(name));\n    this.radioGroup.setOptions(options);\n  }\n\n  /**\n   *\n   * @param datasets\n   */\n  setDatasets(datasets) {\n    this.datasets = datasets;\n    this.updateRadioGroup();\n    let firstDataset = datasets[0];\n    this.setDataset(firstDataset);\n  }\n\n  /**\n   *\n   * @param dataset\n   */\n  setDataset(dataset) {\n    lotivis_log('this.chart: ' + this.chart);\n    lotivis_log('this.chart: ', dataset);\n    if (!this.chart) return;\n    if (Array.isArray(dataset)) {\n      this.chart.setDatasets(dataset);\n    } else {\n      this.chart.setDatasets([dataset]);\n    }\n\n    if (this.onSelectedDatasetChanged) {\n      let datasetLabel = dataset.stack || dataset.label || `Unknown`;\n      let index = (this.datasets || []).indexOf(dataset);\n      this.onSelectedDatasetChanged(dataset, index, datasetLabel);\n    }\n  }\n\n  /**\n   * Triggered when the screenshot button is pushed.\n   *\n   * Should be overridden by subclasses.\n   */\n  screenshotButtonAction() {\n    return new LotivisUnimplementedMethodError(`screenshotButtonAction()`);\n  }\n\n  /**\n   * Triggered when the more button is pushed.\n   *\n   * Should be overridden by subclasses.\n   */\n  presentSettingsPopupAction() {\n    return new LotivisUnimplementedMethodError(`presentSettingsPopupAction()`);\n  }\n\n  /**\n   * Triggered for a change of the radio group.\n   *\n   * Should be overridden by subclasses.\n   */\n  onSelectedDatasetChanged() {\n    return new LotivisUnimplementedMethodError(`onSelectedDatasetChanged()`);\n  }\n}\n","import {Card} from \"../shared.components/card\";\nimport {DateChart} from \"../date.chart/date.chart\";\nimport {DateChartCardSettingsPopup} from \"./date.chart.card.settings.popup\";\nimport {RadioGroup} from \"../shared.components/radio.group\";\nimport {Option} from \"../shared.components/option\";\nimport {ChartCard} from \"../shared.components/chart.card\";\nimport {downloadImage} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\nimport {UrlParameters} from \"../shared/url.parameters\";\n\n/**\n * A lotivis date.chart chart card.\n * @class DateChartCard\n * @extends Card\n */\nexport class DateChartCard extends ChartCard {\n\n  /**\n   * Creates a new instance of DateChartCard.\n   * @param {Component| string} selector The parental component or the selector.\n   * @param config\n   */\n  constructor(selector, config = {}) {\n    let theSelector = selector || config.selector || 'date-chart-card';\n    super(theSelector, config);\n    this.selector = theSelector;\n    this.datasets = [];\n    this.injectRadioGroup();\n  }\n\n  /**\n   * Appends the `DateChart` to this card.\n   * @override\n   */\n  injectChart() {\n    this.chartID = this.selector + '-chart';\n    this.body.attr('id', this.chartID);\n    this.chart = new DateChart(this.chartID, this.config);\n    this.applyURLParameters();\n  }\n\n  /**\n   * Appends a radio group to the header of the card.\n   */\n  injectRadioGroup() {\n    this.radioGroup = new RadioGroup(this.headerCenterComponent);\n    this.radioGroup.onChange = function (value) {\n      let dataset = this.datasets.find(dataset => dataset.label === value);\n      this.setDataset(dataset);\n    }.bind(this);\n  }\n\n  /**\n   * Updates the radio group dependant on the datasets of this card.\n   */\n  updateRadioGroup() {\n    if (!this.datasets) return;\n    let names = this.datasets.map(dataset => dataset.label);\n    let options = names.map(name => new Option(name));\n    this.radioGroup.setOptions(options);\n  }\n\n  /**\n   *\n   */\n  applyURLParameters() {\n    let parameters = UrlParameters.getInstance();\n    this.chart.config.showLabels = parameters\n      .getBoolean(`showLabels-${this.chartID}`, this.chart.config.showLabels);\n    this.chart.config.combineStacks = parameters\n      .getBoolean(`combineStacks-${this.chartID}`, this.chart.config.combineStacks);\n  }\n\n  /**\n   * Tells this chart card to present the setting popup card.\n   * @override\n   */\n  presentSettingsPopupAction() {\n    let button = document.getElementById(this.moreButton.selector);\n    let settingsPopup = new DateChartCardSettingsPopup();\n    settingsPopup.chart = this.chart;\n    settingsPopup.showUnder(button, 'right');\n  }\n\n  /**\n   * Creates and downloads a screenshot from the chart.\n   * @override\n   */\n  screenshotButtonAction() {\n    let filename = this.chart.datasetController.getFilename() || 'date.chart-chart';\n    let downloadFilename = createDownloadFilename(filename, `date-chart`);\n    downloadImage(this.chart.svgSelector, downloadFilename);\n  }\n}\n","/**\n *\n * @param geoJSON\n * @param removeCandidates\n * @returns {*}\n */\nexport function removeFeatures(geoJSON, removeCandidates) {\n  if (!Array.isArray(removeCandidates)) return geoJSON;\n  let newGeoJSON = geoJSON;\n  for (let index = 0; index < removeCandidates.length; index++) {\n    let code = removeCandidates[index];\n    let candidate = newGeoJSON.features.find(feature => feature.properties.code === code);\n    if (!candidate) continue;\n    let candidateIndex = newGeoJSON.features.indexOf(candidate);\n    if (candidateIndex < 0) continue;\n    newGeoJSON.features.splice(candidateIndex, 1);\n  }\n  return newGeoJSON;\n}\n","/**\n * Returns the style of the given CSS class or an empty object.\n *\n * @param className The CSS class name.\n * @returns {{}} The CSS style.\n */\nexport function styleForCSSClass(className) {\n  let selector = className;\n  if (!selector.startsWith('.')) selector = '.' + selector;\n  let element = document.querySelector(selector);\n  if (!element) return {};\n  let style = getComputedStyle(element);\n  return style ? style : {};\n}\n","/**\n * The default number format.\n *\n * @type {Intl.NumberFormat}\n */\nconst numberFormat = new Intl.NumberFormat('de-DE', {\n  maximumFractionDigits: 3\n});\n\n/**\n * Returns the formatted version from the given number.\n *\n * @param number The number to format.\n * @returns {string} The formatted version of the number.\n */\nexport function formatNumber(number) {\n  if (typeof number !== 'number') return number;\n  return numberFormat.format(number);\n}\n","import {combineByLocation} from \"../data.juggle/data.combine\";\nimport {styleForCSSClass} from \"../shared/style\";\nimport {formatNumber} from \"../shared/format\";\nimport {equals} from \"../shared/equal\";\nimport {LotivisConfig} from \"../shared/config\";\n\n/**\n *\n * @class MapTooltipRenderer\n */\nexport class MapTooltipRenderer {\n\n  /**\n   * Creates a new instance of MapTooltipRenderer.\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n    this.mapChart = mapChart;\n\n    let tooltip = mapChart\n      .element\n      .append('div')\n      .attr('class', 'lotivis-tooltip')\n      .attr('rx', 5) // corner radius\n      .attr('ry', 5)\n      .style('opacity', 0);\n\n    function featureMapID(feature) {\n      return `lotivis-map-area-${feature.lotivisId}`;\n    }\n\n    function htmlTitle(features) {\n\n      if (features.length > 3) {\n        let featuresSlice = features.slice(0, 3);\n        let ids = featuresSlice.map(feature => `${feature.lotivisId}`).join(', ');\n        let names = featuresSlice.map(mapChart.config.featureNameAccessor).join(', ');\n        let moreCount = features.length - 3;\n        return `IDs: ${ids} (+${moreCount})<br>Names: ${names} (+${moreCount})`;\n      } else {\n        let ids = features.map(feature => `${feature.lotivisId}`).join(', ');\n        let names = features.map(mapChart.config.featureNameAccessor).join(', ');\n        return `IDs: ${ids}<br>Names: ${names}`;\n      }\n    }\n\n    function htmlValues(features) {\n      if (!mapChart.datasetController) {\n        return '';\n      }\n\n      let flatData = mapChart.datasetController.flatData;\n      let combined = combineByLocation(flatData);\n      let combinedByLabel = {};\n\n      for (let i = 0; i < features.length; i++) {\n        let feature = features[i];\n        let data = combined.filter(item => equals(item.location, feature.lotivisId));\n\n        for (let index = 0; index < data.length; index++) {\n          let item = data[index];\n          let label = (item.label || item.dataset || item.stack);\n\n          if (combinedByLabel[label]) {\n            combinedByLabel[label] += item.value;\n          } else {\n            combinedByLabel[label] = item.value;\n          }\n        }\n      }\n\n      let components = [''];\n      for (const label in combinedByLabel) {\n        components.push(label + ': ' + formatNumber(combinedByLabel[label]));\n      }\n\n      return components.join('<br>');\n    }\n\n    /**\n     * Returns the size of the tooltip.\n     * @returns {number[]}\n     */\n    function getTooltipSize() {\n      let tooltipWidth = Number(tooltip.style('width').replace('px', '') || 200);\n      let tooltipHeight = Number(tooltip.style('height').replace('px', ''));\n      return [tooltipWidth + 20, tooltipHeight + 20];\n    }\n\n    function positionTooltip(event, feature) {\n\n      // position tooltip\n      let tooltipSize = getTooltipSize();\n      let projection = mapChart.projection;\n      let featureBounds = d3.geoBounds(feature);\n      let featureLowerLeft = projection(featureBounds[0]);\n      let featureUpperRight = projection(featureBounds[1]);\n      let featureBoundsWidth = featureUpperRight[0] - featureLowerLeft[0];\n\n      // svg is presented in dynamic sized view box so we need to get the actual size\n      // of the element in order to calculate a scale for the position of the tooltip.\n      let effectiveSize = mapChart.getElementEffectiveSize();\n      let factor = effectiveSize[0] / mapChart.config.width;\n      let positionOffset = mapChart.getElementPosition();\n\n      /**\n       * Calculates and returns the left position for the tooltip.\n       * @returns {*} The left position in pixels.\n       */\n      function getTooltipLeft() {\n        let left = featureLowerLeft[0];\n        left += (featureBoundsWidth / 2);\n        left *= factor;\n        left -= (tooltipSize[0] / 2);\n        left += positionOffset[0];\n        return left;\n      }\n\n      /**\n       * Calculates and returns the top tooltip position when displaying above a feature.\n       * @returns {*} The top position in pixels.\n       */\n      function getTooltipLocationAbove() {\n        let top = featureUpperRight[1] * factor;\n        top -= tooltipSize[1];\n        top += positionOffset[1];\n        top -= LotivisConfig.tooltipOffset;\n        return top;\n      }\n\n      /**\n       * Calculates and returns the top tooltip position when displaying under a feature.\n       * @returns {*} The top position in pixels.\n       */\n      function getTooltipLocationUnder() {\n        let top = featureLowerLeft[1] * factor;\n        top += positionOffset[1];\n        top += LotivisConfig.tooltipOffset;\n        return top;\n      }\n\n      let top = 0;\n      if (featureLowerLeft[1] > (mapChart.config.height / 2)) {\n        top = getTooltipLocationAbove();\n      } else {\n        top = getTooltipLocationUnder();\n      }\n\n      let left = getTooltipLeft();\n      tooltip\n        .style('opacity', 1)\n        .style('left', left + 'px')\n        .style('top', top + 'px');\n\n    }\n\n    /**\n     * Called by map.chart geojson renderer when mouse enters an area drawn on the map.chart.\n     * @param event The mouse event.\n     * @param feature The drawn feature (area).\n     */\n    this.mouseEnter = function (event, feature) {\n      if (mapChart.datasetController\n        && mapChart.datasetController.filters.locations.includes(feature.lotivisId)) {\n        tooltip.html(\n          [\n            htmlTitle(mapChart.selectedFeatures),\n            htmlValues(mapChart.selectedFeatures)\n          ].join('<br>')\n        );\n        positionTooltip(event, mapChart.selectionBorderGeoJSON.features[0]);\n      } else {\n        tooltip.html(\n          [\n            htmlTitle([feature]),\n            htmlValues([feature])\n          ].join('<br>')\n        );\n        positionTooltip(event, feature);\n      }\n    };\n\n    /**\n     * Called by map.chart geojson renderer when mouse leaves an area drawn on the map.chart.\n     * @param event The mouse event.\n     * @param feature The drawn feature (area).\n     */\n    this.mouseOut = function (event, feature) {\n      let style = styleForCSSClass('.lotivis-map.chart-area');\n      let mapID = featureMapID(feature);\n      mapChart.svg.select(`#${mapID}`)\n        .style('stroke', style.stroke || 'black')\n        .style('stroke-width', style['stroke-width'] || '0.7')\n        .style('stroke-dasharray', (feature) => feature.departmentsData ? '0' : '1,4');\n      tooltip.style('opacity', 0);\n    };\n\n    /**\n     * Raises the tooltip and the rectangle which draws the bounds.\n     */\n    this.raise = function () {\n      tooltip.raise();\n    };\n  }\n}\n","import {Color} from \"../shared/color\";\nimport {formatNumber} from \"../shared/format\";\n\n/**\n *\n * @class MapLegendRenderer\n */\nexport class MapLegendRenderer {\n\n  /**\n   * Creates a new instance of MapLegendRenderer.\n   *\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n    let legend;\n\n    function appendLegend() {\n      legend = mapChart.svg\n        .append('svg')\n        .attr('class', 'lotivis-location-chart-legend')\n        .attr('width', mapChart.width)\n        .attr('height', 200)\n        .attr('x', 0)\n        .attr('y', 0);\n    }\n\n    function removeDatasetLegend() {\n      legend.selectAll('rect').remove();\n      legend.selectAll('text').remove();\n    }\n\n    this.render = function () {\n      if (!mapChart.dataview) return;\n\n      let stackNames = mapChart.dataview.stacks;\n      let combinedData = mapChart.dataview.combinedData;\n\n      appendLegend();\n      legend.raise();\n      removeDatasetLegend();\n\n      for (let index = 0; index < stackNames.length; index++) {\n\n        let stackName = stackNames[index];\n        let dataForStack = combinedData.filter(data => data.stack === stackName);\n        let max = d3.max(dataForStack, item => item.value) || 0;\n        let offset = index * 80;\n        let color = Color.colorsForStack(index, 1)[0];\n\n        let steps = 4;\n        let data = [0, 1 / 4 * max, 1 / 2 * max, 3 / 4 * max, max];\n        let generator = Color.mapColors(max);\n\n        legend\n          .append('text')\n          .attr('class', 'lotivis-location-chart-legend-title')\n          .attr('x', offset + 10)\n          .attr('y', '20')\n          .style('fill', color.rgbString())\n          .text(stackName);\n\n        legend\n          .append(\"g\")\n          .selectAll(\"text\")\n          .data(['No Data'])\n          .enter()\n          .append(\"text\")\n          .attr('class', 'lotivis-location-chart-legend-text')\n          .attr('x', offset + 35)\n          .attr('y', 44)\n          .text(d => d);\n\n        legend\n          .append('g')\n          .selectAll(\"rect\")\n          .data([0])\n          .enter()\n          .append(\"rect\")\n          .attr('class', 'lotivis-location-chart-legend-rect')\n          .style('fill', 'white')\n          .attr('x', offset + 10)\n          .attr('y', 30)\n          .attr('width', 18)\n          .attr('height', 18)\n          .style('stroke-dasharray', '1,3')\n          .style('stroke', 'black')\n          .style('stroke-width', 1);\n\n        legend\n          .append(\"g\")\n          .selectAll(\"text\")\n          .data([0])\n          .enter()\n          .append(\"text\")\n          .attr('class', 'lotivis-location-chart-legend-text')\n          .attr('x', offset + 35)\n          .attr('y', 64)\n          .text(d => d);\n\n        legend\n          .append('g')\n          .selectAll(\"rect\")\n          .data([0])\n          .enter()\n          .append(\"rect\")\n          .attr('class', 'lotivis-location-chart-legend-rect')\n          .style('fill', 'WhiteSmoke')\n          .attr('x', offset + 10)\n          .attr('y', 50)\n          .attr('width', 18)\n          .attr('height', 18)\n          .style('stroke', 'black')\n          .style('stroke-width', 1);\n\n        legend\n          .append(\"g\")\n          .selectAll(\"rect\")\n          .data(data)\n          .enter()\n          .append(\"rect\")\n          .attr('class', 'lotivis-location-chart-legend-rect')\n          .style('fill', generator)\n          .attr('x', offset + 10)\n          .attr('y', (d, i) => (i * 20) + 70)\n          .attr('width', 18)\n          .attr('height', 18)\n          .style('stroke', 'black')\n          .style('stroke-width', 1);\n\n        legend\n          .append(\"g\")\n          .selectAll(\"text\")\n          .data(data)\n          .enter()\n          .append(\"text\")\n          .attr('class', 'lotivis-location-chart-legend-text')\n          .attr('x', offset + 35)\n          .attr('y', (d, i) => (i * 20) + 84)\n          .text(function (d, i) {\n            if (d === 0) {\n              return '> 0';\n            } else {\n              return formatNumber(((i / steps) * max));\n            }\n          });\n\n        return;\n      }\n    };\n  }\n}\n","import {formatNumber} from \"../shared/format\";\nimport {equals} from \"../shared/equal\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n *\n * @class MapLabelRenderer\n */\nexport class MapLabelRenderer {\n\n  /**\n   * Creates a new instance of MapLabelRenderer.\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    /**\n     * Removes any old labels from the map.chart.\n     */\n    function removeLabels() {\n      mapChart.svg.selectAll('.lotivis-map.chart-label').remove();\n    }\n\n    /**\n     * Appends labels from datasets.\n     */\n    this.render = function () {\n      removeLabels();\n\n      let geoJSON = mapChart.geoJSON;\n      if (!mapChart.geoJSON) return lotivis_log(`[lotivis]  No GeoJSON to render (${mapChart.selector}).`);\n      let dataview = mapChart.dataview;\n\n      if (!dataview) return lotivis_log(`[lotivis]  No dataview in map chart (${mapChart.selector}).`);\n      if (!mapChart.config.showLabels) return lotivis_log(`[lotivis]  Skip rendering labels due to configuration (${mapChart.selector}).`);\n\n      mapChart.svg\n        .selectAll('text')\n        .data(geoJSON.features)\n        .enter()\n        .append('text')\n        .attr('class', 'lotivis-location-chart-label')\n        .text(function (feature) {\n          let featureID = mapChart.config.featureIDAccessor(feature);\n          let dataset = dataview.combinedData.find(dataset => equals(dataset.location, featureID));\n          return dataset ? formatNumber(dataset.value) : '';\n        })\n        .attr('x', function (feature) {\n          return mapChart.projection(feature.center)[0];\n        }.bind(this))\n        .attr('y', function (feature) {\n          return mapChart.projection(feature.center)[1];\n        }.bind(this));\n\n    };\n  }\n}\n","import {equals} from \"../shared/equal\";\nimport {Color} from \"../shared/color\";\nimport {lotivis_log} from \"../shared/debug\";\nimport {styleForCSSClass} from \"../shared/style\";\n\n/**\n *\n * @class MapDatasetRenderer\n */\nexport class MapDatasetRenderer {\n\n  /**\n   * Creates a new instance of MapDatasetRenderer.\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    let generator = Color.mapColors(1);\n    let styleArea = styleForCSSClass('lotivis-map-chart-area');\n    let styleHover = styleForCSSClass('lotivis-map-chart-area-hover');\n\n    /**\n     * Resets the `fill` and `fill-opacity` property of each area.\n     */\n    function resetAreas() {\n      mapChart.svg\n        .selectAll('.lotivis-map-chart-area')\n        .classed('lotivis-map-chart-area-hover', false);\n    }\n\n    function featureMapID(feature) {\n      return `lotivis-map-chart-area-id-${feature.lotivisId}`;\n    }\n\n    /**\n     * Called by map chart GeoJSON renderer when mouse enters an area drawn\n     * on the location chart.\n     *\n     * @param event The mouse event.\n     * @param feature The drawn feature (area).\n     */\n    this.mouseEnter = function (event, feature) {\n      resetAreas();\n\n      let color = styleArea.stroke || Color.defaultTint.rgbString();\n      let mapID = featureMapID(feature);\n\n      mapChart\n        .svg\n        .selectAll(`#${mapID}`)\n        .raise()\n        .classed('lotivis-map-chart-area-hover', true);\n        // .style('stroke', styleHover.stroke || color)\n        // .style('stroke-width', styleHover['stroke-width'] || '4')\n        // .style('stroke-dasharray', '0');\n\n      mapChart\n        .svg\n        .selectAll('.lotivis-location-chart-label')\n        .raise();\n    };\n\n    /**\n     * Tells this renderer that the mouse moved out of an area.\n     */\n    this.mouseOut = function () {\n      resetAreas();\n    };\n\n    /**\n     * Iterates the datasets per stack and draws them on svg.\n     */\n    this.render = function () {\n      if (!mapChart.geoJSON) return lotivis_log('[lotivis]  No GeoJSON to render.');\n      if (!mapChart.dataview) return lotivis_log('[lotivis]  No data view property.');\n\n      let stackNames = mapChart.dataview.stacks;\n      let combinedData = mapChart.dataview.combinedData;\n      resetAreas();\n\n      for (let index = 0; index < stackNames.length; index++) {\n\n        let stackName = stackNames[index];\n        let dataForStack = combinedData.filter(data => data.stack === stackName);\n        let max = d3.max(dataForStack, item => item.value);\n\n        for (let index = 0; index < dataForStack.length; index++) {\n\n          let datasetEntry = dataForStack[index];\n          let locationID = datasetEntry.location;\n          let opacity = Number(datasetEntry.value / max);\n\n          mapChart.svg\n            .selectAll('.lotivis-map-chart-area')\n            .filter((item) => equals(mapChart.config.featureIDAccessor(item), locationID))\n            .style('fill', function () {\n              if (opacity === 0) {\n                return 'WhiteSmoke';\n              } else {\n                return generator(opacity);\n              }\n            });\n        }\n        return;\n      }\n    };\n  }\n}\n","import {lotivis_log} from \"../shared/debug\";\n\n/**\n * @class MapGeoJSONRenderer\n */\nexport class MapGeoJSONRenderer {\n\n  /**\n   * Creates a new instance of MapGeoJSONRenderer.\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    /**\n     * To be called when the mouse enters an area drawn on the map.chart.\n     *\n     * @param event The mouse event.\n     * @param feature The drawn feature (area).\n     */\n    function mouseEnter(event, feature) {\n      mapChart.datasetRenderer.mouseEnter(event, feature);\n      mapChart.tooltipRenderer.mouseEnter(event, feature);\n    }\n\n    /**\n     * To be called when the mouse leaves an area drawn on the map.chart.\n     *\n     * @param event The mouse event.\n     * @param feature The drawn feature (area).\n     */\n    function mouseOut(event, feature) {\n      mapChart.datasetRenderer.mouseOut(event, feature);\n      mapChart.tooltipRenderer.mouseOut(event, feature);\n      mapChart.selectionRenderer.raise();\n\n      if (event.buttons === 1) {\n        mouseClick(event, feature);\n      }\n    }\n\n    function mouseClick(event, feature) {\n      if (!feature || !feature.properties) return;\n      if (!mapChart.datasetController) return;\n\n      if (mapChart.config.sendsNotifications) {\n        let locationID = feature.lotivisId;\n        mapChart.makeUpdateInsensible();\n        mapChart.datasetController.toggleLocation(locationID);\n        mapChart.makeUpdateSensible();\n        mapChart.selectionRenderer.render();\n        mapChart.tooltipRenderer.mouseEnter(event, feature);\n      }\n    }\n\n    /**\n     * Renders the `presentedGeoJSON` property.\n     */\n    this.render = function () {\n      let geoJSON = mapChart.presentedGeoJSON;\n      if (!geoJSON) return;\n\n      mapChart.areas = mapChart.svg\n        .selectAll('path')\n        .data(geoJSON.features)\n        .enter()\n        .append('path')\n        .attr('d', mapChart.path)\n        .attr('id', feature => `lotivis-map-chart-area-id-${feature.lotivisId}`)\n        .classed('lotivis-map-chart-area', true)\n        .style('stroke-dasharray', (feature) => feature.departmentsData ? '0' : '1,4')\n        .style('fill', 'white')\n        .style('fill-opacity', 1)\n        .on('click', mouseClick)\n        .on('mouseenter', mouseEnter)\n        .on('mouseout', mouseOut);\n    };\n  }\n}\n","/**\n * Returns a new created instance of Feature combining the given Features.\n * @param features\n */\nexport function joinFeatures(features) {\n  let topology = topojson.topology(features);\n  let objects = extractObjects(topology);\n\n  return {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n      {\n        type: \"Feature\",\n        geometry: topojson.merge(topology, objects),\n        properties: {\n          code: 1,\n          nom: \"asdf\"\n        }\n      }\n    ]\n  };\n}\n\n/**\n *\n * @param topology\n * @returns {[]}\n */\nexport function extractObjects(topology) {\n  let objects = [];\n  for (const topologyKey in topology.objects) {\n    if (topology.objects.hasOwnProperty(topologyKey)) {\n      objects.push(topology.objects[topologyKey]);\n    }\n  }\n  return objects;\n}\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity.js\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","import transform from \"./transform.js\";\n\nexport default function(topology) {\n  var t = transform(topology.transform), key,\n      x0 = Infinity, y0 = x0, x1 = -x0, y1 = -x0;\n\n  function bboxPoint(p) {\n    p = t(p);\n    if (p[0] < x0) x0 = p[0];\n    if (p[0] > x1) x1 = p[0];\n    if (p[1] < y0) y0 = p[1];\n    if (p[1] > y1) y1 = p[1];\n  }\n\n  function bboxGeometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(bboxGeometry); break;\n      case \"Point\": bboxPoint(o.coordinates); break;\n      case \"MultiPoint\": o.coordinates.forEach(bboxPoint); break;\n    }\n  }\n\n  topology.arcs.forEach(function(arc) {\n    var i = -1, n = arc.length, p;\n    while (++i < n) {\n      p = t(arc[i], i);\n      if (p[0] < x0) x0 = p[0];\n      if (p[0] > x1) x1 = p[0];\n      if (p[1] < y0) y0 = p[1];\n      if (p[1] > y1) y1 = p[1];\n    }\n  });\n\n  for (key in topology.objects) {\n    bboxGeometry(topology.objects[key]);\n  }\n\n  return [x0, y0, x1, y1];\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\n\nexport default function(topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","export default function(topology, arcs) {\n  var stitchedArcs = {},\n      fragmentByStart = {},\n      fragmentByEnd = {},\n      fragments = [],\n      emptyIndex = -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc = topology.arcs[i < 0 ? ~i : i], t;\n    if (arc.length < 3 && !arc[1][0] && !arc[1][1]) {\n      t = arcs[++emptyIndex], arcs[emptyIndex] = i, arcs[j] = t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e = ends(i),\n        start = e[0],\n        end = e[1],\n        f, g;\n\n    if (f = fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end = end;\n      if (g = fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg = g === f ? f : f.concat(g);\n        fragmentByStart[fg.start = f.start] = fragmentByEnd[fg.end = g.end] = fg;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else if (f = fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start = start;\n      if (g = fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf = g === f ? f : g.concat(f);\n        fragmentByStart[gf.start = g.start] = fragmentByEnd[gf.end = f.end] = gf;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else {\n      f = [i];\n      fragmentByStart[f.start = start] = fragmentByEnd[f.end = end] = f;\n    }\n  });\n\n  function ends(i) {\n    var arc = topology.arcs[i < 0 ? ~i : i], p0 = arc[0], p1;\n    if (topology.transform) p1 = [0, 0], arc.forEach(function(dp) { p1[0] += dp[0], p1[1] += dp[1]; });\n    else p1 = arc[arc.length - 1];\n    return i < 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f = fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i < 0 ? ~i : i] = 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i < 0 ? ~i : i]) fragments.push([i]); });\n\n  return fragments;\n}\n","import {object} from \"./feature.js\";\nimport stitch from \"./stitch.js\";\n\nexport default function(topology) {\n  return object(topology, meshArcs.apply(this, arguments));\n}\n\nexport function meshArcs(topology, object, filter) {\n  var arcs, i, n;\n  if (arguments.length > 1) arcs = extractArcs(topology, object, filter);\n  else for (i = 0, arcs = new Array(n = topology.arcs.length); i < n; ++i) arcs[i] = i;\n  return {type: \"MultiLineString\", arcs: stitch(topology, arcs)};\n}\n\nfunction extractArcs(topology, object, filter) {\n  var arcs = [],\n      geomsByArc = [],\n      geom;\n\n  function extract0(i) {\n    var j = i < 0 ? ~i : i;\n    (geomsByArc[j] || (geomsByArc[j] = [])).push({i: i, g: geom});\n  }\n\n  function extract1(arcs) {\n    arcs.forEach(extract0);\n  }\n\n  function extract2(arcs) {\n    arcs.forEach(extract1);\n  }\n\n  function extract3(arcs) {\n    arcs.forEach(extract2);\n  }\n\n  function geometry(o) {\n    switch (geom = o, o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"LineString\": extract1(o.arcs); break;\n      case \"MultiLineString\": case \"Polygon\": extract2(o.arcs); break;\n      case \"MultiPolygon\": extract3(o.arcs); break;\n    }\n  }\n\n  geometry(object);\n\n  geomsByArc.forEach(filter == null\n      ? function(geoms) { arcs.push(geoms[0].i); }\n      : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) arcs.push(geoms[0].i); });\n\n  return arcs;\n}\n","import {object} from \"./feature.js\";\nimport stitch from \"./stitch.js\";\n\nfunction planarRingArea(ring) {\n  var i = -1, n = ring.length, a, b = ring[n - 1], area = 0;\n  while (++i < n) a = b, b = ring[i], area += a[0] * b[1] - a[1] * b[0];\n  return Math.abs(area); // Note: doubled area!\n}\n\nexport default function(topology) {\n  return object(topology, mergeArcs.apply(this, arguments));\n}\n\nexport function mergeArcs(topology, objects) {\n  var polygonsByArc = {},\n      polygons = [],\n      groups = [];\n\n  objects.forEach(geometry);\n\n  function geometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"Polygon\": extract(o.arcs); break;\n      case \"MultiPolygon\": o.arcs.forEach(extract); break;\n    }\n  }\n\n  function extract(polygon) {\n    polygon.forEach(function(ring) {\n      ring.forEach(function(arc) {\n        (polygonsByArc[arc = arc < 0 ? ~arc : arc] || (polygonsByArc[arc] = [])).push(polygon);\n      });\n    });\n    polygons.push(polygon);\n  }\n\n  function area(ring) {\n    return planarRingArea(object(topology, {type: \"Polygon\", arcs: [ring]}).coordinates[0]);\n  }\n\n  polygons.forEach(function(polygon) {\n    if (!polygon._) {\n      var group = [],\n          neighbors = [polygon];\n      polygon._ = 1;\n      groups.push(group);\n      while (polygon = neighbors.pop()) {\n        group.push(polygon);\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            polygonsByArc[arc < 0 ? ~arc : arc].forEach(function(polygon) {\n              if (!polygon._) {\n                polygon._ = 1;\n                neighbors.push(polygon);\n              }\n            });\n          });\n        });\n      }\n    }\n  });\n\n  polygons.forEach(function(polygon) {\n    delete polygon._;\n  });\n\n  return {\n    type: \"MultiPolygon\",\n    arcs: groups.map(function(polygons) {\n      var arcs = [], n;\n\n      // Extract the exterior (unique) arcs.\n      polygons.forEach(function(polygon) {\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            if (polygonsByArc[arc < 0 ? ~arc : arc].length < 2) {\n              arcs.push(arc);\n            }\n          });\n        });\n      });\n\n      // Stitch the arcs into one or more rings.\n      arcs = stitch(topology, arcs);\n\n      // If more than one ring is returned,\n      // at most one of these rings can be the exterior;\n      // choose the one with the greatest absolute area.\n      if ((n = arcs.length) > 1) {\n        for (var i = 1, k = area(arcs[0]), ki, t; i < n; ++i) {\n          if ((ki = area(arcs[i])) > k) {\n            t = arcs[0], arcs[0] = arcs[i], arcs[i] = t, k = ki;\n          }\n        }\n      }\n\n      return arcs;\n    }).filter(function(arcs) {\n      return arcs.length > 0;\n    })\n  };\n}\n","export default function(a, x) {\n  var lo = 0, hi = a.length;\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n    if (a[mid] < x) lo = mid + 1;\n    else hi = mid;\n  }\n  return lo;\n}\n","import bisect from \"./bisect.js\";\n\nexport default function(objects) {\n  var indexesByArc = {}, // arc index -> array of object indexes\n      neighbors = objects.map(function() { return []; });\n\n  function line(arcs, i) {\n    arcs.forEach(function(a) {\n      if (a < 0) a = ~a;\n      var o = indexesByArc[a];\n      if (o) o.push(i);\n      else indexesByArc[a] = [i];\n    });\n  }\n\n  function polygon(arcs, i) {\n    arcs.forEach(function(arc) { line(arc, i); });\n  }\n\n  function geometry(o, i) {\n    if (o.type === \"GeometryCollection\") o.geometries.forEach(function(o) { geometry(o, i); });\n    else if (o.type in geometryType) geometryType[o.type](o.arcs, i);\n  }\n\n  var geometryType = {\n    LineString: line,\n    MultiLineString: polygon,\n    Polygon: polygon,\n    MultiPolygon: function(arcs, i) { arcs.forEach(function(arc) { polygon(arc, i); }); }\n  };\n\n  objects.forEach(geometry);\n\n  for (var i in indexesByArc) {\n    for (var indexes = indexesByArc[i], m = indexes.length, j = 0; j < m; ++j) {\n      for (var k = j + 1; k < m; ++k) {\n        var ij = indexes[j], ik = indexes[k], n;\n        if ((n = neighbors[ij])[i = bisect(n, ik)] !== ik) n.splice(i, 0, ik);\n        if ((n = neighbors[ik])[i = bisect(n, ij)] !== ij) n.splice(i, 0, ij);\n      }\n    }\n  }\n\n  return neighbors;\n}\n","import identity from \"./identity.js\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2,\n        n = input.length,\n        output = new Array(n),\n        x1 = Math.round((input[0] - dx) / kx),\n        y1 = Math.round((input[1] - dy) / ky);\n    output[0] = x1 - x0, x0 = x1;\n    output[1] = y1 - y0, y0 = y1;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","import bbox from \"./bbox.js\";\nimport untransform from \"./untransform.js\";\n\nexport default function(topology, transform) {\n  if (topology.transform) throw new Error(\"already quantized\");\n\n  if (!transform || !transform.scale) {\n    if (!((n = Math.floor(transform)) >= 2)) throw new Error(\"n must be 2\");\n    box = topology.bbox || bbox(topology);\n    var x0 = box[0], y0 = box[1], x1 = box[2], y1 = box[3], n;\n    transform = {scale: [x1 - x0 ? (x1 - x0) / (n - 1) : 1, y1 - y0 ? (y1 - y0) / (n - 1) : 1], translate: [x0, y0]};\n  } else {\n    box = topology.bbox;\n  }\n\n  var t = untransform(transform), box, key, inputs = topology.objects, outputs = {};\n\n  function quantizePoint(point) {\n    return t(point);\n  }\n\n  function quantizeGeometry(input) {\n    var output;\n    switch (input.type) {\n      case \"GeometryCollection\": output = {type: \"GeometryCollection\", geometries: input.geometries.map(quantizeGeometry)}; break;\n      case \"Point\": output = {type: \"Point\", coordinates: quantizePoint(input.coordinates)}; break;\n      case \"MultiPoint\": output = {type: \"MultiPoint\", coordinates: input.coordinates.map(quantizePoint)}; break;\n      default: return input;\n    }\n    if (input.id != null) output.id = input.id;\n    if (input.bbox != null) output.bbox = input.bbox;\n    if (input.properties != null) output.properties = input.properties;\n    return output;\n  }\n\n  function quantizeArc(input) {\n    var i = 0, j = 1, n = input.length, p, output = new Array(n); // pessimistic\n    output[0] = t(input[0], 0);\n    while (++i < n) if ((p = t(input[i], i))[0] || p[1]) output[j++] = p; // non-coincident points\n    if (j === 1) output[j++] = [0, 0]; // an arc must have at least two points\n    output.length = j;\n    return output;\n  }\n\n  for (key in inputs) outputs[key] = quantizeGeometry(inputs[key]);\n\n  return {\n    type: \"Topology\",\n    bbox: box,\n    transform: transform,\n    objects: outputs,\n    arcs: topology.arcs.map(quantizeArc)\n  };\n}\n","import {joinFeatures} from \"../geojson/join.features\";\nimport {lotivis_log, lotivis_log_once} from \"../shared/debug\";\nimport * as topojson from \"topojson-client\";\n\n/**\n *\n * @class MapExteriorBorderRenderer\n */\nexport class MapExteriorBorderRenderer {\n\n  /**\n   * Creates a new instance of MapExteriorBorderRenderer.\n   * @property mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    // if (!topojson) lotivis_log_once('Can\\'t find topojson lib.  Skip rendering of exterior border.');\n\n    /**\n     * Renders the exterior border of the presented geo json.\n     */\n    this.render = function () {\n      if (!topojson) {\n        lotivis_log('[lotivis]  Can\\'t find topojson library.');\n        return;\n      }\n      let geoJSON = mapChart.geoJSON;\n      if (!geoJSON) {\n        lotivis_log('[lotivis]  No GeoJSON to render.');\n        return;\n      }\n\n      let borders = joinFeatures(geoJSON.features);\n      if (!borders) {\n        return lotivis_log('[lotivis]  No borders to render.');\n      }\n\n      mapChart.svg\n        .selectAll('path')\n        .append('path')\n        .data(borders.features)\n        .enter()\n        .append('path')\n        .attr('d', mapChart.path)\n        .attr('class', 'lotivis-map-chart-exterior-borders')\n        .raise();\n    };\n  }\n}\n","import {extractLocationsFromDatasets} from \"../data.juggle/data.extract\";\n\n/**\n *\n * @param datasets\n * @returns {{features: [], type: string}}\n */\nexport function createGeoJSON(datasets) {\n  let locations = extractLocationsFromDatasets(datasets);\n  let rowsCount = Math.ceil(locations.length / 5);\n  let latSpan = 0.1;\n  let lngSpan = 0.1;\n  let features = [];\n\n  loop1: for (let rowIndex = 0; rowIndex < rowsCount; rowIndex++) {\n    for (let itemIndex = 0; itemIndex < 5; itemIndex++) {\n\n      if (locations.length === 0) break loop1;\n\n      let location = locations.shift();\n      let lat = (itemIndex + 1) * latSpan;\n      let lng = (rowIndex + 1) * -lngSpan;\n\n      // start down left, counterclockwise\n      let coordinates = [];\n      coordinates.push([lat + latSpan, lng + lngSpan]);\n      coordinates.push([lat + latSpan, lng]);\n      coordinates.push([lat, lng]);\n      coordinates.push([lat, lng + lngSpan]);\n      coordinates.push([lat + latSpan, lng + lngSpan]);\n\n      let feature = {\n        type: 'Feature',\n        id: location,\n        properties: {\n          id: location,\n          code: location,\n          location: location,\n        },\n        geometry: {\n          type: 'Polygon',\n          coordinates: [\n            coordinates\n          ]\n        }\n      };\n\n      features.push(feature);\n    }\n  }\n\n  let geoJSON = {\n    type: \"FeatureCollection\",\n    features: features\n  };\n\n  return geoJSON;\n}\n","import {hashCode} from \"../shared/hash\";\nimport {isValue} from \"../shared/value\";\nimport {LotivisConfig} from \"../shared/config\";\n\n/**\n *\n * @type {{}}\n */\nexport const MapChartConfig = {\n  width: 1000,\n  height: 1000,\n  margin: {\n    top: LotivisConfig.defaultMargin,\n    right: LotivisConfig.defaultMargin,\n    bottom: LotivisConfig.defaultMargin,\n    left: LotivisConfig.defaultMargin\n  },\n  isShowLabels: true,\n  geoJSON: null,\n  departmentsData: [],\n  excludedFeatureCodes: [],\n  drawRectangleAroundSelection: true,\n  sendsNotifications: true,\n  featureIDAccessor: function (feature) {\n    if (feature.id || feature.id === 0) return feature.id;\n    if (feature.properties && isValue(feature.properties.id)) return feature.properties.id;\n    if (feature.properties && isValue(feature.properties.code)) return Number(feature.properties.code);\n    if (feature.properties) { return hashCode(JSON.stringify(feature.properties)); }\n    return hashCode(JSON.stringify(feature));\n  },\n  featureNameAccessor: function (feature) {\n    if (isValue(feature.name)) return feature.name;\n    if (feature.properties && isValue(feature.properties.name)) return feature.properties.name;\n    if (feature.properties && isValue(feature.properties.nom)) return feature.properties.nom;\n    return LotivisConfig.unknown;\n  }\n};\n","/**\n *\n * @class MapBackgroundRenderer\n */\nexport class MapBackgroundRenderer {\n\n  /**\n   * Creates a new instance of MapBackgroundRenderer.\n   *\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    function onMouseClick() {\n      let controller = mapChart.datasetController;\n      if (!controller) return;\n\n      let filters = controller.filters.locations;\n      if (!filters || filters.length === 0) return;\n      mapChart.updateSensible = false;\n      controller.resetLocationFilters();\n      mapChart.updateSensible = true;\n\n      mapChart.selectionRenderer.render();\n    }\n\n    /**\n     * Appends a background rectangle.\n     */\n    this.render = function () {\n      // create a background rectangle for receiving mouse enter events\n      // in order to reset the location samples filter.\n      mapChart.svg\n        .append('rect')\n        .attr('class', 'lotivis-map-chart-background')\n        .attr('width', mapChart.config.width)\n        .attr('height', mapChart.config.height)\n        .attr('fill', 'white')\n        .on('click', onMouseClick);\n    };\n  }\n}\n","/**\n * @class Geometry\n */\nexport class Geometry {\n\n  /**\n   * Creates a new instance of Geometry.\n   * @param source\n   */\n  constructor(source) {\n    this.type = source.type;\n    this.coordinates = source.coordinates;\n  }\n}\n","import {Geometry} from \"./geometry\";\n\n/**\n *\n * @class Feature\n */\nexport class Feature {\n\n  constructor(source) {\n    this.type = source.type;\n    this.properties = source.properties;\n    this.geometry = new Geometry(source.geometry);\n  }\n}\n","import {Feature} from \"./feature\";\nimport {Geometry} from \"./geometry\";\n\n/**\n *\n * @class GeoJson\n */\nexport class GeoJson {\n\n  constructor(source) {\n    this.type = source.type;\n    this.features = [];\n\n    if (source.features) {\n      for (let index = 0; index < source.features.length; index++) {\n        let featureSource = source.features[index];\n        let feature = new Feature(featureSource);\n        this.features.push(feature);\n      }\n    } else {\n      this.properties = source.properties;\n      this.geometry = new Geometry(source.geometry);\n    }\n  }\n\n  getCenter() {\n    let allCoordinates = this.extractAllCoordinates();\n    console.log('allCoordinates.length: ' + allCoordinates.length);\n    let latitudeSum = 0;\n    let longitudeSum = 0;\n\n    allCoordinates.forEach(function (coordinates) {\n      latitudeSum += coordinates[1];\n      longitudeSum += coordinates[0];\n    });\n\n    return [\n      latitudeSum / allCoordinates.length,\n      longitudeSum / allCoordinates.length\n    ];\n  }\n\n  extractGeometryCollection() {\n    let geometryCollection = [];\n    if (this.type === 'Feature') {\n      geometryCollection.push(this.geometry);\n    } else if (this.type === 'FeatureCollection') {\n      this.features.forEach(feature => geometryCollection.push(feature.geometry));\n    } else if (this.type === 'GeometryCollection') {\n      this.geometries.forEach(geometry => geometryCollection.push(geometry));\n    } else {\n      throw new Error('The geoJSON is not valid.');\n    }\n    return geometryCollection;\n  }\n\n  extractAllCoordinates() {\n    let geometryCollection = this.extractGeometryCollection();\n    let coordinatesCollection = [];\n\n    geometryCollection.forEach(item => {\n\n      let coordinates = item.coordinates;\n      let type = item.type;\n\n      if (type === 'Point') {\n        console.log(\"Point: \" + coordinates.length);\n        coordinatesCollection.push(coordinates);\n      } else if (type === 'MultiPoint') {\n        console.log(\"MultiPoint: \" + coordinates.length);\n        coordinates.forEach(coordinate => coordinatesCollection.push(coordinate));\n      } else if (type === 'LineString') {\n        console.log(\"LineString: \" + coordinates.length);\n        coordinates.forEach(coordinate => coordinatesCollection.push(coordinate));\n      } else if (type === 'Polygon') {\n        coordinates.forEach(function (polygonCoordinates) {\n          polygonCoordinates.forEach(function (coordinate) {\n            coordinatesCollection.push(coordinate);\n          });\n        });\n      } else if (type === 'MultiLineString') {\n        coordinates.forEach(function (featureCoordinates) {\n          featureCoordinates.forEach(function (polygonCoordinates) {\n            polygonCoordinates.forEach(function (coordinate) {\n              coordinatesCollection.push(coordinate);\n            });\n          });\n        });\n      } else if (type === 'MultiPolygon') {\n        coordinates.forEach(function (featureCoordinates) {\n          featureCoordinates.forEach(function (polygonCoordinates) {\n            polygonCoordinates.forEach(function (coordinate) {\n              coordinatesCollection.push(coordinate);\n            });\n          });\n        });\n      } else {\n        throw new Error('The geoJSON is not valid.');\n      }\n    });\n\n    return coordinatesCollection;\n  }\n}\n","import {lotivis_log, lotivis_log_once} from \"../shared/debug\";\nimport {joinFeatures} from \"../geojson/join.features\";\n\n/**\n *\n * @class MapSelectionRenderer\n */\nexport class MapSelectionRenderer {\n\n  /**\n   * Creates a new instance of MapSelectionRenderer.\n   *\n   * @param mapChart The parental map.chart chart.\n   */\n  constructor(mapChart) {\n\n    if (!self.topojson) lotivis_log_once('Can\\'t find topojson lib.  Skip rendering of exterior border.');\n\n    /**\n     * Returns the collection of selected features.\n     *\n     * @returns {*[]}\n     */\n    function getSelectedFeatures() {\n\n      if (!mapChart.geoJSON) {\n        return null;\n      }\n\n      let allFeatures = mapChart.presentedGeoJSON.features;\n\n      if (!mapChart.datasetController) {\n        return null;\n      }\n\n      let filteredLocations = mapChart.datasetController.filters.locations;\n      let selectedFeatures = [];\n\n      for (let index = 0; index < allFeatures.length; index++) {\n        let feature = allFeatures[index];\n        let featureID = feature.lotivisId;\n\n        if (filteredLocations.indexOf(String(featureID)) !== -1) {\n          selectedFeatures.push(feature);\n        }\n      }\n\n      return selectedFeatures;\n    }\n\n    /**\n     * Renders the exterior border of the presented geo json.\n     */\n    this.render = function () {\n\n      if (!self.topojson) {\n        lotivis_log('[lotivis]  Can\\'t find topojson library.');\n        return;\n      }\n\n      // return;\n\n      mapChart.selectedFeatures = getSelectedFeatures();\n      mapChart.selectionBorderGeoJSON = joinFeatures(mapChart.selectedFeatures);\n      if (!mapChart.selectionBorderGeoJSON) {\n        return lotivis_log('[lotivis]  No selected features to render.');\n      }\n\n      mapChart.svg\n        .selectAll('.lotivis-map-chart-selection-border')\n        .remove();\n\n      mapChart.svg\n        .selectAll('.lotivis-map-chart-selection-border')\n        .append('path')\n        .attr('class', 'lotivis-map-chart-selection-border')\n        .data(mapChart.selectionBorderGeoJSON.features)\n        .enter()\n        .append('path')\n        .attr('d', mapChart.path)\n        .attr('class', 'lotivis-map-chart-selection-border')\n        .raise();\n    };\n\n    this.raise = function () {\n      mapChart.svg\n        .selectAll('.lotivis-map-chart-selection-border')\n        .raise();\n    };\n  }\n}\n","import {Chart} from '../chart/chart';\nimport {removeFeatures} from \"../geojson/remove.features\";\nimport {MapTooltipRenderer} from \"./map.tooltip.renderer\";\nimport {MapLegendRenderer} from \"./map.legend.renderer\";\nimport {MapLabelRenderer} from \"./map.label.renderer\";\nimport {MapDatasetRenderer} from \"./map.dataset.renderer\";\nimport {MapGeoJSONRenderer} from \"./map.geojson.renderer\";\nimport {MapExteriorBorderRenderer} from \"./map.exterior.border.renderer\";\nimport {createGeoJSON} from \"../geojson/create.geojson\";\nimport {MapChartConfig} from \"./map.chart.config\";\nimport {MapBackgroundRenderer} from \"./map.background.renderer\";\nimport {GeoJson} from \"../geojson/geojson\";\nimport {MapSelectionRenderer} from \"./map.selection.renderer\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * A component which renders a GeoJSON with d3.\n * @class MapChart\n * @extends Chart\n */\nexport class MapChart extends Chart {\n\n  /**\n   * Creates a new instance of MapChart.\n   * @param parent The parental component.\n   * @param config The configuration of the map.chart chart.\n   */\n  constructor(parent, config) {\n    super(parent, config);\n    // empty. constructor defined for documentation.\n  }\n\n  /**\n   * Initialize with default values.\n   */\n  initialize() {\n    let theConfig = this.config;\n    let margin;\n    margin = Object.assign({}, MapChartConfig.margin);\n    margin = Object.assign(margin, theConfig.margin || {});\n\n    let config = Object.assign({}, MapChartConfig);\n    this.config = Object.assign(config, this.config);\n    this.config.margin = margin;\n\n    this.projection = d3.geoMercator();\n    this.path = d3.geoPath().projection(this.projection);\n\n    this.initializeRenderers();\n  }\n\n  initializeRenderers() {\n    this.backgroundRenderer = new MapBackgroundRenderer(this);\n    this.geoJSONRenderer = new MapGeoJSONRenderer(this);\n    this.datasetRenderer = new MapDatasetRenderer(this);\n    this.exteriorBorderRenderer = new MapExteriorBorderRenderer(this);\n    this.labelRenderer = new MapLabelRenderer(this);\n    this.legendRenderer = new MapLegendRenderer(this);\n    this.selectionRenderer = new MapSelectionRenderer(this);\n    this.tooltipRenderer = new MapTooltipRenderer(this);\n  }\n\n  remove() {\n    if (!this.svg) return;\n    this.svg.remove();\n  }\n\n  precalculate() {\n    this.renderSVG();\n    if (!this.datasetController) return;\n    this.dataview = this.datasetController.getLocationDataview();\n    if (this.geoJSON) return;\n    let geoJSON = createGeoJSON(this.datasetController.datasets);\n    this.setGeoJSON(geoJSON);\n  }\n\n  draw() {\n    lotivis_log('[lotivis] ', this.constructor.name, 'draw');\n    if (!this.geoJSON) {\n      return lotivis_log('[lotivis]  No GeoJSON to render.');\n    }\n    this.backgroundRenderer.render();\n    this.exteriorBorderRenderer.render();\n    this.geoJSONRenderer.render();\n    this.legendRenderer.render();\n    this.datasetRenderer.render();\n    this.labelRenderer.render();\n    this.tooltipRenderer.raise();\n    this.selectionRenderer.render();\n  }\n\n  /**\n   *\n   */\n  renderSVG() {\n    this.svg = this.element\n      .append('svg')\n      .attr('id', this.svgSelector)\n      .attr('viewBox', `0 0 ${this.config.width} ${this.config.height}`);\n  }\n\n  /**\n   * Sets the size of the projection to fit the given geo json.\n   * @param geoJSON\n   */\n  zoomTo(geoJSON) {\n    this.projection.fitSize([this.config.width, this.config.height], geoJSON);\n  }\n\n  /**\n   * Tells this map.chart chart that the given feature was selected with the mouse.\n   * @param event The mouse event.\n   * @param feature The feature.\n   */\n  onSelectFeature(event, feature) {\n\n\n  }\n\n  /**\n   * Sets the presented geo json.\n   * @param newGeoJSON\n   */\n  setGeoJSON(newGeoJSON) {\n    if (typeof newGeoJSON === 'object' && newGeoJSON.prototype === 'GeoJSON') {\n      this.geoJSON = newGeoJSON;\n    } else {\n      this.geoJSON = new GeoJson(newGeoJSON);\n    }\n    this.presentedGeoJSON = this.geoJSON;\n    this.geoJSONDidChange();\n  }\n\n  /**\n   * Tells the receiving map.chart chart that its `geoJSON` property did change.\n   */\n  geoJSONDidChange() {\n    if (!this.geoJSON) return;\n    // precalculate the center of each feature\n    this.geoJSON.features.forEach((feature) => feature.center = d3.geoCentroid(feature));\n\n    if (this.config.excludedFeatureCodes) {\n      this.presentedGeoJSON = removeFeatures(this.geoJSON, this.config.excludedFeatureCodes);\n    }\n\n    // precalculate lotivis feature ids\n\n    let feature;\n    for (let i = 0; i < this.presentedGeoJSON.features.length; i++) {\n      feature = this.presentedGeoJSON.features[i];\n      this.presentedGeoJSON.features[i].lotivisId = this.config.featureIDAccessor(feature);\n    }\n\n    this.zoomTo(this.geoJSON);\n    this.draw();\n\n    // this.backgroundRenderer.render();\n    // this.exteriorBorderRenderer.render();\n    // this.geoJSONRenderer.render();\n  }\n}\n","import {Checkbox} from \"../shared.components/checkbox\";\nimport {UrlParameters} from \"../shared/url.parameters\";\nimport {SettingsPopup} from \"../shared.components/settings.popup\";\n\n/**\n * A popup presenting a settings panel for a map.chart chart.\n *\n * @class MapChartSettingsPopup\n * @extends SettingsPopup\n */\nexport class MapChartSettingsPopup extends SettingsPopup {\n\n  /**\n   * Injects the elements of the settings panel.\n   * @override\n   */\n  inject() {\n    super.inject();\n    let container = this.row.append('div').classed('col-12', true);\n    this.showLabelsCheckbox = new Checkbox(container);\n    this.showLabelsCheckbox.setText('Labels');\n    this.showLabelsCheckbox.onClick = function (checked) {\n      this.mapChart.config.showLabels = checked;\n      this.mapChart.update();\n      UrlParameters.getInstance().setWithoutDeleting('map-chart-show-labels', checked);\n    }.bind(this);\n  }\n\n  /**\n   * Tells the popup that it is about to be presented.\n   * @override\n   */\n  willShow() {\n    this.showLabelsCheckbox.setChecked(this.mapChart.config.showLabels);\n    if (!this.mapChart.datasetController) {\n      this.showLabelsCheckbox.disable();\n    }\n  }\n}\n","import {MapChart} from \"../map.chart/map.chart\";\nimport {MapChartSettingsPopup} from \"./map.chart.settings.popup\";\nimport {ChartCard} from \"../shared.components/chart.card\";\nimport {downloadImage} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\n\n/**\n * A lotivis card containing a location chart.\n * @class MapChartCard\n * @extends ChartCard\n */\nexport class MapChartCard extends ChartCard {\n\n  /**\n   * Creates a new instance of MapChartCard.\n   * @param {Component|String} parent The parental component.\n   * @param config The config of the map.chart chart.\n   */\n  constructor(parent, config) {\n    super(parent || 'map-chart-card', config);\n  }\n\n  /**\n   * Creates and injects the map.chart chart.\n   */\n  injectChart() {\n    this.chartID = this.selector + '-chart';\n    this.body.attr('id', this.chartID);\n    this.chart = new MapChart(this.chartID, this.config);\n  }\n\n  /**\n   * Creates and downloads a screenshot from the chart.\n   * @override\n   */\n  screenshotButtonAction() {\n    let filename = 'Unknown';\n    if (this.chart && this.chart.datasetController) {\n      filename = this.chart.datasetController.getFilename();\n    }\n    let downloadFilename = createDownloadFilename(filename, `map-chart`);\n    downloadImage(this.chart.svgSelector, downloadFilename);\n  }\n\n  /**\n   * Triggered when the more button is pushed.\n   */\n  presentSettingsPopupAction() {\n    let bodyElement = d3.select('body');\n    let button = document.getElementById(this.moreButton.selector);\n    let settingsPopup = new MapChartSettingsPopup(bodyElement);\n    settingsPopup.mapChart = this.chart;\n    settingsPopup.showUnder(button, 'right');\n  }\n}\n","import {DatasetsController} from \"./datasets.controller\";\n\nDatasetsController.prototype.getCached = function (type) {\n  return this.cache.getDataView(\n    type,\n    this.filters.locations,\n    this.filters.dates,\n    this.filters.labels\n  );\n};\n\nDatasetsController.prototype.setCached = function (dataview, type) {\n  return this.cache.setDataView(\n    dataview,\n    type,\n    this.filters.locations,\n    this.filters.dates,\n    this.filters.labels\n  );\n};\n","import {DatasetsController} from \"../datasets.controller/datasets.controller\";\nimport {copy} from \"../shared/copy\";\nimport {\n  extractDatesFromDatasets,\n  extractEarliestDateWithValue,\n  extractLabelsFromDatasets,\n  extractLatestDateWithValue\n} from \"../data.juggle/data.extract\";\nimport {combineByDate} from \"../data.juggle/data.combine\";\nimport {sumOfValues} from \"../data.juggle/data.sum\";\nimport {flatDataset} from \"../data.juggle/data.flat\";\nimport \"../datasets.controller/datasets.controller.cache\";\n\n/**\n *\n * @param dataset\n * @param dateAccess\n * @returns {{}}\n */\nfunction createPlotDataset(dataset, dateAccess) {\n\n  let newDataset = {};\n  let data = copy(dataset.data);\n  let firstDate = extractEarliestDateWithValue(data, dateAccess) || 0;\n  let lastDate = extractLatestDateWithValue(data, dateAccess) || 0;\n  let flatData = flatDataset(dataset);\n\n  newDataset.dataset = dataset.label;\n  newDataset.label = dataset.label;\n  newDataset.stack = dataset.stack;\n  newDataset.firstDate = firstDate;\n  newDataset.lastDate = lastDate;\n  newDataset.sum = sumOfValues(flatData);\n  // newDataset.min = d3.min();\n\n  // dataView.max = d3.max(flatData, function (stack) {\n  //   return d3.max(stack, function (series) {\n  //     return d3.max(series.map(item => item['1']));\n  //   });\n  // });\n\n  newDataset.data = combineByDate(data)\n    .sort((left, right) => left.dateNumeric - right.dateNumeric)\n    .filter(item => (item.value || 0) > 0);\n\n  return newDataset;\n}\n\n/**\n * Returns a new generated date.chart.plot.chart samples view for the current enabled samples of dataset of this controller.\n */\nDatasetsController.prototype.getPlotDataview = function () {\n\n  let cachedDataView = this.getCached('date.chart.plot.chart');\n  if (cachedDataView) {\n    return cachedDataView;\n  }\n\n  let dateAccess = this.dateAccess;\n  let enabledDatasets = this.filteredDatasets();\n  let dataview = {datasets: []};\n\n  dataview.dates = extractDatesFromDatasets(enabledDatasets).sort();\n  dataview.labels = extractLabelsFromDatasets(enabledDatasets);\n\n  dataview.firstDate = dataview.dates.first();\n  dataview.lastDate = dataview.dates.last();\n\n  enabledDatasets.forEach(function (dataset) {\n    let newDataset = createPlotDataset(dataset, dateAccess);\n    let firstIndex = dataview.dates.indexOf(newDataset.firstDate);\n    let lastIndex = dataview.dates.indexOf(newDataset.lastDate);\n    newDataset.duration = lastIndex - firstIndex;\n    dataview.datasets.push(newDataset);\n  });\n\n  dataview.labelsCount = dataview.datasets.length;\n  dataview.max = d3.max(dataview.datasets, function (dataset) {\n    return d3.max(dataset.data, function (item) {\n      return item.value;\n    });\n  });\n\n  this.setCached(dataview, 'plot');\n\n  return dataview;\n};\n","import {LotivisConfig} from \"../shared/config\";\n\n/**\n * Enumeration of available style types of a plot chart.\n */\nexport const PlotChartType = {\n  gradient: 'gradient',\n  fraction: 'fraction'\n};\n\n/**\n * Enumeration of sorts available in the date.chart.plot.chart chart.\n */\nexport const PlotChartSort = {\n  none: 'none',\n  alphabetically: 'alphabetically',\n  duration: 'duration',\n  intensity: 'intensity',\n  firstDate: 'firstDate'\n};\n\n/**\n *\n * @type {{margin: {top: number, left: number, bottom: number, right: number}, highColor: string, showTooltip: boolean, lowColor: string, sort: string, type: string, showLabels: boolean, numberFormat: Intl.NumberFormat, width: number, lineHeight: number, drawGrid: boolean, radius: number, height: number}}\n */\nexport const defaultPlotChartConfig = {\n  width: 1000,\n  height: 600,\n  margin: {\n    top: LotivisConfig.defaultMargin,\n    right: LotivisConfig.defaultMargin,\n    bottom: LotivisConfig.defaultMargin,\n    left: LotivisConfig.defaultMargin\n  },\n  lineHeight: 28,\n  radius: 23,\n  showLabels: true,\n  drawGrid: true,\n  showTooltip: true,\n  sendsNotifications: true,\n  lowColor: 'rgb(184, 233, 148)',\n  highColor: 'rgb(0, 122, 255)',\n  sort: PlotChartSort.none,\n  type: PlotChartType.gradient,\n  numberFormat: Intl.NumberFormat('de-DE', {\n    maximumFractionDigits: 3\n  }),\n};\n","/**\n * Draws the axis on the timm plot chart.\n * @class PlotAxisRenderer\n */\nexport class PlotAxisRenderer {\n\n  /**\n   * Creates a new instance of PlotAxisRenderer.\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    /**\n     * Appends axis on the top, left and bottom of the date.chart.plot.chart chart.\n     */\n    this.renderAxis = function () {\n      let margin = plotChart.config.margin;\n\n      // top\n      plotChart.svg\n        .append(\"g\")\n        .call(d3.axisTop(plotChart.xChart))\n        .attr(\"transform\", () => `translate(0,${margin.top})`);\n\n      // left\n      plotChart.svg\n        .append(\"g\")\n        .call(d3.axisLeft(plotChart.yChart))\n        .attr(\"transform\", () => `translate(${margin.left},0)`);\n\n      // bottom\n      plotChart.svg\n        .append(\"g\")\n        .call(d3.axisBottom(plotChart.xChart))\n        .attr(\"transform\", () => `translate(0,${plotChart.height - margin.bottom})`);\n\n    };\n  }\n}\n","import {LotivisConfig} from \"../shared/config\";\n\n/**\n * Appends and updates the tooltip of a date.chart.plot.chart chart.\n * @class PlotTooltipRenderer\n * @see PlotChart\n */\nexport class PlotTooltipRenderer {\n\n  /**\n   * Creates a new instance of PlotTooltipRenderer.\n   *\n   * @constructor\n   * @param plotChart\n   */\n  constructor(plotChart) {\n\n    const tooltip = plotChart\n      .element\n      .append('div')\n      .attr('class', 'lotivis-tooltip')\n      .attr('rx', 5) // corner radius\n      .attr('ry', 5)\n      .style('opacity', 0);\n\n    /**\n     * Returns the HTML content for the given dataset.\n     * @param dataset The dataset to represent in HTML.\n     */\n    function getHTMLContentForDataset(dataset) {\n      let components = [];\n\n      let sum = dataset.data.map(item => item.value).reduce((acc, next) => +acc + +next, 0);\n      let formatted = plotChart.config.numberFormat.format(sum);\n\n      components.push('Label: ' + dataset.label);\n      components.push('');\n      components.push('Start: ' + dataset.firstDate);\n      components.push('End: ' + dataset.lastDate);\n      components.push('');\n      components.push('Items: ' + formatted);\n      components.push('');\n\n      let filtered = dataset.data.filter(item => item.value !== 0);\n      for (let index = 0; index < filtered.length; index++) {\n        let entry = filtered[index];\n        let formatted = plotChart.config.numberFormat.format(entry.value);\n        components.push(`${entry.date}: ${formatted}`);\n      }\n\n      return components.join('<br/>');\n    }\n\n    /**\n     * Returns the pixel position for to tooltip to display it aligned to the left of a bar.\n     * @param dataset The dataset to display the tooltip for.\n     * @param factor The factor of the view box of the SVG.\n     * @param offset The offset of the chart.\n     * @returns {*} The left pixel position for the tooltip.\n     */\n    function getTooltipLeftForDataset(dataset, factor, offset) {\n      let left = plotChart.xChart(dataset.firstDate);\n      left *= factor;\n      left += offset[0];\n      return left;\n    }\n\n    /**\n     * Presents the tooltip for the given dataset.\n     *\n     * @param event The mouse event.\n     * @param dataset The dataset.\n     */\n    this.showTooltip = function (event, dataset) {\n      if (!plotChart.config.showTooltip) return;\n      tooltip.html(getHTMLContentForDataset(dataset));\n\n      // position tooltip\n      let tooltipHeight = Number(tooltip.style('height').replace('px', ''));\n      let factor = plotChart.getElementEffectiveSize()[0] / plotChart.config.width;\n      let offset = plotChart.getElementPosition();\n\n      let top = plotChart.yChart(dataset.label) * factor;\n      top += offset[1];\n\n      if ((plotChart.yChart(dataset.label) - plotChart.config.margin.top) <= (plotChart.graphHeight / 2)) {\n        top += (plotChart.config.lineHeight * factor) + LotivisConfig.tooltipOffset;\n      } else {\n        top -= tooltipHeight + 20; // subtract padding\n        top -= LotivisConfig.tooltipOffset;\n      }\n\n      let left = getTooltipLeftForDataset(dataset, factor, offset);\n\n      tooltip\n        .style('left', left + 'px')\n        .style('top', top + 'px')\n        .style('opacity', 1);\n    };\n\n    /**\n     * Hides the tooltip by setting its opacity to 0.\n     */\n    this.hideTooltip = function () {\n      let controller = plotChart.datasetController;\n      let filters = controller.datasetFilters;\n\n      if (filters && filters.length !== 0) {\n        controller.resetFilters();\n      }\n\n      if (+tooltip.style('opacity') === 0) return;\n      tooltip.style('opacity', 0);\n    };\n  }\n}\n","import {hashCode} from \"../shared/hash\";\n\n/**\n *\n * @class PlotLabelRenderer\n */\nexport class PlotLabelRenderer {\n\n  /**\n   * Creates a new instance of PlotLabelRenderer.\n   *\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    /**\n     * Draws the labels on the bars on the date.chart.plot.chart chart.\n     */\n    this.renderLabels = function () {\n      if (!plotChart.config.showLabels) return;\n\n      let xBandwidth = plotChart.yChart.bandwidth();\n      let xChart = plotChart.xChart;\n\n      plotChart.labels = plotChart\n        .barsData\n        .append('g')\n        .attr('transform', `translate(0,${(xBandwidth / 2) + 4})`)\n        .append('text')\n        .attr('class', 'lotivis-plot-label')\n        .attr(\"id\", (d) => 'rect-' + hashCode(d.label))\n        .attr(\"x\", (d) => xChart(d.firstDate) + (xBandwidth / 2))\n        .attr(\"y\", (d) => plotChart.yChart(d.label))\n        .attr(\"width\", (d) => xChart(d.lastDate) - xChart(d.firstDate) + xBandwidth)\n        .text(function (dataset) {\n          if (dataset.sum === 0) return;\n          let formatted = plotChart.config.numberFormat.format(dataset.sum);\n          return `${dataset.duration + 1} years, ${formatted} items`;\n        });\n    };\n  }\n}\n","/**\n * Draws a grid on the date.chart.plot.chart chart.\n *\n * @class PlotGridRenderer\n */\nexport class PlotGridRenderer {\n\n  /**\n   * Creates a new instance of TimePlotGridRenderer.\n   *\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    /**\n     * Adds a grid to the chart.\n     */\n    this.render = function () {\n\n      if (!plotChart.config.drawGrid) return;\n\n      plotChart.svg\n        .append('g')\n        .attr('class', 'lotivis-plot-grid lotivis-plot-grid-x')\n        .attr('transform', 'translate(0,' + (plotChart.preferredHeight - plotChart.config.margin.bottom) + ')')\n        .call(plotChart.xAxisGrid);\n\n      plotChart.svg\n        .append('g')\n        .attr('class', 'lotivis-plot-grid lotivis-plot-grid-y')\n        .attr('transform', `translate(${plotChart.config.margin.left},0)`)\n        .call(plotChart.yAxisGrid);\n\n    };\n  }\n}\n","/**\n * Draws the background of a time plot chart.\n */\nexport class PlotBackgroundRenderer {\n\n  /**\n   *\n   * @param plotChart\n   */\n  constructor(plotChart) {\n\n    this.render = function () {\n      plotChart.svg\n        .append('rect')\n        .attr('width', plotChart.width || plotChart.config.width)\n        .attr('height', plotChart.height)\n        .attr('class', `lotivis-plot-chart-background`)\n        .on('click', (event, some) => {\n          plotChart.datasetController.resetLabelFilters();\n        });\n    };\n  }\n}\n","import {createIDFromDataset} from \"../shared/selector\";\n\n/**\n * Draws the background / selection bars of a time plot chart.\n *\n * @class PlotChartHoverBarsRenderer\n */\nexport class PlotChartHoverBarsRenderer {\n\n  /**\n   * Creates a new instance of PlotAxisRenderer.\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    function createID(dataset) {\n      return `lotivis-plot-chart-hover-bar-id-${createIDFromDataset(dataset)}`;\n    }\n\n    function hideAll() {\n      plotChart.svg\n        .selectAll('.lotivis-plot-chart-hover-bar')\n        .attr(\"opacity\", 0);\n    };\n\n    /**\n     * To be called when the mouse enters a bar on the date.chart.plot.chart chart.\n     * @param event The mouse event.\n     * @param dataset The represented dataset.\n     */\n    function mouseEnter(event, dataset) {\n      hideAll();\n\n      let id = createID(dataset);\n      plotChart\n        .svg\n        .select(`#${id}`)\n        .attr(\"opacity\", 0.3);\n\n      plotChart.tooltipRenderer.showTooltip.bind(plotChart)(event, dataset);\n      // plotChart.onSelectDataset(event, dataset);\n    }\n\n    /**\n     * To be called when the mouse leaves a bar on the date.chart.plot.chart chart.\n     * @param event The mouse event.\n     * @param dataset The represented dataset.\n     */\n    function mouseOut(event, dataset) {\n      hideAll();\n      plotChart.tooltipRenderer.hideTooltip.bind(plotChart)(event, dataset);\n\n      if (event.buttons === 1) {\n        mouseClick(event, dataset);\n      }\n    }\n\n    function mouseClick(event, dataset) {\n      if (plotChart.config.sendsNotifications) {\n        plotChart.makeUpdateInsensible();\n        plotChart.datasetController.toggleDataset(dataset.label);\n        plotChart.makeUpdateSensible();\n      }\n      plotChart.selectionRenderer.update();\n    }\n\n    /**\n     * Draws the bars.\n     */\n    this.render = function () {\n      let datasets = plotChart.dataView.datasets;\n      let graphWidth = plotChart.graphWidth;\n\n      plotChart.backgrounBarsData = plotChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"g\")\n        .data(datasets)\n        .enter();\n\n      plotChart.backgrounBars = plotChart.backgrounBarsData\n        .append(\"rect\")\n        .attr(\"id\", (d) => createID(d))\n        .attr('class', 'lotivis-plot-chart-hover-bar')\n        .attr(`opacity`, 0)\n        .attr(\"x\", plotChart.config.margin.left)\n        .attr(\"y\", (d) => plotChart.yChart(d.label))\n        .attr(\"height\", plotChart.yChart.bandwidth())\n        .attr(\"width\", graphWidth)\n        .on('mouseenter', mouseEnter)\n        .on('mouseout', mouseOut)\n        .on('click', mouseClick);\n\n    };\n  }\n}\n","import {createIDFromDataset} from \"../shared/selector\";\nimport {flatDatasets} from \"../data.juggle/data.flat\";\nimport {combineByDate} from \"../data.juggle/data.combine\";\nimport {Color} from \"../shared/color\";\n\n/**\n * Draws the bar on the time plot chart.\n * @class PlotBarsFractionsRenderer\n */\nexport class PlotBarsFractionsRenderer {\n\n  /**\n   * Creates a new instance of PlotAxisRenderer.\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    // constant for the radius of the drawn bars.\n    const radius = 6;\n\n    /**\n     * To be called when the mouse enters a bar on the date.chart.plot.chart chart.\n     * @param event The mouse event.\n     * @param dataset The represented dataset.\n     */\n    function mouseEnter(event, dataset) {\n      // plotChart.tooltipRenderer.showTooltip.bind(plotChart)(event, dataset);\n      // plotChart.onSelectDataset(event, dataset);\n    }\n\n    /**\n     * To be called when the mouse leaves a bar on the date.chart.plot.chart chart.\n     * @param event The mouse event.\n     * @param dataset The represented dataset.\n     */\n    function mouseOut(event, dataset) {\n      // plotChart.tooltipRenderer.hideTooltip.bind(plotChart)(event, dataset);\n    }\n\n    /**\n     * Draws the bars.\n     */\n    this.renderBars = function () {\n      let datasets = plotChart.dataView.datasets;\n      let max = plotChart.dataView.max;\n      let flatData = flatDatasets(datasets);\n      flatData = combineByDate(flatData);\n\n      plotChart.barsData = plotChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"g\")\n        .data(flatData)\n        .enter();\n\n      let colors = Color.mapColors(max);\n\n      plotChart.bars = plotChart.barsData\n        .append(\"rect\")\n        .attr(\"id\", (d) => `lotivis-plot-bar-${createIDFromDataset(d)}`)\n        .attr('class', 'lotivis-plot-bar')\n        .attr(`fill`, (d) => colors(d.value))\n        .attr(\"rx\", radius)\n        .attr(\"ry\", radius)\n        .attr(\"x\", (d) => plotChart.xChart(d.date))\n        .attr(\"y\", (d) => plotChart.yChartPadding(d.label))\n        .attr(\"height\", plotChart.yChartPadding.bandwidth())\n        .attr(\"id\", (d) => 'rect-' + createIDFromDataset(d))\n        .on('mouseenter', mouseEnter)\n        .on('mouseout', mouseOut)\n        .attr(\"width\", plotChart.xChart.bandwidth());\n    };\n  }\n}\n","import {Color} from \"../shared/color\";\nimport {createIDFromDataset} from \"../shared/selector\";\n\n/**\n * Calculates and creates the gradients for the bars of a date.chart.plot.chart chart.\n *\n * @class PlotBarsGradientCreator\n */\nexport class PlotBarsGradientCreator {\n\n  /**\n   * Creates a new instance of PlotBarsGradientCreator.\n   *\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n    this.plotChart = plotChart;\n    this.colorGenerator = Color.plotColor(1);\n  }\n\n  /**\n   * Creates the gradient for the bar representing the given dataset.\n   * @param dataset The dataset to represent.\n   */\n  createGradient(dataset) {\n\n    let max = this.plotChart.dataView.max;\n    let gradient = this.plotChart.definitions\n      .append(\"linearGradient\")\n      .attr(\"id\", 'lotivis-plot-gradient-' + createIDFromDataset(dataset))\n      .attr(\"x1\", \"0%\")\n      .attr(\"x2\", \"100%\")\n      .attr(\"y1\", \"0%\")\n      .attr(\"y2\", \"0%\");\n\n    let data = dataset.data;\n    let count = data.length;\n    let latestDate = dataset.lastDate;\n    let duration = dataset.duration;\n\n    if (!data || data.length === 0) return;\n\n    if (duration === 0) {\n\n      let item = data[0];\n      let value = item.value;\n      let opacity = value / max;\n\n      gradient\n        .append(\"stop\")\n        .attr(\"offset\", `100%`)\n        .attr(\"stop-color\", this.colorGenerator(opacity));\n\n    } else {\n\n      for (let index = 0; index < count; index++) {\n\n        let item = data[index];\n        let date = item.date;\n        let opacity = item.value / max;\n\n        let dateDifference = latestDate - date;\n        let value = (dateDifference / duration);\n        let datePercentage = (1 - value) * 100;\n\n        gradient\n          .append(\"stop\")\n          .attr(\"offset\", `${datePercentage}%`)\n          .attr(\"stop-color\", this.colorGenerator(opacity));\n\n      }\n    }\n  }\n}\n","import {PlotBarsGradientCreator} from \"./plot.bars.gradient.creator\";\nimport {createIDFromDataset} from \"../shared/selector\";\n\n/**\n * Draws the bar on the date.chart.plot.chart chart.\n * @class PlotBarsGradientRenderer\n */\nexport class PlotBarsGradientRenderer {\n\n  /**\n   * Creates a new instance of PlotAxisRenderer.\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    // constant for the radius of the drawn bars.\n    const radius = 6;\n\n    this.gradientCreator = new PlotBarsGradientCreator(plotChart);\n    plotChart.definitions = plotChart.svg.append(\"defs\");\n\n    /**\n     * Draws the bars.\n     */\n    this.renderBars = function () {\n      let datasets = plotChart.dataView.datasets;\n      plotChart.definitions = plotChart.svg.append(\"defs\");\n\n      for (let index = 0; index < datasets.length; index++) {\n        this.gradientCreator.createGradient(datasets[index]);\n      }\n\n      plotChart.barsData = plotChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"g\")\n        .data(datasets)\n        .enter();\n\n      plotChart.bars = plotChart.barsData\n        .append(\"rect\")\n        .attr(\"fill\", (d) => `url(#lotivis-plot-gradient-${createIDFromDataset(d)})`)\n        .attr('class', 'lotivis-plot-bar')\n        .attr(\"rx\", radius)\n        .attr(\"ry\", radius)\n        .attr(\"x\", (d) => plotChart.xChart((d.duration < 0) ? d.lastDate : d.firstDate || 0))\n        .attr(\"y\", (d) => plotChart.yChartPadding(d.label))\n        .attr(\"height\", plotChart.yChartPadding.bandwidth())\n        .attr(\"id\", (d) => 'lotivis-plot-rect-' + createIDFromDataset(d))\n        .attr(\"width\", function (data) {\n          if (!data.firstDate || !data.lastDate) return 0;\n          return plotChart.xChart(data.lastDate) - plotChart.xChart(data.firstDate) + plotChart.xChart.bandwidth();\n        }.bind(this));\n    };\n  }\n}\n","import {hashCode} from \"../shared/hash\";\n\n/**\n *\n * @class PlotLabelsFractionsRenderer\n */\nexport class PlotLabelsFractionsRenderer {\n\n  /**\n   * Creates a new instance of PlotLabelRenderer.\n   *\n   * @constructor\n   * @param plotChart The parental date.chart.plot.chart chart.\n   */\n  constructor(plotChart) {\n\n    /**\n     * Draws the labels on the bars on the date.chart.plot.chart chart.\n     */\n    this.renderLabels = function () {\n      if (!plotChart.config.showLabels) return;\n\n      let xBandwidth = plotChart.yChart.bandwidth();\n\n      plotChart.labels = plotChart\n        .barsData\n        .append('g')\n        .attr('transform', `translate(0,${(xBandwidth / 2) + 4})`)\n        .append('text')\n        .attr('class', 'lotivis-plot-label')\n        .attr(\"id\", (d) => 'rect-' + hashCode(d.label))\n        .attr(\"x\", (d) => plotChart.xChart(d.date) + 4)\n        .attr(\"y\", (d) => plotChart.yChart(d.label))\n        .text(function (dataset) {\n          if (dataset.sum === 0) return;\n          let formatted = plotChart.config.numberFormat.format(dataset.value);\n          return `${formatted}`;\n        });\n    };\n  }\n}\n","import {createIDFromDataset} from \"../shared/selector\";\n\n/**\n * Draws the selection rectangles of a plot chart.\n *\n * @class PlotChartSelectionRenderer\n */\nexport class PlotChartSelectionRenderer {\n\n  /**\n   * Creates a new instance of PlotChartSelectionRenderer.\n   *\n   * @constructor\n   * @param plotChart The parental plot chart.\n   */\n  constructor(plotChart) {\n\n    function createID(dataset) {\n      return `lotivis-plot-chart-selection-rect-id-${createIDFromDataset(dataset)}`;\n    }\n\n    function hideAll() {\n      plotChart.svg\n        .selectAll(`.lotivis-plot-chart-selection-rect`)\n        .attr(\"opacity\", 0);\n    }\n\n    /**\n     * Draws the bars.\n     */\n    this.render = function () {\n      let datasets = plotChart.dataView.datasets;\n      let graphWidth = plotChart.graphWidth;\n\n      plotChart.selectionBarsData = plotChart\n        .svg\n        .append(\"g\")\n        .selectAll(\"g\")\n        .data(datasets)\n        .enter();\n\n      plotChart.selectionBars = plotChart\n        .selectionBarsData\n        .append(\"rect\")\n        .attr(\"id\", (d) => createID(d))\n        .attr('class', 'lotivis-plot-chart-selection-rect')\n        .attr(`opacity`, 0)\n        .attr(\"x\", plotChart.config.margin.left)\n        .attr(\"y\", (d) => plotChart.yChart(d.label))\n        .attr(\"height\", plotChart.yChart.bandwidth())\n        .attr(\"width\", graphWidth);\n\n    };\n\n\n    this.update = function () {\n      let selectedLabels = getSelectedLabels();\n      plotChart\n        .svg\n        .selectAll(`.lotivis-plot-chart-selection-rect`)\n        .attr(`opacity`, dataset => selectedLabels.includes(dataset.label) ? 0.3 : 0);\n      console.log('selectedLabels', selectedLabels);\n    };\n\n    function getSelectedLabels() {\n      console.log('plotChart.datasetController.filters', plotChart.datasetController.filters);\n      return plotChart.datasetController.filters.labels || [];\n    }\n  }\n}\n","import {Chart} from \"../chart/chart\";\nimport \"../dataview/dataview.plot\";\nimport {defaultPlotChartConfig, PlotChartSort, PlotChartType} from \"./plot.chart.config\";\nimport {PlotAxisRenderer} from \"./plot.axis.renderer\";\nimport {PlotTooltipRenderer} from \"./plot.tooltip.renderer\";\nimport {PlotLabelRenderer} from \"./plot.label.renderer\";\nimport {PlotGridRenderer} from \"./plot.grid.renderer\";\nimport {PlotBackgroundRenderer} from \"./plot.background.renderer\";\nimport {PlotChartHoverBarsRenderer} from \"./plot.chart.hover.bars.renderer\";\nimport {PlotBarsFractionsRenderer} from \"./plot.bars.fractions.renderer\";\nimport {PlotBarsGradientRenderer} from \"./plot.bars.gradient.renderer\";\nimport {PlotLabelsFractionsRenderer} from \"./plot.labels.fractions.renderer\";\nimport {PlotChartSelectionRenderer} from \"./plot.chart.selection.renderer\";\n\n/**\n * A lotivis date.chart.plot.chart chart.\n *\n * @class PlotChart\n * @extends Chart\n */\nexport class PlotChart extends Chart {\n\n  /**\n   * Initializes this diachronic chart by setting the default values.\n   */\n  initialize() {\n\n    let theConfig = this.config;\n    let margin;\n    margin = Object.assign({}, defaultPlotChartConfig.margin);\n    margin = Object.assign(margin, this.config.margin);\n\n    let config = Object.assign({}, defaultPlotChartConfig);\n    this.config = Object.assign(config, this.config);\n    this.config.margin = margin;\n\n    this.createSVG();\n    this.backgroundRenderer = new PlotBackgroundRenderer(this);\n    this.axisRenderer = new PlotAxisRenderer(this);\n    this.gridRenderer = new PlotGridRenderer(this);\n    this.selectionRenderer = new PlotChartSelectionRenderer(this);\n    this.hoverBarsRenderer = new PlotChartHoverBarsRenderer(this);\n\n    this.barsFractionsRenderer = new PlotBarsFractionsRenderer(this);\n    this.barsRenderer = new PlotBarsGradientRenderer(this);\n\n    this.labelsRenderer = new PlotLabelRenderer(this);\n    this.labelsFractionRenderer = new PlotLabelsFractionsRenderer(this);\n\n    this.tooltipRenderer = new PlotTooltipRenderer(this);\n  }\n\n  /**\n   * Appends the svg element to the parental element.\n   */\n  createSVG() {\n    this.svg = this.element\n      .append('svg')\n      .attr('id', this.svgSelector)\n      .attr('class', 'lotivis-chart-svg')\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr(\"viewBox\", `0 0 ${this.config.width} ${this.config.height}`);\n  }\n\n  /**\n   * Removes any (old) shared.components from the svg.\n   */\n  remove() {\n    this.svg.selectAll('*').remove();\n  }\n\n  /**\n   *\n   */\n  precalculate() {\n\n    if (this.datasetController) {\n      this.dataView = this.datasetController.getPlotDataview();\n    } else {\n      this.dataView = {datasets: [], barsCount: 0};\n    }\n\n    this.sortDatasets();\n\n    let margin = this.config.margin;\n    let barsCount = this.dataView.labelsCount || 0;\n\n    this.graphWidth = this.config.width - margin.left - margin.right;\n    this.graphHeight = (barsCount * this.config.lineHeight);\n    this.height = this.graphHeight + margin.top + margin.bottom;\n    this.preferredHeight = this.height;\n\n    this.svg\n      .attr(\"viewBox\", `0 0 ${this.config.width} ${this.preferredHeight}`);\n\n    this.createScales();\n  }\n\n  /**\n   * Creates and renders the chart.\n   */\n  draw() {\n    this.backgroundRenderer.render();\n    this.gridRenderer.render();\n    this.axisRenderer.renderAxis();\n    this.selectionRenderer.render();\n    this.hoverBarsRenderer.render();\n    if (this.config.type === PlotChartType.gradient) {\n      this.barsRenderer.renderBars();\n      this.labelsRenderer.renderLabels();\n    } else {\n      this.barsFractionsRenderer.renderBars();\n      this.labelsFractionRenderer.renderLabels();\n    }\n  }\n\n  /**\n   * Updates the date.chart.plot.chart chart.\n   */\n  update(controller, reason) {\n    if (!this.updateSensible) return;\n    if (reason === 'dates-filter') return;\n    this.remove();\n    this.precalculate();\n    this.draw();\n  }\n\n  /**\n   * Creates scales which are used to calculate the x and y positions of bars or circles.\n   */\n  createScales() {\n\n    this.xChart = d3\n      .scaleBand()\n      .domain(this.dataView.dates || [])\n      .rangeRound([this.config.margin.left, this.config.width - this.config.margin.right])\n      .paddingInner(0.1);\n\n    this.yChartPadding = d3\n      .scaleBand()\n      .domain(this.dataView.labels || [])\n      .rangeRound([this.height - this.config.margin.bottom, this.config.margin.top])\n      .paddingInner(0.1);\n\n    this.yChart = d3\n      .scaleBand()\n      .domain(this.dataView.labels || [])\n      .rangeRound([this.height - this.config.margin.bottom, this.config.margin.top]);\n\n    this.xAxisGrid = d3\n      .axisBottom(this.xChart)\n      .tickSize(-this.graphHeight)\n      .tickFormat('');\n\n    this.yAxisGrid = d3\n      .axisLeft(this.yChart)\n      .tickSize(-this.graphWidth)\n      .tickFormat('');\n\n  }\n\n  /**\n   *\n   * @param event\n   * @param dataset\n   */\n  onSelectDataset(event, dataset) {\n    if (!dataset || !dataset.label) return;\n    let label = dataset.label;\n    if (this.datasetController.listeners.length === 1) return;\n    this.updateSensible = false;\n    this.datasetController.setDatasetsFilter([label]);\n    this.updateSensible = true;\n  }\n\n  sortDatasets() {\n    let datasets = this.dataView.datasets;\n    let sortedDatasets = [];\n    switch (this.config.sort) {\n      case PlotChartSort.alphabetically:\n        sortedDatasets = datasets\n          .sort((set1, set2) => set1.label > set2.label);\n        break;\n      case PlotChartSort.duration:\n        sortedDatasets = datasets\n          .sort((set1, set2) => set1.duration < set2.duration);\n        break;\n      case PlotChartSort.intensity:\n        sortedDatasets = datasets\n          .sort((set1, set2) => set1.sum < set2.sum);\n        break;\n      case PlotChartSort.firstDate:\n        sortedDatasets = datasets\n          .sort((set1, set2) => set1.firstDate > set2.firstDate);\n        break;\n      default:\n        sortedDatasets = datasets;\n        break;\n    }\n\n    this.dataView.labels = sortedDatasets.map(dataset => String(dataset.label)).reverse();\n    this.dataView.datasetsSorted = this.dataView.labels;\n  }\n}\n","import {Checkbox} from \"../shared.components/checkbox\";\nimport {UrlParameters} from \"../shared/url.parameters\";\nimport {Dropdown} from \"../shared.components/dropdown\";\nimport {Option} from \"../shared.components/option\";\nimport {SettingsPopup} from \"../shared.components/settings.popup\";\nimport {PlotChartSort, PlotChartType} from \"../plot.chart/plot.chart.config\";\n\n/**\n *\n * @class PlotChartCardSettingsPopup\n * @extends SettingsPopup\n */\nexport class PlotChartCardSettingsPopup extends SettingsPopup {\n\n  /**\n   * Appends the headline and the content row of the popup.\n   */\n  inject() {\n    super.inject();\n\n    let container = this.row.append('div');\n\n    let showLabelsCheckboxContainer = container.append('div').classed('lotivis-settings-card-row', true);\n    this.showLabelsCheckbox = new Checkbox(showLabelsCheckboxContainer);\n    this.showLabelsCheckbox.setText('Labels');\n    this.showLabelsCheckbox.onClick = function (checked) {\n      this.chart.config.showLabels = checked;\n      this.chart.update();\n      UrlParameters.getInstance().set(UrlParameters.chartShowLabels, checked);\n    }.bind(this);\n\n    let typeDropdownContainer = container.append('div').classed('lotivis-settings-card-row', true);\n    this.typeDropdown = new Dropdown(typeDropdownContainer);\n    this.typeDropdown.setLabelText('Type');\n    this.typeDropdown.setOptions([\n      new Option(PlotChartType.gradient),\n      new Option(PlotChartType.fraction)\n    ]);\n    this.typeDropdown.setOnChange(function (value) {\n      this.chart.config.type = value;\n      this.chart.update();\n    }.bind(this));\n\n    let dropdownContainer = container.append('div').classed('lotivis-settings-card-row', true);\n    this.sortDropdown = new Dropdown(dropdownContainer);\n    this.sortDropdown.setLabelText('Sort');\n    this.sortDropdown.setOptions([\n      new Option(PlotChartSort.alphabetically),\n      new Option(PlotChartSort.duration),\n      new Option(PlotChartSort.intensity),\n      new Option(PlotChartSort.firstDate)\n    ]);\n    this.sortDropdown.setOnChange(function (value) {\n      this.chart.config.sort = value;\n      this.chart.update();\n    }.bind(this));\n  }\n\n  /**\n   * Tells this popup that it is about to be displayed.\n   */\n  willShow() {\n    this.showLabelsCheckbox.setChecked(this.chart.config.showLabels);\n    this.typeDropdown.setSelectedOption(this.chart.config.type);\n    this.sortDropdown.setSelectedOption(this.chart.config.sort);\n  }\n}\n","import {Card} from \"../shared.components/card\";\nimport {UrlParameters} from \"../shared/url.parameters\";\nimport {ChartCard} from \"../shared.components/chart.card\";\nimport {PlotChart} from \"../plot.chart/plot.chart\";\nimport {PlotChartCardSettingsPopup} from \"./plot.chart.card.settings.popup\";\nimport {downloadImage} from \"../shared/download\";\nimport {createDownloadFilename} from \"../shared/filename\";\n\n/**\n * A card containing a date.chart.plot.chart chart.\n * @class PlotChartCard\n * @extends Card\n */\nexport class PlotChartCard extends ChartCard {\n\n  /**\n   * Creates a new instance of PlotChartCard.\n   * @param selector The selector\n   * @param config\n   */\n  constructor(selector, config) {\n    let theSelector = selector || 'plot-chart-card';\n    super(theSelector, config);\n    this.injectRadioGroup();\n    this.applyURLParameters();\n    // this.setTitle('Plot');\n  }\n\n  /**\n   * Injects the time plot chart in the body of the card.\n   */\n  injectChart() {\n    this.chartID = this.selector + '-chart';\n    this.body.attr('id', this.chartID);\n    this.chart = new PlotChart(this.chartID, this.config);\n  }\n\n  /**\n   * Applies possible url parameters.\n   */\n  applyURLParameters() {\n    let instance = UrlParameters.getInstance();\n    this.chart.type = instance.getString(UrlParameters.chartType, 'bar');\n    this.chart.isShowLabels = instance.getBoolean(UrlParameters.chartShowLabels, false);\n    this.chart.isCombineStacks = instance.getBoolean(UrlParameters.chartCombineStacks, false);\n  }\n\n  /**\n   * Presents the settings popup.\n   */\n  presentSettingsPopupAction() {\n    let bodyElement = d3.select('body');\n    let button = document.getElementById(this.moreButton.selector);\n    let settingsPopup = new PlotChartCardSettingsPopup(bodyElement);\n    settingsPopup.chart = this.chart;\n    settingsPopup.showUnder(button, 'right');\n  }\n\n  /**\n   * Creates and downloads a screenshot from the chart.\n   * @override\n   */\n  screenshotButtonAction() {\n    let filename = this.chart.datasetController.getFilename();\n    let downloadFilename = createDownloadFilename(filename, `plot-chart`);\n    downloadImage(this.chart.svgSelector, downloadFilename);\n  }\n}\n","import {DatasetsController} from \"./datasets.controller\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * Appends the given listener to the collection of listeners.\n *\n * @param listener The listener to addDataset.\n */\nDatasetsController.prototype.addListener = function (listener) {\n  if (!this.listeners) this.listeners = [];\n  if (!listener.update) return lotivis_log('Listener unqualified.');\n  if (this.listeners.includes(listener)) return lotivis_log(`[lotivis]  Attempt to add listener twice (${listener}).`);\n  this.listeners.push(listener);\n  listener.update(this, 'registration');\n};\n\n/**\n * Removes the given listener from the collection of listeners.\n *\n * @param listener The listener to removeDataset.\n */\nDatasetsController.prototype.removeListener = function (listener) {\n  if (!this.listeners) return lotivis_log('No listeners property.');\n  let index = this.listeners.indexOf(listener);\n  if (index === -1) return lotivis_log(`Listener not registered: ${listener}`);\n  this.listeners = this.listeners.splice(index, 1);\n};\n\n/**\n * Notifies all listeners.\n * @param reason The reason to send to the listener.  Default is 'none'.\n */\nDatasetsController.prototype.notifyListeners = function (reason = 'none') {\n  if (!this.listeners) return;\n  for (let index = 0; index < this.listeners.length; index++) {\n    let listener = this.listeners[index];\n    if (!listener.update) {\n      lotivis_log('Listener unqualified.');\n      continue;\n    }\n    lotivis_log(`listener: ${listener}`);\n    console.timeStamp('will update ' + listener);\n    listener.update(this, reason);\n    console.timeStamp('did update ' + listener);\n  }\n};\n\n/**\n * Sets this controller to all of the given listeners via the `setDatasetsController` function.\n * @param listeners A collection of listeners.\n */\nDatasetsController.prototype.register = function (listeners) {\n  if (!Array.isArray(listeners)) return;\n  for (let index = 0; index < listeners.length; index++) {\n    let listener = listeners[index];\n    if (!listener.setDatasetsController) continue;\n    listener.setDatasetsController(this);\n  }\n};\n","import {DatasetsController} from \"./datasets.controller\";\nimport {objectsEqual} from \"../shared/equal\";\nimport {lotivis_log} from \"../shared/debug\";\nimport {copy} from \"../shared/copy\";\n\n/**\n * Resets all filters.  Notifies listeners.\n */\nDatasetsController.prototype.resetFilters = function (notifyListeners = true) {\n  this.filters.locations = [];\n  this.filters.dates = [];\n  this.filters.labels = [];\n  this.calculateSnapshot();\n  if (!notifyListeners) return;\n  this.notifyListeners('reset-filters');\n};\n\n/**\n * Resets locations filters.  Notifies listeners.\n */\nDatasetsController.prototype.resetLocationFilters = function (notifyListeners = true) {\n  this.filters.locations = [];\n  this.calculateSnapshot();\n  if (!notifyListeners) return;\n  this.notifyListeners('reset-location-filters');\n};\n\n/**\n * Resets date filters.  Notifies listeners.\n */\nDatasetsController.prototype.resetDateFilters = function (notifyListeners = true) {\n  this.filters.dates = [];\n  this.calculateSnapshot();\n  if (!notifyListeners) return;\n  this.notifyListeners('reset-dates-filters');\n};\n\n/**\n * Resets label filters.  Notifies listeners.\n */\nDatasetsController.prototype.resetLabelFilters = function (notifyListeners = true) {\n  this.filters.labels = [];\n  this.calculateSnapshot();\n  if (!notifyListeners) return;\n  this.notifyListeners('reset-label-filters');\n};\n\n/**\n * Sets the locations filter.  Notifies listeners.\n *\n * @param locations The locations to filter.\n */\nDatasetsController.prototype.setLocationsFilter = function (locations) {\n  let stringVersions = locations.map(location => String(location)).filter(item => item.length > 0);\n  if (objectsEqual(this.filters.locations, stringVersions)) {\n    return lotivis_log(`[lotivis]  Location filters not changed.`);\n  }\n  this.filters.locations = stringVersions;\n  this.calculateSnapshot();\n  this.notifyListeners('filter-locations');\n};\n\nDatasetsController.prototype.toggleLocation = function (location) {\n  const index = this.filters.locations.indexOf(location);\n  if (index !== -1) {\n    this.filters.locations.splice(index, 1);\n  } else {\n    this.filters.locations.push(location);\n  }\n  this.calculateSnapshot();\n  this.notifyListeners('filter-locations');\n};\n\n/**\n * Sets the dates filter.  Notifies listeners.\n * @param dates The dates to filter.\n */\nDatasetsController.prototype.setDatesFilter = function (dates) {\n  let stringVersions = dates.map(date => String(date)).filter(item => item.length > 0);\n  if (objectsEqual(this.filters.dates, stringVersions)) return lotivis_log(`[lotivis]  Date filters not changed.`);\n  this.filters.dates = stringVersions;\n  this.calculateSnapshot();\n  this.notifyListeners('filter-dates');\n  lotivis_log('filter-dates:', this.filters.dates);\n};\n\nDatasetsController.prototype.toggleDate = function (date) {\n  const stringVersion = String(date);\n  const index = this.filters.dates.indexOf(stringVersion);\n  if (index !== -1) {\n    this.filters.dates.splice(index, 1);\n  } else {\n    this.filters.dates.push(stringVersion);\n  }\n  this.calculateSnapshot();\n  this.notifyListeners('filter-dates');\n};\n\n/**\n * Sets the datasets filter.  Notifies listeners.\n *\n * @param datasets The datasets to filter.\n */\nDatasetsController.prototype.setDatasetsFilter = function (datasets) {\n  let stringVersions = datasets.map(dataset => String(dataset)).filter(item => item.length > 0);\n  if (objectsEqual(this.filters.labels, stringVersions)) return lotivis_log(`[lotivis]  Dataset filters not changed.`);\n  this.filters.labels = stringVersions;\n  this.calculateSnapshot();\n  this.notifyListeners('filter-labels');\n  lotivis_log('filter-labels:', this.filters.labels);\n};\n\n/**\n * Toggles the enabled of the dataset with the given label.\n *\n * @param label The label of the dataset.\n * @param notifyListeners A boolean value indicating whether to notify the listeners.  Default is `true`.\n */\nDatasetsController.prototype.toggleDataset = function (label, notifyListeners = true) {\n\n  let index = this.filters.labels.indexOf(label);\n  if (index !== -1) {\n    this.filters.labels.splice(index, 1);\n  } else {\n    this.filters.labels.push(String(label));\n  }\n\n  if (!notifyListeners) return;\n  this.calculateSnapshot();\n  this.notifyListeners('dataset-toggle');\n};\n\n/**\n * Returns a newly generated collection containing all enabled datasets.\n *\n * @returns {*} The collection of enabled datasets.\n */\nDatasetsController.prototype.filteredDatasets = function () {\n  let filtered = copy(this.datasets);\n\n  if (this.filters.labels && this.filters.labels.length > 0) {\n    let datasetFilters = this.filters.labels;\n    filtered = filtered.filter(function (dataset) {\n      return datasetFilters.includes(String(dataset.label));\n    });\n  }\n\n  if (this.filters.locations && this.filters.locations.length > 0) {\n    let locationFilters = this.filters.locations;\n    filtered = filtered.map(function (dataset) {\n      dataset.data = dataset.data\n        .filter(data => locationFilters.includes(String(data.location))) || [];\n      return dataset;\n    });\n  }\n\n  if (this.filters.dates && this.filters.dates.length > 0) {\n    let dateFilters = this.filters.dates;\n    filtered = filtered.map(function (dataset) {\n      dataset.data = dataset.data\n        .filter(data => dateFilters.includes(String(data.date))) || [];\n      return dataset;\n    });\n  }\n\n  return filtered.filter(dataset => dataset.data.length > 0);\n};\n","import {Color} from \"../shared/color\";\n\n/**\n *\n * @class DatasetsColorsController\n */\nexport class DatasetsColorsController {\n\n  /**\n   * Creates a new instance of DatasetsColorsController.\n   * @param workingDatasets\n   * @param stacks\n   */\n  constructor(workingDatasets, stacks) {\n\n    let datasets = workingDatasets;\n    let labelToColor = {};\n    let stackToColors = {};\n\n    for (let sIndex = 0; sIndex < stacks.length; sIndex++) {\n      let stack = stacks[sIndex];\n\n      // filter datasets for stack\n      let filtered = datasets.filter(function (dataset) {\n        return dataset.label === stack || dataset.stack === stack;\n      });\n\n      let colors = Color.colorsForStack(sIndex, filtered.length);\n      stackToColors[stack] = colors;\n      for (let dIndex = 0; dIndex < filtered.length; dIndex++) {\n        labelToColor[filtered[dIndex].label] = colors[dIndex];\n      }\n    }\n\n    this.colorForDataset = function (label) {\n      return labelToColor[label] || Color.defaultTint;\n    };\n\n    this.colorForStack = function (stack) {\n      return stackToColors[stack][0] || Color.defaultTint;\n    };\n\n    this.colorsForStack = function (stack) {\n      return stackToColors[stack] || [];\n    };\n  }\n}\n","import {DatasetsController} from \"./datasets.controller\";\nimport {flatDatasets} from \"../data.juggle/data.flat\";\nimport {\n  extractDatesFromDatasets,\n  extractDatesFromFlatData,\n  extractLabelsFromDatasets, extractLocationsFromDatasets,\n  extractLocationsFromFlatData,\n  extractStacksFromDatasets\n} from \"../data.juggle/data.extract\";\nimport {copy} from \"../shared/copy\";\nimport {DatasetsColorsController} from \"./datasets.controller.colors\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n */\nDatasetsController.prototype.calculateSnapshot = function () {\n  lotivis_log(`[lotivis]  calculateSnapshot`);\n  this.snapshot = {};\n  this.snapshot.datasets = this.filteredDatasets();\n  this.snapshot.flatData = flatDatasets(this.snapshot.datasets);\n  this.snapshot.labels = extractLabelsFromDatasets(this.snapshot.datasets);\n  this.snapshot.stacks = extractStacksFromDatasets(this.snapshot.datasets);\n  this.snapshot.dates = extractDatesFromFlatData(this.snapshot.datasets)\n    .sort((left, right) => this.dateAccess(left) - this.dateAccess(right));\n  this.snapshot.locations = extractLocationsFromFlatData(this.snapshot.datasets);\n};\n\n/**\n * Calculates the additional data.\n */\nDatasetsController.prototype.calculateAdditionalData = function () {\n  let dateAccess = this.dateAccess;\n\n  this.datasets = copy(this.datasets)\n    .sort((left, right) => left.label > right.label);\n\n  this.datasets.forEach((dataset) => {\n    dataset.data.forEach((item) => {\n      item.dateNumeric = dateAccess(item.date);\n    });\n    dataset.data = dataset.data\n      .sort((left, right) => left.dateNumeric - right.dateNumeric);\n  });\n\n  this.flatData = flatDatasets(this.datasets);\n  this.labels = extractLabelsFromDatasets(this.datasets);\n  this.stacks = extractStacksFromDatasets(this.datasets);\n  this.dates = extractDatesFromDatasets(this.datasets)\n    .sort((left, right) => dateAccess(left) - dateAccess(right));\n\n  this.locations = extractLocationsFromDatasets(this.datasets);\n  this.datasetsColorsController = new DatasetsColorsController(this.datasets, this.stacks);\n};\n\n/**\n * Tells this datasets controller that its datasets did change.\n */\nDatasetsController.prototype.datasetsDidChange = function () {\n  if (!this.datasets || !Array.isArray(this.datasets)) {\n    lotivis_log('[lotivis]  No datasets.');\n    return;\n  }\n\n  this.calculateAdditionalData();\n  this.calculateSnapshot();\n  this.notifyListeners('datasets-update');\n};\n","import {DatasetsController} from \"./datasets.controller\";\nimport {copy} from \"../shared/copy\";\nimport {validateDatasets} from \"../data.juggle/data.validate\";\nimport \"./datasets.controller.snapshot\";\n\n/*\nCRUD:\n- create\n- read\n- update\n- delete\n */\n\n/**\n * Sets the given dataset.\n * @param dataset The new dataset.\n */\nDatasetsController.prototype.setDataset = function (dataset) {\n  this.cache.invalidate();\n  this.setDatasets([dataset]);\n};\n\n/**\n * Updates the datasets of this controller.\n * @param datasets The new datasets.\n */\nDatasetsController.prototype.setDatasets = function (datasets) {\n  this.cache.invalidate();\n  this.originalDatasets = datasets;\n  this.datasets = copy(datasets);\n  validateDatasets(datasets);\n  this.datasetsDidChange();\n};\n\n/**\n * Appends the given dataset to this controller.\n * @param dataset The dataset to append.\n */\nDatasetsController.prototype.addDataset = function (dataset) {\n  this.cache.invalidate();\n  this.addDatasets([dataset]);\n};\n\n/**\n * Appends the given datasets to this controller.\n * @param datasets The collection of datasets to add.\n */\nDatasetsController.prototype.addDatasets = function (datasets) {\n  if (!this.datasets || !Array.isArray(this.datasets)) return;\n  if (!datasets || !Array.isArray(datasets)) return;\n  if (this.datasets.find(dataset => dataset.label === datasets.label)) {\n    throw new Error(`DatasetsController already contains a dataset with the same label (${datasets.label}).`);\n  }\n  this.cache.invalidate();\n  datasets.forEach(dataset => this.datasets.push(dataset));\n  this.datasetsDidChange();\n  this.notifyListeners('datasets-update');\n};\n\n/**\n * Removes the dataset with the given label from this controller.  Will do nothing if no dataset\n * with the given label exists.\n *\n * @param label The label of the dataset to remove.\n */\nDatasetsController.prototype.removeDataset = function (label) {\n  this.cache.invalidate();\n  this.removeDatasets([label]);\n};\n\n/**\n * Removes the given datasets from this controller.  Datasets this controller already containing will be ignored.\n * @param labels The collection of labels to remove.\n */\nDatasetsController.prototype.removeDatasets = function (labels) {\n  if (!this.datasets || !Array.isArray(this.datasets)) return;\n  if (!labels || !Array.isArray(labels)) return;\n  this.cache.invalidate();\n  labels.forEach(function (label) {\n    let candidate = this.datasets.find(dataset => dataset.label === label);\n    if (!candidate) return;\n    let index = this.datasets.indexOf(candidate);\n    if (index < 0) return;\n    this.datasets = this.datasets.splice(index, 1);\n  }.bind(this));\n  this.datasetsDidChange();\n};\n","import {extractStacksFromDatasets} from \"./data.extract\";\n\n/**\n *\n * @param datasets\n * @param dateToItemsRelation\n * @returns {*[]}\n */\nexport function createStackModel(controller, datasets, dateToItemsRelation) {\n  let listOfStacks = extractStacksFromDatasets(datasets);\n\n  return listOfStacks.map(function (stackName) {\n\n    let stackCandidates = datasets.filter(function (dataset) {\n      return dataset.stack === stackName\n        || dataset.label === stackName;\n    });\n\n    let candidatesNames = stackCandidates.map(stackCandidate => stackCandidate.label);\n    let candidatesColors = stackCandidates.map(stackCandidate => controller.getColorForDataset(stackCandidate.label));\n\n    let stack = d3\n      .stack()\n      .keys(candidatesNames)\n      (dateToItemsRelation);\n\n    stack.label = stackName;\n    stack.stack = stackName;\n    stack.colors = candidatesColors;\n\n    return stack;\n  });\n}\n","/**\n * Returns the first item of the array.\n * @returns {*} The first item.\n */\nArray.prototype.first = function () {\n  return this[0];\n};\n\n/**\n * Returns the last item of the array.\n * @returns {*} The last item.\n */\nArray.prototype.last = function () {\n  return this[this.length - 1];\n};\n","import {combineByDate} from \"./data.combine\";\nimport '../shared/extension.array';\nimport {sumOfValues} from \"./data.sum\";\nimport {copy} from \"../shared/copy\";\n\n/**\n * Combines each `ratio` entries to one.\n * @param datasets The datasets collection.\n * @param ratio The ratio.\n */\nexport function combineDatasetsByRatio(datasets, ratio) {\n  let copied = copy(datasets);\n  for (let index = 0; index < copied.length; index++) {\n    let dataset = copied[index];\n    let data = dataset.data;\n    dataset.data = combineDataByGroupsize(data, ratio);\n    copied[index] = dataset;\n  }\n  return copied;\n}\n\n/**\n *\n * @param data\n * @param ratio\n */\nexport function combineDataByGroupsize(data, ratio) {\n  if (!data || data.length <= ratio) return data;\n  if (ratio <= 1) return data;\n\n  let combined = combineByDate(copy(data));\n  let newData = [];\n\n  while (combined.length > 0) {\n    let dateGroup = combined.splice(0, ratio);\n    let firstItem = dateGroup.first() || {};\n    let lastItem = dateGroup.last() || {};\n    let item = {};\n    item.dataset = firstItem.dataset;\n    item.label = firstItem.label;\n    item.stack = firstItem.stack;\n    item.date = firstItem.date;\n    item.date = firstItem.date;\n    item.from = firstItem.date;\n    item.till = lastItem.date;\n    item.value = sumOfValues(dateGroup);\n    newData.push(item);\n  }\n\n  return newData;\n}\n","import {DatasetsController} from \"../datasets.controller/datasets.controller\";\nimport {dateToItemsRelation} from \"../data.juggle/data.relations\";\nimport {createStackModel} from \"../data.juggle/data.stacks\";\nimport {copy} from \"../shared/copy\";\nimport {combineDatasetsByRatio} from \"../data.juggle/data.combine.ratio\";\nimport {extractDatesFromDatasets} from \"../data.juggle/data.extract\";\nimport \"../datasets.controller/datasets.controller.cache\";\nimport {lotivis_log} from \"../shared/debug\";\n\n/**\n * Returns a new generated DateDataview for the current enabled samples of dataset of this controller.\n */\nDatasetsController.prototype.getDateDataview = function (groupSize) {\n\n  let cachedDataView = this.getCached('date');\n  if (cachedDataView) {\n    return cachedDataView;\n  }\n\n  let dateAccess = this.dateAccess;\n  let datasets = copy(this.datasets);\n  let enabledDatasets = copy(this.filteredDatasets() || datasets);\n  let dataView = {};\n  let saveGroupSize = groupSize || 1;\n\n  dataView.groupSize = saveGroupSize;\n  if (saveGroupSize <= 1) {\n    dataView.datasets = datasets;\n    dataView.enabledDatasets = enabledDatasets;\n  } else {\n    datasets = combineDatasetsByRatio(datasets, saveGroupSize);\n    enabledDatasets = combineDatasetsByRatio(enabledDatasets, saveGroupSize);\n    dataView.datasets = datasets;\n  }\n\n  dataView.dateToItemsRelation = dateToItemsRelation(datasets, dateAccess);\n  dataView.dateToItemsRelationPresented = dateToItemsRelation(enabledDatasets, dateAccess);\n  dataView.datasetStacks = createStackModel(this, datasets, dataView.dateToItemsRelation);\n  dataView.datasetStacksPresented = createStackModel(this, enabledDatasets, dataView.dateToItemsRelationPresented);\n\n  dataView.max = d3.max(dataView.datasetStacksPresented, function (stack) {\n    return d3.max(stack, function (series) {\n      return d3.max(series.map(item => item['1']));\n    });\n  });\n\n  dataView.dates = extractDatesFromDatasets(enabledDatasets);\n  dataView.enabledStacks = this.snapshot.stacks;\n\n  this.setCached(dataView, 'date');\n\n  return dataView;\n};\n","import {DatasetsController} from \"../datasets.controller/datasets.controller\";\nimport {dateToItemsRelation} from \"../data.juggle/data.relations\";\nimport {createStackModel} from \"../data.juggle/data.stacks\";\nimport {copy} from \"../shared/copy\";\nimport {combineDatasetsByRatio} from \"../data.juggle/data.combine.ratio\";\nimport {extractDatesFromDatasets} from \"../data.juggle/data.extract\";\nimport {combine} from \"../data.juggle/data.combine\";\nimport {flatDatasets} from \"../data.juggle/data.flat\";\nimport {createDatasets} from \"../data.juggle/data.create.datasets\";\nimport \"../datasets.controller/datasets.controller.cache\";\n\n/**\n * Returns a new generated DateDataview for the current enabled samples of dataset of this controller.\n */\nDatasetsController.prototype.getDateDataviewCombinedStacks = function (groupSize) {\n  let dateAccess = this.dateAccess;\n  let datasets = copy(this.datasets);\n  let enabledDatasets = copy(this.filteredDatasets() || datasets);\n\n  let dataView = {};\n  let saveGroupSize = groupSize || 1;\n\n  datasets.forEach(function (dataset) {\n    dataset.label = dataset.stack || dataset.label;\n  });\n\n  enabledDatasets.forEach(function (dataset) {\n    dataset.label = dataset.stack || dataset.label;\n  });\n\n  datasets = createDatasets(combine(flatDatasets(datasets)));\n  enabledDatasets = createDatasets(combine(flatDatasets(enabledDatasets)));\n\n  dataView.groupSize = saveGroupSize;\n  if (saveGroupSize <= 1) {\n    dataView.datasets = datasets;\n    dataView.enabledDatasets = enabledDatasets;\n  } else {\n    datasets = combineDatasetsByRatio(datasets, saveGroupSize);\n    enabledDatasets = combineDatasetsByRatio(enabledDatasets, saveGroupSize);\n    dataView.datasets = datasets;\n  }\n\n  dataView.dateToItemsRelation = dateToItemsRelation(datasets, dateAccess);\n  dataView.dateToItemsRelationPresented = dateToItemsRelation(enabledDatasets, dateAccess);\n  dataView.datasetStacks = createStackModel(this, datasets, dataView.dateToItemsRelation);\n  dataView.datasetStacksPresented = createStackModel(this, enabledDatasets, dataView.dateToItemsRelationPresented);\n\n  dataView.max = d3.max(dataView.datasetStacksPresented, function (stack) {\n    return d3.max(stack, function (series) {\n      return d3.max(series.map(item => item['1']));\n    });\n  });\n\n  dataView.dates = extractDatesFromDatasets(enabledDatasets);\n  dataView.enabledStacks = this.snapshot.stacks;\n\n  return dataView;\n};\n","import {DatasetsController} from \"../datasets.controller/datasets.controller\";\nimport {combineByLocation, combineByStacks} from \"../data.juggle/data.combine\";\nimport \"../datasets.controller/datasets.controller.cache\";\n\n/**\n * Returns a new generated location data view for the current selected datasets.controller of datasets of this controller.\n *\n * A location dataview has the following form:\n * ```\n * {\n *   stacks: [String],\n *   items: [\n *     {\n *       dataset: String,\n *       stack: String,\n *       location: Any,\n *       value: Number\n *     }\n *   ]\n * }\n * ```\n */\nDatasetsController.prototype.getLocationDataview = function () {\n\n  let cachedDataView = this.getCached('location');\n  if (cachedDataView) { return cachedDataView; }\n\n  let dataView = {};\n\n  let flatData = this.snapshot.flatData;\n  let combinedByStack = combineByStacks(flatData);\n  let combinedByLocation = combineByLocation(combinedByStack);\n\n  dataView.stacks = this.stacks;\n  dataView.combinedData = combinedByLocation;\n\n  dataView.combinedData.forEach(item => {\n    item.stack = item.stack || item.label || item.dataset;\n  });\n\n  this.setCached(dataView, 'location');\n\n  return dataView;\n};\n","import { Color } from \"./js/shared/color\";\nimport { Button } from \"./js/shared.components/button\";\nimport { Component } from \"./js/shared.components/component\";\nimport { RadioGroup } from \"./js/shared.components/radio.group\";\nimport { Toast } from \"./js/shared.components/toast\";\nimport { Option } from \"./js/shared.components/option\";\nimport \"./js/chart/chart.datasets\";\nimport { Card } from \"./js/shared.components/card\";\nimport { Checkbox } from \"./js/shared.components/checkbox\";\n\nimport { ModalPopup } from \"./js/shared.components/modal.popup\";\nimport { Dropdown } from \"./js/shared.components/dropdown\";\nimport { Popup } from \"./js/shared.components/popup\";\n\nimport { UpdatableDataviewCard } from \"./js/dataview.card/updatable.dataview.card\";\nimport { EditableDataviewCard } from \"./js/dataview.card/editable.dataview.card\";\nimport { DatasetsJSONCard } from \"./js/dataview.card/data.json.card\";\nimport { DatasetCSVCard } from \"./js/dataview.card/data.csv.card\";\nimport { DatasetCSVDateCard } from \"./js/dataview.card/data.csv.date.card\";\nimport { DatasetsControllerCard } from \"./js/dataview.card/datasets.controller.card\";\nimport {\n  DataViewCard,\n  DataViewDateChartCard,\n  DataViewDatePlotChartCard,\n  DataViewFlatCard,\n  DataViewMapChartCard\n} from \"./js/dataview.card/dataview.card\";\n\nimport { DateChart } from \"./js/date.chart/date.chart\";\nimport { DateChartCard } from \"./js/date.chart.card/date.chart.card\";\nimport { MapChart } from \"./js/map.chart/map.chart\";\nimport { MapChartCard } from \"./js/map.chart.card/map.chart.card\";\nimport { PlotChart } from \"./js/plot.chart/plot.chart\";\nimport { PlotChartCard } from \"./js/plot.chart.card/plot.chart.card\";\n\nimport { DatasetsController } from \"./js/datasets.controller/datasets.controller\";\nimport \"./js/datasets.controller/datasets.controller.listeners\";\nimport \"./js/datasets.controller/datasets.controller.filter\";\nimport \"./js/datasets.controller/datasets.controller.data\";\n\nimport { parseCSV } from \"./js/data.parse/parse.csv\";\nimport { parseCSVDate } from \"./js/data.parse/parse.csv.date\";\n\nimport \"./js/dataview/dataview.date\";\nimport \"./js/dataview/dataview.date.combined.stacks\";\nimport \"./js/dataview/dataview.plot\";\nimport \"./js/dataview/dataview.location\";\n\nimport { LotivisConfig } from \"./js/shared/config\";\nimport { debug } from \"./js/shared/debug\";\n\nimport {\n  FormattedDateAccess,\n  DateGermanAssessor,\n  DefaultDateAccess,\n  DateWeekAssessor\n} from \"./js/data.date.assessor/date.assessor\";\nimport { UrlParameters } from \"./js/shared/url.parameters\";\nimport { createID } from \"./js/shared/selector\";\n\nexports.createID = createID;\n\n// colors\nexports.Color = Color;\n\n// shared.components\nexports.Button = Button;\nexports.Card = Card;\nexports.Checkbox = Checkbox;\nexports.Component = Component;\nexports.Dropdown = Dropdown;\nexports.ModalPopup = ModalPopup;\nexports.Popup = Popup;\nexports.RadioGroup = RadioGroup;\nexports.Option = Option;\nexports.Toast = Toast;\n\n// datasets / csv cards\nexports.DatasetsJSONCard = DatasetsJSONCard;\nexports.DatasetCSVCard = DatasetCSVCard;\nexports.DatasetCSVDateCard = DatasetCSVDateCard;\nexports.DataViewCard = DataViewCard;\nexports.DataViewDateChartCard = DataViewDateChartCard;\nexports.DataViewDatePlotChartCard = DataViewDatePlotChartCard;\nexports.DataViewMapChartCard = DataViewMapChartCard;\nexports.DataViewMapCard = DataViewMapChartCard;\nexports.DataviewFlatCard = DataViewFlatCard;\nexports.DatasetsControllerCard = DatasetsControllerCard;\nexports.DatasetsControllerSnapshotCard = DatasetsControllerCard;\nexports.UpdatableDataviewCard = UpdatableDataviewCard;\nexports.EditableDataviewCard = EditableDataviewCard;\n\n// date.chart\nexports.DateChart = DateChart;\nexports.DateChartCard = DateChartCard;\n\n// map.chart\nexports.MapChart = MapChart;\nexports.MapChartCard = MapChartCard;\n\n// date.chart.plot.chart\nexports.PlotChart = PlotChart;\nexports.PlotChartCard = PlotChartCard;\n\n// datasets\nexports.DatasetController = DatasetsController;\n\n// parse\nexports.parseCSV = parseCSV;\nexports.parseCSVDate = parseCSVDate;\n\n// constants\nexports.config = LotivisConfig;\nexports.debug = debug;\n\n// date.chart assessors\nexports.DefaultDateAccess = DefaultDateAccess;\nexports.FormattedDateAccess = FormattedDateAccess;\nexports.GermanDateAccess = DateGermanAssessor;\nexports.DateWeekAssessor = DateWeekAssessor;\n\n// url parameters\nexports.URLParameters = UrlParameters;\nexports.version = \"1.0.94\";\nexports.versionShort = \"1\";\n\nexport default exports;\n\nconsole.log(`[lotivis]  lotivis module loaded.`);\n"],"names":["Color","constructor","r","g","b","initialize","Error","Math","round","rgbString","toString","colorAdding","mapColors","till","d3","scaleLinear","domain","range","plotColor","colorsForStack","stackNumber","amount","colorCouple","stackColors","length","colorGenerator","colors","i","color","push","defaultTint","organgeLow","organgeHigh","redLow","redHigh","blueLow","blueHigh","lightBlueLow","lightBlueHight","greenLow","greenHight","hashCode","aString","hash","chr","charCodeAt","createID","uniquePrevious","toSaveID","theID","split","join","createIDFromDataset","dataset","label","camel2title","camelCase","replace","match","toUpperCase","LotivisError","message","name","LotivisElementNotFoundError","selector","DataValidateError","MissingPropertyError","data","JSON","stringify","InvalidFormatError","GeoJSONValidateError","LotivisUnimplementedMethodError","functionName","exports","Component","parent","Object","getPrototypeOf","String","prototype","initializeFromSelector","initializeFromConfig","initializeFromParent","element","undefined","select","empty","config","toLowerCase","trim","show","style","hide","isVisible","getElementEffectiveSize","width","height","Number","getElementPosition","document","getElementById","rect","getBoundingClientRect","xPosition","x","window","scrollX","yPosition","y","scrollY","components","getClassname","Button","append","attr","on","event","onClick","bind","classed","setText","text","RadioGroup","inputElements","addOption","optionId","optionName","inputElement","thisReference","setOptions","options","removeOptions","id","translatedTitle","setSelectedOption","selectedOption","value","selectAll","remove","target","onChange","Toast","row","leftComponnt","rightComponent","hideButton","setStatusMessage","newStatusMessage","saveString","Option","title","LotivisConfig","defaultMargin","tooltipOffset","barRadius","debugLog","debug","downloadFilePrefix","filenameSeparator","unknown","alreadyLogged","lotivis_log_once","includes","console","warn","lotivis_log","enabled","printConfig","log","Chart","svgSelector","updateSensible","datasets","setDatasets","update","datasetsController","reason","snapshot","precalculate","draw","makeUpdateInsensible","makeUpdateSensible","copy","object","parse","isValue","Boolean","toValue","combine","flattenList","combined","copiedList","index","listItem","entry","find","entryItem","stack","location","date","locationTotal","dateTotal","locationName","combineByStacks","combineByDate","flatData","combineByLocation","sumOfDataset","sumOfValues","filter","item","sumOfLabel","sumOfStack","map","reduce","acc","next","DefaultDateAccess","FormattedDateAccess","dateString","Date","isNaN","DateGermanAssessor","saveDateString","day","month","year","DateWeekAssessor","weekday","lowercase","DataViewCache","content","createName","type","locationFilters","dateFilters","datasetFilters","getDataView","setDataView","dataView","invalidate","DatasetsController","Array","isArray","dateAccess","filters","cache","locations","dates","labels","getFlatDataCombinedStacks","getFlatDataCombinedDates","getFlatDataCombinedLocations","getSumOfLabel","getSumOfDataset","getSumOfStack","getMax","max","getColorForDataset","datasetsColorsController","colorForDataset","getColorForStack","colorForStack","getColorsForStack","getFilename","splice","setDatasetsController","newController","datasetController","removeListener","addListener","newDatasets","getDatasets","Card","injectCard","injectHeader","injectBody","injectFooter","header","headerRow","headerLeftComponent","headerCenterComponent","headerRightComponent","titleLabel","body","footer","footerRow","footerLeftComponent","footerRightComponent","setTitle","newTitle","showFooter","hideFooter","Checkbox","renderInput","renderLabel","checkbox","checked","setChecked","enable","disable","Popup","injectUnderground","injectContainer","inject","injectCloseButton","addCloseActionListeners","modalBackgroundId","modalBackground","elementId","card","closeButton","validIDs","popup","dismiss","willShow","didShow","getUnderground","display","willDismiss","willRemoveDOMElement","showUnder","sourceElement","position","preferredSize","origin","calculateBottomCenter","left","top","showBigModal","margin","respectWindowScroll","ModalPopup","renderRow","loadContent","url","then","html","catch","error","Dropdown","selectId","renderSelect","removeAllInputs","argument","setLabelText","setOnChange","callback","optionID","create","div","dropdown","TextareaCard","render","textarea","lines","textareaID","onKeyup","downloadButton","getTextareaContent","download","setTextareaContent","newContent","updatesHeight","numberOfRows","enableTextarea","forEach","disableTextarea","UpdatableDataviewCard","newDatasetController","datasetsToText","cachedDatasets","controller","validateDatasets","validateDataset","validateDataItem","equals","value1","value2","objectsEqual","object1","object2","string1","string2","EditableDataviewCard","toast","updateDatasetsOfController","notifyController","parsedDatasets","textToDatasets","appendExtensionIfNeeded","filename","extension","startsWith","endsWith","createDownloadFilename","separator","arguments","getSVGString","svgNode","setAttribute","cssStyleText","getCSSStyles","appendCSS","serializer","XMLSerializer","svgString","serializeToString","parentElement","selectorTextArr","c","classList","contains","nodes","getElementsByTagName","classes","extractedCSSText","styleSheets","s","cssRules","e","selectorText","cssText","str","arr","indexOf","styleElement","createElement","innerHTML","refNode","hasChildNodes","children","insertBefore","svgString2Image","imageSource","btoa","unescape","encodeURIComponent","canvas","context","getContext","image","Image","onload","clearRect","drawImage","toDataURL","src","getOriginalSizeOfSVG","svgElement","viewBoxBaseValue","viewBox","baseVal","downloadBlob","blob","navigator","msSaveOrOpenBlob","msSaveBlob","anchor","href","URL","createObjectURL","appendChild","click","removeChild","downloadJSON","jsonString","Blob","saveFilename","downloadCSV","downloadImage","node","size","dataURL","fetch","res","dataBlob","DatasetsJSONCard","downloadFilename","csvStringToArray","strData","objPattern","RegExp","arrMatches","arrData","exec","trimByChar","string","character","first","findIndex","char","last","reverse","substring","createDatasets","datasetsByLabel","itemIndex","getOwnPropertyNames","parseCSV","arrays","headlines","shift","lineIndex","lineArray","csv","flatDatasets","datasetsCopy","datasetIndex","flatDataChunk","flatDataset","concat","newItem","dateNumeric","surroundWithQuotationMarks","renderCSV","csvContent","DatasetCSVCard","parseCSVDate","datasetLabels","minLineLength","columnIndex","extractLabelsFromDatasets","toSet","extractStacksFromDatasets","extractDatesFromDatasets","extractDatesFromFlatData","extractLocationsFromDatasets","extractLocationsFromFlatData","array","from","Set","extractEarliestDate","sort","right","extractEarliestDateWithValue","filterWithValue","extractLatestDate","pop","extractLatestDateWithValue","dateToItemsRelation","listOfDates","listOfLabels","datasetDate","total","renderCSVDate","dateRelation","labelIndex","dateRow","csvRow","DatasetCSVDateCard","DataViewCard","getDataview","DataViewDateChartCard","getTitle","getDateDataview","DataViewDatePlotChartCard","getPlotDataview","DataViewMapChartCard","getLocationDataview","DataViewFlatCard","DatasetsControllerCard","stacks","selection","originalDatasets","DateChartAxisRenderer","dateChart","svg","call","axisLeft","yChart","axisBottom","xChartScale","bottom","TimeChartLabelRenderer","renderBarLabels","xChartRef","yChartRef","xStackRef","xStack","numberFormat","labelColor","numberOfSeries","seriesIndex","bandwidth","enter","format","TimeChartLegendRenderer","combineStacks","renderCombinedStacksLegend","renderDefaultLegend","datasetNames","circleRadius","labelMargin","xLegend","scaleBand","rangeRound","legends","graph","graphHeight","formatted","toggleDataset","isEnabled","stackNames","TimeChartBarsRenderer","renderBars","isCombineStacks","stackData","d","TimeChartHoverBarsRenderer","hideAll","onMouseEnter","tooltipRenderer","showTooltip","onMouserOut","hideTooltip","buttons","onMouseClick","even","sendsNotifications","toggleDate","selectionRenderer","renderGhostBars","dateLabels","dataview","TimeChartTooltipRenderer","tooltip","getTooltipSize","tooltipWidth","tooltipHeight","getTop","factor","offset","tooltipSize","getXLeft","xChartScalePadding","getXRight","getHTMLForDate","sum","dataHTML","divHTML","valueFormatted","sumFormatted","TimeChartGridRenderer","createAxis","xAxisGrid","tickSize","tickFormat","yAxisGrid","graphWidth","ticks","renderGrid","opacity","TimeChartSelectionRenderer","getSelectedDates","selectedDates","DATE_CHART_CONFIG","showLabels","Intl","NumberFormat","maximumFractionDigits","DateChart","initializeDefaultValues","initializeRenderers","assign","axisRenderer","gridRenderer","labelRenderer","legendRenderer","barsRenderer","ghostBarsRenderer","groupSize","getDateDataviewCombinedStacks","createScales","paddingInner","enabledStacks","padding","nice","renderSVG","datasetStacks","datasetStacksPresented","background","some","resetDateFilters","UrlParameters","getInstance","instance","getURL","getBoolean","parameter","defaultValue","searchParams","get","getString","set","newValue","delete","history","replaceState","updateCurrentPageFooter","setWithoutDeleting","clear","newPath","protocol","host","newURL","language","page","query","searchViewMode","chartType","chartShowLabels","chartCombineStacks","contentType","valueType","searchSensitivity","startYear","endYear","showTestData","SettingsPopup","DateChartCardSettingsPopup","injectShowLabelsCheckbox","injectCombineStacksCheckbox","container","showLabelsCheckbox","chart","combineStacksCheckbox","ChartCard","injectButtons","injectRadioGroup","injectChart","cardSelector","screenshotButton","screenshotButtonAction","moreButton","presentSettingsPopupAction","radioGroup","setDataset","updateRadioGroup","names","firstDataset","onSelectedDatasetChanged","datasetLabel","DateChartCard","theSelector","chartID","applyURLParameters","parameters","button","settingsPopup","removeFeatures","geoJSON","removeCandidates","newGeoJSON","code","candidate","features","feature","properties","candidateIndex","styleForCSSClass","className","querySelector","getComputedStyle","formatNumber","number","MapTooltipRenderer","mapChart","featureMapID","lotivisId","htmlTitle","featuresSlice","slice","ids","featureNameAccessor","moreCount","htmlValues","combinedByLabel","positionTooltip","projection","featureBounds","geoBounds","featureLowerLeft","featureUpperRight","featureBoundsWidth","effectiveSize","positionOffset","getTooltipLeft","getTooltipLocationAbove","getTooltipLocationUnder","mouseEnter","selectedFeatures","selectionBorderGeoJSON","mouseOut","mapID","stroke","departmentsData","raise","MapLegendRenderer","legend","appendLegend","removeDatasetLegend","combinedData","stackName","dataForStack","steps","generator","MapLabelRenderer","removeLabels","featureID","featureIDAccessor","center","MapDatasetRenderer","styleArea","resetAreas","datasetEntry","locationID","MapGeoJSONRenderer","datasetRenderer","mouseClick","toggleLocation","presentedGeoJSON","areas","path","joinFeatures","topology","topojson","objects","extractObjects","geometry","merge","nom","topologyKey","hasOwnProperty","MapExteriorBorderRenderer","borders","createGeoJSON","rowsCount","ceil","latSpan","lngSpan","loop1","rowIndex","lat","lng","coordinates","MapChartConfig","isShowLabels","excludedFeatureCodes","drawRectangleAroundSelection","MapBackgroundRenderer","resetLocationFilters","Geometry","source","Feature","GeoJson","featureSource","getCenter","allCoordinates","extractAllCoordinates","latitudeSum","longitudeSum","extractGeometryCollection","geometryCollection","geometries","coordinatesCollection","coordinate","polygonCoordinates","featureCoordinates","MapSelectionRenderer","self","getSelectedFeatures","allFeatures","filteredLocations","MapChart","theConfig","geoMercator","geoPath","backgroundRenderer","geoJSONRenderer","exteriorBorderRenderer","setGeoJSON","zoomTo","fitSize","onSelectFeature","geoJSONDidChange","geoCentroid","MapChartSettingsPopup","MapChartCard","bodyElement","getCached","setCached","createPlotDataset","newDataset","firstDate","lastDate","cachedDataView","enabledDatasets","filteredDatasets","firstIndex","lastIndex","duration","labelsCount","PlotChartType","gradient","fraction","PlotChartSort","none","alphabetically","intensity","defaultPlotChartConfig","lineHeight","radius","drawGrid","lowColor","highColor","PlotAxisRenderer","plotChart","renderAxis","axisTop","xChart","PlotTooltipRenderer","getHTMLContentForDataset","filtered","getTooltipLeftForDataset","resetFilters","PlotLabelRenderer","renderLabels","xBandwidth","barsData","PlotGridRenderer","preferredHeight","PlotBackgroundRenderer","resetLabelFilters","PlotChartHoverBarsRenderer","backgrounBarsData","backgrounBars","PlotBarsFractionsRenderer","bars","yChartPadding","PlotBarsGradientCreator","createGradient","definitions","count","latestDate","dateDifference","datePercentage","PlotBarsGradientRenderer","gradientCreator","PlotLabelsFractionsRenderer","PlotChartSelectionRenderer","selectionBarsData","selectionBars","selectedLabels","getSelectedLabels","PlotChart","createSVG","hoverBarsRenderer","barsFractionsRenderer","labelsRenderer","labelsFractionRenderer","barsCount","sortDatasets","onSelectDataset","listeners","setDatasetsFilter","sortedDatasets","set1","set2","datasetsSorted","PlotChartCardSettingsPopup","showLabelsCheckboxContainer","typeDropdownContainer","typeDropdown","dropdownContainer","sortDropdown","PlotChartCard","listener","notifyListeners","timeStamp","register","calculateSnapshot","setLocationsFilter","stringVersions","setDatesFilter","stringVersion","DatasetsColorsController","workingDatasets","labelToColor","stackToColors","sIndex","dIndex","calculateAdditionalData","datasetsDidChange","addDataset","addDatasets","removeDataset","removeDatasets","createStackModel","listOfStacks","stackCandidates","candidatesNames","stackCandidate","candidatesColors","keys","combineDatasetsByRatio","ratio","copied","combineDataByGroupsize","newData","dateGroup","firstItem","lastItem","saveGroupSize","dateToItemsRelationPresented","series","combinedByStack","combinedByLocation","DataViewMapCard","DataviewFlatCard","DatasetsControllerSnapshotCard","DatasetController","GermanDateAccess","URLParameters","version","versionShort"],"mappings":"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"}